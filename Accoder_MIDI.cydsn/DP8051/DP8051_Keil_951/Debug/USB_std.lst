C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE USB_STD
OBJECT MODULE PLACED IN .\DP8051\DP8051_Keil_951\Debug\USB_std.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\4.0\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -Generated_Source\PSoC3\USB_std.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB WL(2) PR(.\
                    -DP8051\DP8051_Keil_951\Debug/USB_std.lst) CD OT(2,SIZE) OJ(.\DP8051\DP8051_Keil_951\Debug\USB_std.obj)

line level    source

   1          /***************************************************************************//**
   2          * \file USB_std.c
   3          * \version 3.10
   4          *
   5          * \brief
   6          *  This file contains the USB Standard request handler.
   7          *
   8          ********************************************************************************
   9          * \copyright
  10          * Copyright 2008-2016, Cypress Semiconductor Corporation.  All rights reserved.
  11          * You may use this file only in accordance with the license, terms, conditions,
  12          * disclaimers, and limitations in the end user license agreement accompanying
  13          * the software package with which this file was provided.
  14          *******************************************************************************/
  15          
  16          #include "USB_pvt.h"
  17          
  18          /***************************************
  19          *   Static data allocation
  20          ***************************************/
  21          
  22          #if defined(USB_ENABLE_FWSN_STRING)
                  static volatile uint8* USB_fwSerialNumberStringDescriptor;
                  static volatile uint8  USB_snStringConfirm = USB_FALSE;
              #endif  /* (USB_ENABLE_FWSN_STRING) */
  26          
  27          #if defined(USB_ENABLE_FWSN_STRING)
                  /***************************************************************************
                  * Function Name: USB_SerialNumString
                  ************************************************************************//**
                  *
                  *  This function is available only when the User Call Back option in the 
                  *  Serial Number String descriptor properties is selected. Application 
                  *  firmware can provide the source of the USB device serial number string 
                  *  descriptor during run time. The default string is used if the application 
                  *  firmware does not use this function or sets the wrong string descriptor.
                  *
                  *  \param snString:  Pointer to the user-defined string descriptor. The 
                  *  string descriptor should meet the Universal Serial Bus Specification 
                  *  revision 2.0 chapter 9.6.7
                  *  Offset|Size|Value|Description
                  *  ------|----|------|---------------------------------
                  *  0     |1   |N     |Size of this descriptor in bytes
                  *  1     |1   |0x03  |STRING Descriptor Type
                  *  2     |N-2 |Number|UNICODE encoded string
                  *  
                  * *For example:* uint8 snString[16]={0x0E,0x03,'F',0,'W',0,'S',0,'N',0,'0',0,'1',0};
                  *
                  * \reentrant
                  *  No.
                  *
                  ***************************************************************************/
                  void  USB_SerialNumString(uint8 snString[]) 
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 2   

                  {
                      USB_snStringConfirm = USB_FALSE;
                      
                      if (snString != NULL)
                      {
                          /* Check descriptor validation */
                          if ((snString[0u] > 1u) && (snString[1u] == USB_DESCR_STRING))
                          {
                              USB_fwSerialNumberStringDescriptor = snString;
                              USB_snStringConfirm = USB_TRUE;
                          }
                      }
                  }
              #endif  /* USB_ENABLE_FWSN_STRING */
  68          
  69          
  70          /*******************************************************************************
  71          * Function Name: USB_HandleStandardRqst
  72          ****************************************************************************//**
  73          *
  74          *  This Routine dispatches standard requests
  75          *
  76          *
  77          * \return
  78          *  TRUE if request handled.
  79          *
  80          * \reentrant
  81          *  No.
  82          *
  83          *******************************************************************************/
  84          uint8 USB_HandleStandardRqst(void) 
  85          {
  86   1          uint8 requestHandled = USB_FALSE;
  87   1          uint8 interfaceNumber;
  88   1          uint8 configurationN;
  89   1          uint8 bmRequestType = USB_bmRequestTypeReg;
  90   1      
  91   1      #if defined(USB_ENABLE_STRINGS)
  92   1          volatile uint8 *pStr = 0u;
  93   1          #if defined(USB_ENABLE_DESCRIPTOR_STRINGS)
  94   1              uint8 nStr;
  95   1              uint8 descrLength;
  96   1          #endif /* (USB_ENABLE_DESCRIPTOR_STRINGS) */
  97   1      #endif /* (USB_ENABLE_STRINGS) */
  98   1          
  99   1          static volatile uint8 USB_tBuffer[USB_STATUS_LENGTH_MAX];
 100   1          const T_USB_LUT CYCODE *pTmp;
 101   1      
 102   1          USB_currentTD.count = 0u;
 103   1      
 104   1          if (USB_RQST_DIR_D2H == (bmRequestType & USB_RQST_DIR_MASK))
 105   1          {
 106   2              /* Control Read */
 107   2              switch (USB_bRequestReg)
 108   2              {
 109   3                  case USB_GET_DESCRIPTOR:
 110   3                      if (USB_DESCR_DEVICE ==USB_wValueHiReg)
 111   3                      {
 112   4                          pTmp = USB_GetDeviceTablePtr();
 113   4                          USB_currentTD.pData = (volatile uint8 *)pTmp->p_list;
 114   4                          USB_currentTD.count = USB_DEVICE_DESCR_LENGTH;
 115   4                          
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 3   

 116   4                          requestHandled  = USB_InitControlRead();
 117   4                      }
 118   3                      else if (USB_DESCR_CONFIG == USB_wValueHiReg)
 119   3                      {
 120   4                          pTmp = USB_GetConfigTablePtr((uint8) USB_wValueLoReg);
 121   4                          
 122   4                          /* Verify that requested descriptor exists */
 123   4                          if (pTmp != NULL)
 124   4                          {
 125   5                              USB_currentTD.pData = (volatile uint8 *)pTmp->p_list;
 126   5                              USB_currentTD.count = (uint16)((uint16)(USB_currentTD.pData)[USB_CONFIG_DESCR_TOTA
             -L_LENGTH_HI] << 8u) | \
 127   5                                                                                  (USB_currentTD.pData)[USB_CONF
             -IG_DESCR_TOTAL_LENGTH_LOW];
 128   5                              requestHandled  = USB_InitControlRead();
 129   5                          }
 130   4                      }
 131   3                      
 132   3                  #if(USB_BOS_ENABLE)
                              else if (USB_DESCR_BOS == USB_wValueHiReg)
                              {
                                  pTmp = USB_GetBOSPtr();
                                  
                                  /* Verify that requested descriptor exists */
                                  if (pTmp != NULL)
                                  {
                                      USB_currentTD.pData = (volatile uint8 *)pTmp;
                                      USB_currentTD.count = ((uint16)((uint16)(USB_currentTD.pData)[USB_BOS_DESCR_TOTAL_
             -LENGTH_HI] << 8u)) | \
                                                                                           (USB_currentTD.pData)[USB_BOS
             -_DESCR_TOTAL_LENGTH_LOW];
                                      requestHandled  = USB_InitControlRead();
                                  }
                              }
                          #endif /*(USB_BOS_ENABLE)*/
 147   3                  
 148   3                  #if defined(USB_ENABLE_STRINGS)
 149   3                      else if (USB_DESCR_STRING == USB_wValueHiReg)
 150   3                      {
 151   4                      /* Descriptor Strings */
 152   4                      #if defined(USB_ENABLE_DESCRIPTOR_STRINGS)
 153   4                          nStr = 0u;
 154   4                          pStr = (volatile uint8 *) &USB_STRING_DESCRIPTORS[0u];
 155   4                          
 156   4                          while ((USB_wValueLoReg > nStr) && (*pStr != 0u))
 157   4                          {
 158   5                              /* Read descriptor length from 1st byte */
 159   5                              descrLength = *pStr;
 160   5                              /* Move to next string descriptor */
 161   5                              pStr = &pStr[descrLength];
 162   5                              nStr++;
 163   5                          }
 164   4                      #endif /* (USB_ENABLE_DESCRIPTOR_STRINGS) */
 165   4                      
 166   4                      /* Microsoft OS String */
 167   4                      #if defined(USB_ENABLE_MSOS_STRING)
 168   4                          if (USB_STRING_MSOS == USB_wValueLoReg)
 169   4                          {
 170   5                              pStr = (volatile uint8 *)& USB_MSOS_DESCRIPTOR[0u];
 171   5                          }
 172   4                      #endif /* (USB_ENABLE_MSOS_STRING) */
 173   4                      
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 4   

 174   4                      /* SN string */
 175   4                      #if defined(USB_ENABLE_SN_STRING)
 176   4                          if ((USB_wValueLoReg != 0u) && 
 177   4                              (USB_wValueLoReg == USB_DEVICE0_DESCR[USB_DEVICE_DESCR_SN_SHIFT]))
 178   4                          {
 179   5                          #if defined(USB_ENABLE_IDSN_STRING)
 180   5                              /* Read DIE ID and generate string descriptor in RAM */
 181   5                              USB_ReadDieID(USB_idSerialNumberStringDescriptor);
 182   5                              pStr = USB_idSerialNumberStringDescriptor;
 183   5                          #elif defined(USB_ENABLE_FWSN_STRING)
                                      
                                      if(USB_snStringConfirm != USB_FALSE)
                                      {
                                          pStr = USB_fwSerialNumberStringDescriptor;
                                      }
                                      else
                                      {
                                          pStr = (volatile uint8 *)&USB_SN_STRING_DESCRIPTOR[0u];
                                      }
                                  #else
                                      pStr = (volatile uint8 *)&USB_SN_STRING_DESCRIPTOR[0u];
                                  #endif  /* (USB_ENABLE_IDSN_STRING) */
 196   5                          }
 197   4                      #endif /* (USB_ENABLE_SN_STRING) */
 198   4                      
 199   4                          if (*pStr != 0u)
 200   4                          {
 201   5                              USB_currentTD.count = *pStr;
 202   5                              USB_currentTD.pData = pStr;
 203   5                              requestHandled  = USB_InitControlRead();
 204   5                          }
 205   4                      }
 206   3                  #endif /*  USB_ENABLE_STRINGS */
 207   3                      else
 208   3                      {
 209   4                          requestHandled = USB_DispatchClassRqst();
 210   4                      }
 211   3                      break;
 212   3                      
 213   3                  case USB_GET_STATUS:
 214   3                      switch (bmRequestType & USB_RQST_RCPT_MASK)
 215   3                      {
 216   4                          case USB_RQST_RCPT_EP:
 217   4                              USB_currentTD.count = USB_EP_STATUS_LENGTH;
 218   4                              USB_tBuffer[0u]     = USB_EP[USB_wIndexLoReg & USB_DIR_UNUSED].hwEpState;
 219   4                              USB_tBuffer[1u]     = 0u;
 220   4                              USB_currentTD.pData = &USB_tBuffer[0u];
 221   4                              
 222   4                              requestHandled  = USB_InitControlRead();
 223   4                              break;
 224   4                          case USB_RQST_RCPT_DEV:
 225   4                              USB_currentTD.count = USB_DEVICE_STATUS_LENGTH;
 226   4                              USB_tBuffer[0u]     = USB_deviceStatus;
 227   4                              USB_tBuffer[1u]     = 0u;
 228   4                              USB_currentTD.pData = &USB_tBuffer[0u];
 229   4                              
 230   4                              requestHandled  = USB_InitControlRead();
 231   4                              break;
 232   4                          default:    /* requestHandled is initialized as FALSE by default */
 233   4                              break;
 234   4                      }
 235   3                      break;
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 5   

 236   3                      
 237   3                  case USB_GET_CONFIGURATION:
 238   3                      USB_currentTD.count = 1u;
 239   3                      USB_currentTD.pData = (volatile uint8 *) &USB_configuration;
 240   3                      requestHandled  = USB_InitControlRead();
 241   3                      break;
 242   3                      
 243   3                  case USB_GET_INTERFACE:
 244   3                      USB_currentTD.count = 1u;
 245   3                      USB_currentTD.pData = (volatile uint8 *) &USB_interfaceSetting[USB_wIndexLoReg];
 246   3                      requestHandled  = USB_InitControlRead();
 247   3                      break;
 248   3                      
 249   3                  default: /* requestHandled is initialized as FALSE by default */
 250   3                      break;
 251   3              }
 252   2          }
 253   1          else
 254   1          {
 255   2              /* Control Write */
 256   2              switch (USB_bRequestReg)
 257   2              {
 258   3                  case USB_SET_ADDRESS:
 259   3                      /* Store address to be set in USB_NoDataControlStatusStage(). */
 260   3                      USB_deviceAddress = (uint8) USB_wValueLoReg;
 261   3                      requestHandled = USB_InitNoDataControlTransfer();
 262   3                      break;
 263   3                      
 264   3                  case USB_SET_CONFIGURATION:
 265   3                      configurationN = USB_wValueLoReg;
 266   3                      
 267   3                      /* Verify that configuration descriptor exists */
 268   3                      if(configurationN > 0u)
 269   3                      {
 270   4                          pTmp = USB_GetConfigTablePtr((uint8) configurationN - 1u);
 271   4                      }
 272   3                      
 273   3                      /* Responds with a Request Error when configuration number is invalid */
 274   3                      if (((configurationN > 0u) && (pTmp != NULL)) || (configurationN == 0u))
 275   3                      {
 276   4                          /* Set new configuration if it has been changed */
 277   4                          if(configurationN != USB_configuration)
 278   4                          {
 279   5                              USB_configuration = (uint8) configurationN;
 280   5                              USB_configurationChanged = USB_TRUE;
 281   5                              USB_Config(USB_TRUE);
 282   5                          }
 283   4                          requestHandled = USB_InitNoDataControlTransfer();
 284   4                      }
 285   3                      break;
 286   3                      
 287   3                  case USB_SET_INTERFACE:
 288   3                      if (0u != USB_ValidateAlternateSetting())
 289   3                      {
 290   4                          /* Get interface number from the request. */
 291   4                          interfaceNumber = USB_wIndexLoReg;
 292   4                          USB_interfaceNumber = (uint8) USB_wIndexLoReg;
 293   4                           
 294   4                          /* Check if alternate settings is changed for interface. */
 295   4                          if (USB_interfaceSettingLast[interfaceNumber] != USB_interfaceSetting[interfaceNumber]
             -)
 296   4                          {
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 6   

 297   5                              USB_configurationChanged = USB_TRUE;
 298   5                          
 299   5                              /* Change alternate setting for the endpoints. */
 300   5                          #if (USB_EP_MANAGEMENT_MANUAL && USB_EP_ALLOC_DYNAMIC)
                                      USB_Config(USB_FALSE);
                                  #else
 303   5                              USB_ConfigAltChanged();
 304   5                          #endif /* (USB_EP_MANAGEMENT_MANUAL && USB_EP_ALLOC_DYNAMIC) */
 305   5                          }
 306   4                          
 307   4                          requestHandled = USB_InitNoDataControlTransfer();
 308   4                      }
 309   3                      break;
 310   3                      
 311   3                  case USB_CLEAR_FEATURE:
 312   3                      switch (bmRequestType & USB_RQST_RCPT_MASK)
 313   3                      {
 314   4                          case USB_RQST_RCPT_EP:
 315   4                              if (USB_wValueLoReg == USB_ENDPOINT_HALT)
 316   4                              {
 317   5                                  requestHandled = USB_ClearEndpointHalt();
 318   5                              }
 319   4                              break;
 320   4                          case USB_RQST_RCPT_DEV:
 321   4                              /* Clear device REMOTE_WAKEUP */
 322   4                              if (USB_wValueLoReg == USB_DEVICE_REMOTE_WAKEUP)
 323   4                              {
 324   5                                  USB_deviceStatus &= (uint8)~USB_DEVICE_STATUS_REMOTE_WAKEUP;
 325   5                                  requestHandled = USB_InitNoDataControlTransfer();
 326   5                              }
 327   4                              break;
 328   4                          case USB_RQST_RCPT_IFC:
 329   4                              /* Validate interfaceNumber */
 330   4                              if (USB_wIndexLoReg < USB_MAX_INTERFACES_NUMBER)
 331   4                              {
 332   5                                  USB_interfaceStatus[USB_wIndexLoReg] &= (uint8) ~USB_wValueLoReg;
 333   5                                  requestHandled = USB_InitNoDataControlTransfer();
 334   5                              }
 335   4                              break;
 336   4                          default:    /* requestHandled is initialized as FALSE by default */
 337   4                              break;
 338   4                      }
 339   3                      break;
 340   3                      
 341   3                  case USB_SET_FEATURE:
 342   3                      switch (bmRequestType & USB_RQST_RCPT_MASK)
 343   3                      {
 344   4                          case USB_RQST_RCPT_EP:
 345   4                              if (USB_wValueLoReg == USB_ENDPOINT_HALT)
 346   4                              {
 347   5                                  requestHandled = USB_SetEndpointHalt();
 348   5                              }
 349   4                              break;
 350   4                              
 351   4                          case USB_RQST_RCPT_DEV:
 352   4                              /* Set device REMOTE_WAKEUP */
 353   4                              if (USB_wValueLoReg == USB_DEVICE_REMOTE_WAKEUP)
 354   4                              {
 355   5                                  USB_deviceStatus |= USB_DEVICE_STATUS_REMOTE_WAKEUP;
 356   5                                  requestHandled = USB_InitNoDataControlTransfer();
 357   5                              }
 358   4                              break;
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 7   

 359   4                              
 360   4                          case USB_RQST_RCPT_IFC:
 361   4                              /* Validate interfaceNumber */
 362   4                              if (USB_wIndexLoReg < USB_MAX_INTERFACES_NUMBER)
 363   4                              {
 364   5                                  USB_interfaceStatus[USB_wIndexLoReg] &= (uint8) ~USB_wValueLoReg;
 365   5                                  requestHandled = USB_InitNoDataControlTransfer();
 366   5                              }
 367   4                              break;
 368   4                          
 369   4                          default:    /* requestHandled is initialized as FALSE by default */
 370   4                              break;
 371   4                      }
 372   3                      break;
 373   3                      
 374   3                  default:    /* requestHandled is initialized as FALSE by default */
 375   3                      break;
 376   3              }
 377   2          }
 378   1          
 379   1          return (requestHandled);
 380   1      }
 381          
 382          
 383          #if defined(USB_ENABLE_IDSN_STRING)
 384              /***************************************************************************
 385              * Function Name: USB_ReadDieID
 386              ************************************************************************//**
 387              *
 388              *  This routine read Die ID and generate Serial Number string descriptor.
 389              *
 390              *  \param descr:  pointer on string descriptor. This string size has to be equal or
 391              *          greater than USB_IDSN_DESCR_LENGTH.
 392              *
 393              *
 394              * \reentrant
 395              *  No.
 396              *
 397              ***************************************************************************/
 398              void USB_ReadDieID(uint8 descr[]) 
 399              {
 400   1              const char8 CYCODE hex[] = "0123456789ABCDEF";
 401   1              uint8 i;
 402   1              uint8 j = 0u;
 403   1              uint8 uniqueId[8u];
 404   1      
 405   1              if (NULL != descr)
 406   1              {
 407   2                  /* Initialize descriptor header. */
 408   2                  descr[0u] = USB_IDSN_DESCR_LENGTH;
 409   2                  descr[1u] = USB_DESCR_STRING;
 410   2                  
 411   2                  /* Unique ID size is 8 bytes. */
 412   2                  CyGetUniqueId((uint32 *) uniqueId);
 413   2      
 414   2                  /* Fill descriptor with unique device ID. */
 415   2                  for (i = 2u; i < USB_IDSN_DESCR_LENGTH; i += 4u)
 416   2                  {
 417   3                      descr[i]      = (uint8) hex[(uniqueId[j] >> 4u)];
 418   3                      descr[i + 1u] = 0u;
 419   3                      descr[i + 2u] = (uint8) hex[(uniqueId[j] & 0x0Fu)];
 420   3                      descr[i + 3u] = 0u;
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 8   

 421   3                      ++j;
 422   3                  }
 423   2              }
 424   1          }
 425          #endif /* (USB_ENABLE_IDSN_STRING) */
 426          
 427          
 428          /*******************************************************************************
 429          * Function Name: USB_ConfigReg
 430          ****************************************************************************//**
 431          *
 432          *  This routine configures hardware registers from the variables.
 433          *  It is called from USB_Config() function and from RestoreConfig
 434          *  after Wakeup.
 435          *
 436          *******************************************************************************/
 437          void USB_ConfigReg(void) CYREENTRANT
 438          {
 439   1          uint8 ep;
 440   1      
 441   1      #if (USB_EP_MANAGEMENT_DMA_AUTO)
                  uint8 epType = 0u;
              #endif /* (USB_EP_MANAGEMENT_DMA_AUTO) */
 444   1      
 445   1          /* Go thought all endpoints and set hardware configuration */
 446   1          for (ep = USB_EP1; ep < USB_MAX_EP; ++ep)
 447   1          {
 448   2              USB_ARB_EP_BASE.arbEp[ep].epCfg = USB_ARB_EPX_CFG_DEFAULT;
 449   2              
 450   2          #if (USB_EP_MANAGEMENT_DMA)
                      /* Enable arbiter endpoint interrupt sources */
                      USB_ARB_EP_BASE.arbEp[ep].epIntEn = USB_ARB_EPX_INT_MASK;
                  #endif /* (USB_EP_MANAGEMENT_DMA) */
 454   2          
 455   2              if (USB_EP[ep].epMode != USB_MODE_DISABLE)
 456   2              {
 457   3                  if (0u != (USB_EP[ep].addr & USB_DIR_IN))
 458   3                  {
 459   4                      USB_SIE_EP_BASE.sieEp[ep].epCr0 = USB_MODE_NAK_IN;
 460   4                      
 461   4                  #if (USB_EP_MANAGEMENT_DMA_AUTO && CY_PSOC4)
                              /* Clear DMA_TERMIN for IN endpoint. */
                              USB_ARB_EP_BASE.arbEp[ep].epIntEn &= (uint32) ~USB_ARB_EPX_INT_DMA_TERMIN;
                          #endif /* (USB_EP_MANAGEMENT_DMA_AUTO && CY_PSOC4) */
 465   4                  }
 466   3                  else
 467   3                  {
 468   4                      USB_SIE_EP_BASE.sieEp[ep].epCr0 = USB_MODE_NAK_OUT;
 469   4      
 470   4                  #if (USB_EP_MANAGEMENT_DMA_AUTO)
                              /* (CY_PSOC4): DMA_TERMIN for OUT endpoint is set above. */
                              
                              /* Prepare endpoint type mask. */
                              epType |= (uint8) (0x01u << (ep - USB_EP1));
                          #endif /* (USB_EP_MANAGEMENT_DMA_AUTO) */
 476   4                  }
 477   3              }
 478   2              else
 479   2              {
 480   3                  USB_SIE_EP_BASE.sieEp[ep].epCr0 = USB_MODE_STALL_DATA_EP;
 481   3              }
 482   2              
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 9   

 483   2          #if (!USB_EP_MANAGEMENT_DMA_AUTO)
 484   2              #if (CY_PSOC4)
                          USB_ARB_EP16_BASE.arbEp[ep].rwRa16  = (uint32) USB_EP[ep].buffOffset;
                          USB_ARB_EP16_BASE.arbEp[ep].rwWa16  = (uint32) USB_EP[ep].buffOffset;
                      #else
 488   2                  USB_ARB_EP_BASE.arbEp[ep].rwRa    = LO8(USB_EP[ep].buffOffset);
 489   2                  USB_ARB_EP_BASE.arbEp[ep].rwRaMsb = HI8(USB_EP[ep].buffOffset);
 490   2                  USB_ARB_EP_BASE.arbEp[ep].rwWa    = LO8(USB_EP[ep].buffOffset);
 491   2                  USB_ARB_EP_BASE.arbEp[ep].rwWaMsb = HI8(USB_EP[ep].buffOffset);
 492   2              #endif /* (CY_PSOC4) */
 493   2          #endif /* (!USB_EP_MANAGEMENT_DMA_AUTO) */
 494   2          }
 495   1      
 496   1      #if (USB_EP_MANAGEMENT_DMA_AUTO)
                   /* BUF_SIZE depend on DMA_THRESS value:0x55-32 bytes  0x44-16 bytes 0x33-8 bytes 0x22-4 bytes 0x11-2 
             -bytes */
                  USB_BUF_SIZE_REG = USB_DMA_BUF_SIZE;
              
                  /* Configure DMA burst threshold */
              #if (CY_PSOC4)
                  USB_DMA_THRES16_REG   = USB_DMA_BYTES_PER_BURST;
              #else
                  USB_DMA_THRES_REG     = USB_DMA_BYTES_PER_BURST;
                  USB_DMA_THRES_MSB_REG = 0u;
              #endif /* (CY_PSOC4) */
                  USB_EP_ACTIVE_REG = USB_DEFAULT_ARB_INT_EN;
                  USB_EP_TYPE_REG   = epType;
                  
                  /* Cfg_cmp bit set to 1 once configuration is complete. */
                  /* Lock arbiter configtuation */
                  USB_ARB_CFG_REG |= (uint8)  USB_ARB_CFG_CFG_CMP;
                  /* Cfg_cmp bit set to 0 during configuration of PFSUSB Registers. */
                  USB_ARB_CFG_REG &= (uint8) ~USB_ARB_CFG_CFG_CMP;
              
              #endif /* (USB_EP_MANAGEMENT_DMA_AUTO) */
 517   1      
 518   1          /* Enable interrupt SIE interurpt source from EP0-EP1 */
 519   1          USB_SIE_EP_INT_EN_REG = (uint8) USB_DEFAULT_SIE_EP_INT_EN;
 520   1      }
 521          
 522          
 523          /*******************************************************************************
 524          * Function Name: USB_EpStateInit
 525          ****************************************************************************//**
 526          *
 527          *  This routine initialize state of Data end points based of its type: 
 528          *   IN  - USB_IN_BUFFER_EMPTY (USB_EVENT_PENDING)
 529          *   OUT - USB_OUT_BUFFER_EMPTY (USB_NO_EVENT_PENDING)
 530          *
 531          *******************************************************************************/
 532          void USB_EpStateInit(void) 
 533          {
 534   1          uint8 i;
 535   1      
 536   1          for (i = USB_EP1; i < USB_MAX_EP; i++)
 537   1          { 
 538   2              if (0u != (USB_EP[i].addr & USB_DIR_IN))
 539   2              {
 540   3                  /* IN Endpoint */
 541   3                  USB_EP[i].apiEpState = USB_EVENT_PENDING;
 542   3              }
 543   2              else
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 10  

 544   2              {
 545   3                  /* OUT Endpoint */
 546   3                  USB_EP[i].apiEpState = USB_NO_EVENT_PENDING;
 547   3              }
 548   2          }
 549   1                          
 550   1      }
 551          
 552          
 553          /*******************************************************************************
 554          * Function Name: USB_Config
 555          ****************************************************************************//**
 556          *
 557          *  This routine configures endpoints for the entire configuration by scanning
 558          *  the configuration descriptor.
 559          *
 560          *  \param clearAltSetting: It configures the bAlternateSetting 0 for each interface.
 561          *
 562          * USB_interfaceClass - Initialized class array for each interface.
 563          *   It is used for handling Class specific requests depend on interface class.
 564          *   Different classes in multiple Alternate settings does not supported.
 565          *
 566          * \reentrant
 567          *  No.
 568          *
 569          *******************************************************************************/
 570          void USB_Config(uint8 clearAltSetting) CYREENTRANT
 571          {
 572   1          uint8 ep;
 573   1          uint8 curEp;
 574   1          uint8 i;
 575   1          uint8 epType;
 576   1          const uint8 *pDescr;
 577   1          
 578   1          #if (!USB_EP_MANAGEMENT_DMA_AUTO)
 579   1              uint16 buffCount = 0u;
 580   1          #endif /* (!USB_EP_MANAGEMENT_DMA_AUTO) */
 581   1      
 582   1          const T_USB_LUT CYCODE *pTmp;
 583   1          const T_USB_EP_SETTINGS_BLOCK CYCODE *pEP;
 584   1      
 585   1          /* Clear endpoints settings */
 586   1          for (ep = 0u; ep < USB_MAX_EP; ++ep)
 587   1          {
 588   2              USB_EP[ep].attrib     = 0u;
 589   2              USB_EP[ep].hwEpState  = 0u;
 590   2              USB_EP[ep].epToggle   = 0u;
 591   2              USB_EP[ep].bufferSize = 0u;
 592   2              USB_EP[ep].interface  = 0u;
 593   2              USB_EP[ep].apiEpState = USB_NO_EVENT_PENDING;
 594   2              USB_EP[ep].epMode     = USB_MODE_DISABLE;   
 595   2          }
 596   1      
 597   1          /* Clear Alternate settings for all interfaces. */
 598   1          if (0u != clearAltSetting)
 599   1          {
 600   2              for (i = 0u; i < USB_MAX_INTERFACES_NUMBER; ++i)
 601   2              {
 602   3                  USB_interfaceSetting[i]     = 0u;
 603   3                  USB_interfaceSettingLast[i] = 0u;
 604   3              }
 605   2          }
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 11  

 606   1      
 607   1          /* Init Endpoints and Device Status if configured */
 608   1          if (USB_configuration > 0u)
 609   1          {
 610   2              #if defined(USB_ENABLE_CDC_CLASS)
                          uint8 cdcComNums = 0u;
                      #endif  /* (USB_ENABLE_CDC_CLASS) */  
 613   2      
 614   2              pTmp = USB_GetConfigTablePtr(USB_configuration - 1u);
 615   2              
 616   2              /* Set Power status for current configuration */
 617   2              pDescr = (const uint8 *)pTmp->p_list;
 618   2              if ((pDescr[USB_CONFIG_DESCR_ATTRIB] & USB_CONFIG_DESCR_ATTRIB_SELF_POWERED) != 0u)
 619   2              {
 620   3                  USB_deviceStatus |= (uint8)  USB_DEVICE_STATUS_SELF_POWERED;
 621   3              }
 622   2              else
 623   2              {
 624   3                  USB_deviceStatus &= (uint8) ~USB_DEVICE_STATUS_SELF_POWERED;
 625   3              }
 626   2              
 627   2              /* Move to next element */
 628   2              pTmp = &pTmp[1u];
 629   2              ep = pTmp->c;  /* For this table, c is the number of endpoints configurations  */
 630   2      
 631   2              #if (USB_EP_MANAGEMENT_MANUAL && USB_EP_ALLOC_DYNAMIC)
                          /* Configure for dynamic EP memory allocation */
                          /* p_list points the endpoint setting table. */
                          pEP = (T_USB_EP_SETTINGS_BLOCK *) pTmp->p_list;
                          
                          for (i = 0u; i < ep; i++)
                          {     
                              /* Compare current Alternate setting with EP Alt */
                              if (USB_interfaceSetting[pEP->interface] == pEP->altSetting)
                              {                                                          
                                  curEp  = pEP->addr & USB_DIR_UNUSED;
                                  epType = pEP->attributes & USB_EP_TYPE_MASK;
                                  
                                  USB_EP[curEp].addr       = pEP->addr;
                                  USB_EP[curEp].attrib     = pEP->attributes;
                                  USB_EP[curEp].bufferSize = pEP->bufferSize;
              
                                  if (0u != (pEP->addr & USB_DIR_IN))
                                  {
                                      /* IN Endpoint */
                                      USB_EP[curEp].epMode     = USB_GET_ACTIVE_IN_EP_CR0_MODE(epType);
                                      USB_EP[curEp].apiEpState = USB_EVENT_PENDING;
                                  
                                  #if (defined(USB_ENABLE_MIDI_STREAMING) && (USB_MIDI_IN_BUFF_SIZE > 0))
                                      if ((pEP->bMisc == USB_CLASS_AUDIO) && (epType == USB_EP_TYPE_BULK))
                                      {
                                          USB_midi_in_ep = curEp;
                                      }
                                  #endif  /* (USB_ENABLE_MIDI_STREAMING) */
                                  }
                                  else
                                  {
                                      /* OUT Endpoint */
                                      USB_EP[curEp].epMode     = USB_GET_ACTIVE_OUT_EP_CR0_MODE(epType);
                                      USB_EP[curEp].apiEpState = USB_NO_EVENT_PENDING;
                                      
                                  #if (defined(USB_ENABLE_MIDI_STREAMING) && (USB_MIDI_OUT_BUFF_SIZE > 0))
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 12  

                                      if ((pEP->bMisc == USB_CLASS_AUDIO) && (epType == USB_EP_TYPE_BULK))
                                      {
                                          USB_midi_out_ep = curEp;
                                      }
                                  #endif  /* (USB_ENABLE_MIDI_STREAMING) */
                                  }
              
                              #if(defined (USB_ENABLE_CDC_CLASS))
                                  if((pEP->bMisc == USB_CLASS_CDC_DATA) ||(pEP->bMisc == USB_CLASS_CDC))
                                  {
                                      cdcComNums = USB_Cdc_EpInit(pEP, curEp, cdcComNums);
                                  }
                              #endif  /* (USB_ENABLE_CDC_CLASS) */
                              }
                              
                              pEP = &pEP[1u];
                          }
                          
                      #else
 687   2                  for (i = USB_EP1; i < USB_MAX_EP; ++i)
 688   2                  {
 689   3                      /* p_list points the endpoint setting table. */
 690   3                      pEP = (const T_USB_EP_SETTINGS_BLOCK CYCODE *) pTmp->p_list;
 691   3                      /* Find max length for each EP and select it (length could be different in different Alt s
             -ettings) */
 692   3                      /* but other settings should be correct with regards to Interface alt Setting */
 693   3                      
 694   3                      for (curEp = 0u; curEp < ep; ++curEp)
 695   3                      {
 696   4                          if (i == (pEP->addr & USB_DIR_UNUSED))
 697   4                          {
 698   5                              /* Compare endpoint buffers size with current size to find greater. */
 699   5                              if (USB_EP[i].bufferSize < pEP->bufferSize)
 700   5                              {
 701   6                                  USB_EP[i].bufferSize = pEP->bufferSize;
 702   6                              }
 703   5                              
 704   5                              /* Compare current Alternate setting with EP Alt */
 705   5                              if (USB_interfaceSetting[pEP->interface] == pEP->altSetting)
 706   5                              {                            
 707   6                                  USB_EP[i].addr = pEP->addr;
 708   6                                  USB_EP[i].attrib = pEP->attributes;
 709   6                                  
 710   6                                  epType = pEP->attributes & USB_EP_TYPE_MASK;
 711   6                                  
 712   6                                  if (0u != (pEP->addr & USB_DIR_IN))
 713   6                                  {
 714   7                                      /* IN Endpoint */
 715   7                                      USB_EP[i].epMode     = USB_GET_ACTIVE_IN_EP_CR0_MODE(epType);
 716   7                                      USB_EP[i].apiEpState = USB_EVENT_PENDING;
 717   7                                      
 718   7                                  #if (defined(USB_ENABLE_MIDI_STREAMING) && (USB_MIDI_IN_BUFF_SIZE > 0))
 719   7                                      if ((pEP->bMisc == USB_CLASS_AUDIO) && (epType == USB_EP_TYPE_BULK))
 720   7                                      {
 721   8                                          USB_midi_in_ep = i;
 722   8                                      }
 723   7                                  #endif  /* (USB_ENABLE_MIDI_STREAMING) */
 724   7                                  }
 725   6                                  else
 726   6                                  {
 727   7                                      /* OUT Endpoint */
 728   7                                      USB_EP[i].epMode     = USB_GET_ACTIVE_OUT_EP_CR0_MODE(epType);
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 13  

 729   7                                      USB_EP[i].apiEpState = USB_NO_EVENT_PENDING;
 730   7                                      
 731   7                                  #if (defined(USB_ENABLE_MIDI_STREAMING) && (USB_MIDI_OUT_BUFF_SIZE > 0))
 732   7                                      if ((pEP->bMisc == USB_CLASS_AUDIO) && (epType == USB_EP_TYPE_BULK))
 733   7                                      {
 734   8                                          USB_midi_out_ep = i;
 735   8                                      }
 736   7                                  #endif  /* (USB_ENABLE_MIDI_STREAMING) */
 737   7                                  }
 738   6      
 739   6                              #if (defined(USB_ENABLE_CDC_CLASS))
                                          if((pEP->bMisc == USB_CLASS_CDC_DATA) ||(pEP->bMisc == USB_CLASS_CDC))
                                          {
                                              cdcComNums = USB_Cdc_EpInit(pEP, i, cdcComNums);
                                          }
                                      #endif  /* (USB_ENABLE_CDC_CLASS) */
 745   6      
 746   6                                  #if (USB_EP_MANAGEMENT_DMA_AUTO)
                                              break;  /* Use first EP setting in Auto memory management */
                                          #endif /* (USB_EP_MANAGEMENT_DMA_AUTO) */
 749   6                              }
 750   5                          }
 751   4                          
 752   4                          pEP = &pEP[1u];
 753   4                      }
 754   3                  }
 755   2              #endif /*  (USB_EP_MANAGEMENT_MANUAL && USB_EP_ALLOC_DYNAMIC) */
 756   2      
 757   2              /* Init class array for each interface and interface number for each EP.
 758   2              *  It is used for handling Class specific requests directed to either an
 759   2              *  interface or the endpoint.
 760   2              */
 761   2              /* p_list points the endpoint setting table. */
 762   2              pEP = (const T_USB_EP_SETTINGS_BLOCK CYCODE *) pTmp->p_list;
 763   2              for (i = 0u; i < ep; i++)
 764   2              {
 765   3                  /* Configure interface number for each EP */
 766   3                  USB_EP[pEP->addr & USB_DIR_UNUSED].interface = pEP->interface;
 767   3                  pEP = &pEP[1u];
 768   3              }
 769   2              
 770   2              /* Init pointer on interface class table */
 771   2              USB_interfaceClass = USB_GetInterfaceClassTablePtr();
 772   2              
 773   2          /* Set the endpoint buffer addresses */
 774   2          #if (!USB_EP_MANAGEMENT_DMA_AUTO)
 775   2              buffCount = 0u;
 776   2              for (ep = USB_EP1; ep < USB_MAX_EP; ++ep)
 777   2              {
 778   3                  USB_EP[ep].buffOffset = buffCount;        
 779   3                  buffCount += USB_EP[ep].bufferSize;
 780   3                  
 781   3              #if (USB_GEN_16BITS_EP_ACCESS)
 782   3                  /* Align EP buffers to be event size to access 16-bits DR register. */
 783   3                  buffCount += (0u != (buffCount & 0x01u)) ? 1u : 0u;
 784   3              #endif /* (USB_GEN_16BITS_EP_ACCESS) */            
 785   3              }
 786   2          #endif /* (!USB_EP_MANAGEMENT_DMA_AUTO) */
 787   2      
 788   2              /* Configure hardware registers */
 789   2              USB_ConfigReg();
 790   2          }
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 14  

 791   1      }
 792          
 793          
 794          /*******************************************************************************
 795          * Function Name: USB_ConfigAltChanged
 796          ****************************************************************************//**
 797          *
 798          *  This routine update configuration for the required endpoints only.
 799          *  It is called after SET_INTERFACE request when Static memory allocation used.
 800          *
 801          * \reentrant
 802          *  No.
 803          *
 804          *******************************************************************************/
 805          void USB_ConfigAltChanged(void) 
 806          {
 807   1          uint8 ep;
 808   1          uint8 curEp;
 809   1          uint8 epType;
 810   1          uint8 i;
 811   1          uint8 interfaceNum;
 812   1      
 813   1          const T_USB_LUT CYCODE *pTmp;
 814   1          const T_USB_EP_SETTINGS_BLOCK CYCODE *pEP;
 815   1      
 816   1          /* Init Endpoints and Device Status if configured */
 817   1          if (USB_configuration > 0u)
 818   1          {
 819   2              /* Get number of endpoints configurations (ep). */
 820   2              pTmp = USB_GetConfigTablePtr(USB_configuration - 1u);
 821   2              pTmp = &pTmp[1u];
 822   2              ep = pTmp->c;
 823   2      
 824   2              /* Get pointer to endpoints setting table (pEP). */
 825   2              pEP = (const T_USB_EP_SETTINGS_BLOCK CYCODE *) pTmp->p_list;
 826   2              
 827   2              /* Look through all possible endpoint configurations. Find endpoints 
 828   2              * which belong to current interface and alternate settings for 
 829   2              * re-configuration.
 830   2              */
 831   2              interfaceNum = USB_interfaceNumber;
 832   2              for (i = 0u; i < ep; i++)
 833   2              {
 834   3                  /* Find endpoints which belong to current interface and alternate settings. */
 835   3                  if ((interfaceNum == pEP->interface) && 
 836   3                      (USB_interfaceSetting[interfaceNum] == pEP->altSetting))
 837   3                  {
 838   4                      curEp  = ((uint8) pEP->addr & USB_DIR_UNUSED);
 839   4                      epType = ((uint8) pEP->attributes & USB_EP_TYPE_MASK);
 840   4                      
 841   4                      /* Change the SIE mode for the selected EP to NAK ALL */
 842   4                      USB_EP[curEp].epToggle   = 0u;
 843   4                      USB_EP[curEp].addr       = pEP->addr;
 844   4                      USB_EP[curEp].attrib     = pEP->attributes;
 845   4                      USB_EP[curEp].bufferSize = pEP->bufferSize;
 846   4      
 847   4                      if (0u != (pEP->addr & USB_DIR_IN))
 848   4                      {
 849   5                          /* IN Endpoint */
 850   5                          USB_EP[curEp].epMode     = USB_GET_ACTIVE_IN_EP_CR0_MODE(epType);
 851   5                          USB_EP[curEp].apiEpState = USB_EVENT_PENDING;
 852   5                      }
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 15  

 853   4                      else
 854   4                      {
 855   5                          /* OUT Endpoint */
 856   5                          USB_EP[curEp].epMode     = USB_GET_ACTIVE_OUT_EP_CR0_MODE(epType);
 857   5                          USB_EP[curEp].apiEpState = USB_NO_EVENT_PENDING;
 858   5                      }
 859   4                      
 860   4                      /* Make SIE to NAK any endpoint requests */
 861   4                      USB_SIE_EP_BASE.sieEp[curEp].epCr0 = USB_MODE_NAK_IN_OUT;
 862   4      
 863   4                  #if (USB_EP_MANAGEMENT_DMA_AUTO)
                              /* Clear IN data ready. */
                              USB_ARB_EP_BASE.arbEp[curEp].epCfg &= (uint8) ~USB_ARB_EPX_CFG_IN_DATA_RDY;
              
                              /* Select endpoint number of reconfiguration */
                              USB_DYN_RECONFIG_REG = (uint8) ((curEp - 1u) << USB_DYN_RECONFIG_EP_SHIFT);
                              
                              /* Request for dynamic re-configuration of endpoint. */
                              USB_DYN_RECONFIG_REG |= USB_DYN_RECONFIG_ENABLE;
                              
                              /* Wait until block is ready for re-configuration */
                              while (0u == (USB_DYN_RECONFIG_REG & USB_DYN_RECONFIG_RDY_STS))
                              {
                              }
                              
                              /* Once DYN_RECONFIG_RDY_STS bit is set, FW can change the EP configuration. */
                              /* Change EP Type with new direction */
                              if (0u != (pEP->addr & USB_DIR_IN))
                              {
                                  /* Set endpoint type: 0 - IN and 1 - OUT. */
                                  USB_EP_TYPE_REG &= (uint8) ~(uint8)((uint8) 0x01u << (curEp - 1u));
                                  
                              #if (CY_PSOC4)
                                  /* Clear DMA_TERMIN for IN endpoint */
                                  USB_ARB_EP_BASE.arbEp[curEp].epIntEn &= (uint32) ~USB_ARB_EPX_INT_DMA_TERMIN;
                              #endif /* (CY_PSOC4) */
                              }
                              else
                              {
                                  /* Set endpoint type: 0 - IN and 1- OUT. */
                                  USB_EP_TYPE_REG |= (uint8) ((uint8) 0x01u << (curEp - 1u));
                                  
                              #if (CY_PSOC4)
                                  /* Set DMA_TERMIN for OUT endpoint */
                                  USB_ARB_EP_BASE.arbEp[curEp].epIntEn |= (uint32) USB_ARB_EPX_INT_DMA_TERMIN;
                              #endif /* (CY_PSOC4) */
                              }
                              
                              /* Complete dynamic re-configuration: all endpoint related status and signals 
                              * are set into the default state.
                              */
                              USB_DYN_RECONFIG_REG &= (uint8) ~USB_DYN_RECONFIG_ENABLE;
              
                          #else
 907   4                      USB_SIE_EP_BASE.sieEp[curEp].epCnt0 = HI8(USB_EP[curEp].bufferSize);
 908   4                      USB_SIE_EP_BASE.sieEp[curEp].epCnt1 = LO8(USB_EP[curEp].bufferSize);
 909   4                      
 910   4                      #if (CY_PSOC4)
                                  USB_ARB_EP16_BASE.arbEp[curEp].rwRa16  = (uint32) USB_EP[curEp].buffOffset;
                                  USB_ARB_EP16_BASE.arbEp[curEp].rwWa16  = (uint32) USB_EP[curEp].buffOffset;
                              #else
 914   4                          USB_ARB_EP_BASE.arbEp[curEp].rwRa    = LO8(USB_EP[curEp].buffOffset);
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 16  

 915   4                          USB_ARB_EP_BASE.arbEp[curEp].rwRaMsb = HI8(USB_EP[curEp].buffOffset);
 916   4                          USB_ARB_EP_BASE.arbEp[curEp].rwWa    = LO8(USB_EP[curEp].buffOffset);
 917   4                          USB_ARB_EP_BASE.arbEp[curEp].rwWaMsb = HI8(USB_EP[curEp].buffOffset);
 918   4                      #endif /* (CY_PSOC4) */                
 919   4                  #endif /* (USB_EP_MANAGEMENT_DMA_AUTO) */
 920   4                  }
 921   3                  
 922   3                  pEP = &pEP[1u]; /* Get next EP element */
 923   3              }
 924   2              
 925   2              /* The main loop has to re-enable DMA and OUT endpoint */
 926   2          }
 927   1      }
 928          
 929          
 930          /*******************************************************************************
 931          * Function Name: USB_GetConfigTablePtr
 932          ****************************************************************************//**
 933          *
 934          *  This routine returns a pointer a configuration table entry
 935          *
 936          *  \param confIndex:  Configuration Index
 937          *
 938          * \return
 939          *  Device Descriptor pointer or NULL when descriptor does not exist.
 940          *
 941          *******************************************************************************/
 942          const T_USB_LUT CYCODE *USB_GetConfigTablePtr(uint8 confIndex)
 943                                                                  CYREENTRANT
 944          {
 945   1          /* Device Table */
 946   1          const T_USB_LUT CYCODE *pTmp;
 947   1      
 948   1          pTmp = (const T_USB_LUT CYCODE *) USB_TABLE[USB_device].p_list;
 949   1      
 950   1          /* The first entry points to the Device Descriptor,
 951   1          *  the second entry point to the BOS Descriptor
 952   1          *  the rest configuration entries.
 953   1          *  Set pointer to the first Configuration Descriptor
 954   1          */
 955   1          pTmp = &pTmp[2u];
 956   1          /* For this table, c is the number of configuration descriptors  */
 957   1          if(confIndex >= pTmp->c)   /* Verify that required configuration descriptor exists */
 958   1          {
 959   2              pTmp = (const T_USB_LUT CYCODE *) NULL;
 960   2          }
 961   1          else
 962   1          {
 963   2              pTmp = (const T_USB_LUT CYCODE *) pTmp[confIndex].p_list;
 964   2          }
 965   1      
 966   1          return (pTmp);
 967   1      }
 968          
 969          
 970          #if (USB_BOS_ENABLE)
                  /*******************************************************************************
                  * Function Name: USB_GetBOSPtr
                  ****************************************************************************//**
                  *
                  *  This routine returns a pointer a BOS table entry
                  *
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 17  

                  *  
                  *
                  * \return
                  *  BOS Descriptor pointer or NULL when descriptor does not exist.
                  *
                  *******************************************************************************/
                  const T_USB_LUT CYCODE *USB_GetBOSPtr(void)
                                                                          
                  {
                      /* Device Table */
                      const T_USB_LUT CYCODE *pTmp;
              
                      pTmp = (const T_USB_LUT CYCODE *) USB_TABLE[USB_device].p_list;
              
                      /* The first entry points to the Device Descriptor,
                      *  the second entry points to the BOS Descriptor
                      */
                      pTmp = &pTmp[1u];
                      pTmp = (const T_USB_LUT CYCODE *) pTmp->p_list;
                      return (pTmp);
                  }
              #endif /* (USB_BOS_ENABLE) */
 999          
1000          
1001          /*******************************************************************************
1002          * Function Name: USB_GetDeviceTablePtr
1003          ****************************************************************************//**
1004          *
1005          *  This routine returns a pointer to the Device table
1006          *
1007          * \return
1008          *  Device Table pointer
1009          *
1010          *******************************************************************************/
1011          const T_USB_LUT CYCODE *USB_GetDeviceTablePtr(void)
1012                                                                      
1013          {
1014   1          /* Device Table */
1015   1          return( (const T_USB_LUT CYCODE *) USB_TABLE[USB_device].p_list );
1016   1      }
1017          
1018          
1019          /*******************************************************************************
1020          * Function Name: USB_GetInterfaceClassTablePtr
1021          ****************************************************************************//**
1022          *
1023          *  This routine returns Interface Class table pointer, which contains
1024          *  the relation between interface number and interface class.
1025          *
1026          * \return
1027          *  Interface Class table pointer.
1028          *
1029          *******************************************************************************/
1030          const uint8 CYCODE *USB_GetInterfaceClassTablePtr(void)
1031                                                                  CYREENTRANT
1032          {
1033   1          const T_USB_LUT CYCODE *pTmp;
1034   1          const uint8 CYCODE *pInterfaceClass;
1035   1          uint8 currentInterfacesNum;
1036   1      
1037   1          pTmp = USB_GetConfigTablePtr(USB_configuration - 1u);
1038   1          if (pTmp != NULL)
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 18  

1039   1          {
1040   2              currentInterfacesNum  = ((const uint8 *) pTmp->p_list)[USB_CONFIG_DESCR_NUM_INTERFACES];
1041   2              /* Third entry in the LUT starts the Interface Table pointers */
1042   2              /* The INTERFACE_CLASS table is located after all interfaces */
1043   2              pTmp = &pTmp[currentInterfacesNum + 2u];
1044   2              pInterfaceClass = (const uint8 CYCODE *) pTmp->p_list;
1045   2          }
1046   1          else
1047   1          {
1048   2              pInterfaceClass = (const uint8 CYCODE *) NULL;
1049   2          }
1050   1      
1051   1          return (pInterfaceClass);
1052   1      }
1053          
1054          
1055          /*******************************************************************************
1056          * Function Name: USB_TerminateEP
1057          ****************************************************************************//**
1058          *
1059          *  This function terminates the specified USBFS endpoint.
1060          *  This function should be used before endpoint reconfiguration.
1061          *
1062          *  \param ep Contains the data endpoint number.
1063          *
1064          *  \reentrant
1065          *  No.
1066          *
1067          * \sideeffect
1068          * 
1069          * The device responds with a NAK for any transactions on the selected endpoint.
1070          *   
1071          *******************************************************************************/
1072          void USB_TerminateEP(uint8 epNumber) 
1073          {
1074   1          /* Get endpoint number */
1075   1          epNumber &= USB_DIR_UNUSED;
1076   1      
1077   1          if ((epNumber > USB_EP0) && (epNumber < USB_MAX_EP))
1078   1          {
1079   2              /* Set the endpoint Halt */
1080   2              USB_EP[epNumber].hwEpState |= USB_ENDPOINT_STATUS_HALT;
1081   2      
1082   2              /* Clear the data toggle */
1083   2              USB_EP[epNumber].epToggle = 0u;
1084   2              USB_EP[epNumber].apiEpState = USB_NO_EVENT_ALLOWED;
1085   2      
1086   2              if ((USB_EP[epNumber].addr & USB_DIR_IN) != 0u)
1087   2              {   
1088   3                  /* IN Endpoint */
1089   3                  USB_SIE_EP_BASE.sieEp[epNumber].epCr0 = USB_MODE_NAK_IN;
1090   3              }
1091   2              else
1092   2              {
1093   3                  /* OUT Endpoint */
1094   3                  USB_SIE_EP_BASE.sieEp[epNumber].epCr0 = USB_MODE_NAK_OUT;
1095   3              }
1096   2          }
1097   1      }
1098          
1099          
1100          /*******************************************************************************
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 19  

1101          * Function Name: USB_SetEndpointHalt
1102          ****************************************************************************//**
1103          *
1104          *  This routine handles set endpoint halt.
1105          *
1106          * \return
1107          *  requestHandled.
1108          *
1109          * \reentrant
1110          *  No.
1111          *
1112          *******************************************************************************/
1113          uint8 USB_SetEndpointHalt(void) 
1114          {
1115   1          uint8 requestHandled = USB_FALSE;
1116   1          uint8 ep;
1117   1          
1118   1          /* Set endpoint halt */
1119   1          ep = USB_wIndexLoReg & USB_DIR_UNUSED;
1120   1      
1121   1          if ((ep > USB_EP0) && (ep < USB_MAX_EP))
1122   1          {
1123   2              /* Set the endpoint Halt */
1124   2              USB_EP[ep].hwEpState |= (USB_ENDPOINT_STATUS_HALT);
1125   2      
1126   2              /* Clear the data toggle */
1127   2              USB_EP[ep].epToggle = 0u;
1128   2              USB_EP[ep].apiEpState |= USB_NO_EVENT_ALLOWED;
1129   2      
1130   2              if ((USB_EP[ep].addr & USB_DIR_IN) != 0u)
1131   2              {
1132   3                  /* IN Endpoint */
1133   3                  USB_SIE_EP_BASE.sieEp[ep].epCr0 = (USB_MODE_STALL_DATA_EP | 
1134   3                                                                  USB_MODE_ACK_IN);
1135   3              }
1136   2              else
1137   2              {
1138   3                  /* OUT Endpoint */
1139   3                  USB_SIE_EP_BASE.sieEp[ep].epCr0 = (USB_MODE_STALL_DATA_EP | 
1140   3                                                                  USB_MODE_ACK_OUT);
1141   3              }
1142   2              requestHandled = USB_InitNoDataControlTransfer();
1143   2          }
1144   1      
1145   1          return (requestHandled);
1146   1      }
1147          
1148          
1149          /*******************************************************************************
1150          * Function Name: USB_ClearEndpointHalt
1151          ****************************************************************************//**
1152          *
1153          *  This routine handles clear endpoint halt.
1154          *
1155          * \return
1156          *  requestHandled.
1157          *
1158          * \reentrant
1159          *  No.
1160          *
1161          *******************************************************************************/
1162          uint8 USB_ClearEndpointHalt(void) 
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 20  

1163          {
1164   1          uint8 requestHandled = USB_FALSE;
1165   1          uint8 ep;
1166   1      
1167   1          /* Clear endpoint halt */
1168   1          ep = USB_wIndexLoReg & USB_DIR_UNUSED;
1169   1      
1170   1          if ((ep > USB_EP0) && (ep < USB_MAX_EP))
1171   1          {
1172   2              /* Clear the endpoint Halt */
1173   2              USB_EP[ep].hwEpState &= (uint8) ~USB_ENDPOINT_STATUS_HALT;
1174   2      
1175   2              /* Clear the data toggle */
1176   2              USB_EP[ep].epToggle = 0u;
1177   2              
1178   2              /* Clear toggle bit for already armed packet */
1179   2              USB_SIE_EP_BASE.sieEp[ep].epCnt0 = (uint8) ~(uint8)USB_EPX_CNT_DATA_TOGGLE;
1180   2              
1181   2              /* Return API State as it was defined before */
1182   2              USB_EP[ep].apiEpState &= (uint8) ~USB_NO_EVENT_ALLOWED;
1183   2      
1184   2              if ((USB_EP[ep].addr & USB_DIR_IN) != 0u)
1185   2              {
1186   3                  /* IN Endpoint */
1187   3                  if(USB_EP[ep].apiEpState == USB_IN_BUFFER_EMPTY)
1188   3                  {       
1189   4                      /* Wait for next packet from application */
1190   4                      USB_SIE_EP_BASE.sieEp[ep].epCr0 = USB_MODE_NAK_IN;
1191   4                  }
1192   3                  else    /* Continue armed transfer */
1193   3                  {
1194   4                      USB_SIE_EP_BASE.sieEp[ep].epCr0 = USB_MODE_ACK_IN;
1195   4                  }
1196   3              }
1197   2              else
1198   2              {
1199   3                  /* OUT Endpoint */
1200   3                  if (USB_EP[ep].apiEpState == USB_OUT_BUFFER_FULL)
1201   3                  {       
1202   4                      /* Allow application to read full buffer */
1203   4                      USB_SIE_EP_BASE.sieEp[ep].epCr0 = USB_MODE_NAK_OUT;
1204   4                  }
1205   3                  else    /* Mark endpoint as empty, so it will be reloaded */
1206   3                  {
1207   4                      USB_SIE_EP_BASE.sieEp[ep].epCr0 = USB_MODE_ACK_OUT;
1208   4                  }
1209   3              }
1210   2              
1211   2              requestHandled = USB_InitNoDataControlTransfer();
1212   2          }
1213   1      
1214   1          return(requestHandled);
1215   1      }
1216          
1217          
1218          /*******************************************************************************
1219          * Function Name: USB_ValidateAlternateSetting
1220          ****************************************************************************//**
1221          *
1222          *  Validates (and records) a SET INTERFACE request.
1223          *
1224          * \return
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 21  

1225          *  requestHandled.
1226          *
1227          * \reentrant
1228          *  No.
1229          *
1230          *******************************************************************************/
1231          uint8 USB_ValidateAlternateSetting(void) 
1232          {
1233   1          uint8 requestHandled = USB_FALSE;
1234   1          
1235   1          uint8 interfaceNum;
1236   1          uint8 curInterfacesNum;
1237   1          const T_USB_LUT CYCODE *pTmp;
1238   1          
1239   1          /* Get interface number from the request. */
1240   1          interfaceNum = (uint8) USB_wIndexLoReg;
1241   1          
1242   1          /* Get number of interfaces for current configuration. */
1243   1          pTmp = USB_GetConfigTablePtr(USB_configuration - 1u);
1244   1          curInterfacesNum  = ((const uint8 *) pTmp->p_list)[USB_CONFIG_DESCR_NUM_INTERFACES];
1245   1      
1246   1          /* Validate that interface number is within range. */
1247   1          if ((interfaceNum <= curInterfacesNum) || (interfaceNum <= USB_MAX_INTERFACES_NUMBER))
1248   1          {
1249   2              /* Save current and new alternate settings (come with request) to make 
1250   2              * desicion about following endpoint re-configuration.
1251   2              */
1252   2              USB_interfaceSettingLast[interfaceNum] = USB_interfaceSetting[interfaceNum];
1253   2              USB_interfaceSetting[interfaceNum]     = (uint8) USB_wValueLoReg;
1254   2              
1255   2              requestHandled = USB_TRUE;
1256   2          }
1257   1      
1258   1          return (requestHandled);
1259   1      }
1260          
1261          
1262          /* [] END OF FILE */
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 22  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION USB_HandleStandardRqst (BEGIN)
                                           ; SOURCE LINE # 84
                                           ; SOURCE LINE # 85
                                           ; SOURCE LINE # 86
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 89
0005 906000            MOV     DPTR,#06000H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A 900000      R     MOV     DPTR,#bmRequestType
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 92
000F 7B00              MOV     R3,#00H
0011 7A00              MOV     R2,#00H
0013 7900              MOV     R1,#00H
0015 900000      R     MOV     DPTR,#pStr
0018 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 102
001B 900000      E     MOV     DPTR,#USB_currentTD
001E E4                CLR     A
001F F0                MOVX    @DPTR,A
0020 A3                INC     DPTR
0021 E4                CLR     A
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 104
0023 900000      R     MOV     DPTR,#bmRequestType
0026 E0                MOVX    A,@DPTR
0027 FF                MOV     R7,A
0028 EF                MOV     A,R7
0029 5480              ANL     A,#080H
002B FF                MOV     R7,A
002C 7E00              MOV     R6,#00H
002E EF                MOV     A,R7
002F 6480              XRL     A,#080H
0031 4E                ORL     A,R6
0032 6003              JZ      $ + 5H
0034 020000      R     LJMP    ?C0001
                                           ; SOURCE LINE # 105
                                           ; SOURCE LINE # 107
0037 906001            MOV     DPTR,#06001H
003A E0                MOVX    A,@DPTR
003B FF                MOV     R7,A
003C EF                MOV     A,R7
003D 120000      E     LCALL   ?C?CCASE
0040 0000        R     DW      ?C0016
0042 00                DB      00H
0043 0000        R     DW      ?C0003
0045 06                DB      06H
0046 0000        R     DW      ?C0021
0048 08                DB      08H
0049 0000        R     DW      ?C0022
004B 0A                DB      0AH
004C 0000              DW      00H
004E 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 108
                                           ; SOURCE LINE # 109
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 23  

0050         ?C0003:
                                           ; SOURCE LINE # 110
0050 906003            MOV     DPTR,#06003H
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 EF                MOV     A,R7
0056 B40135            CJNE    A,#01H,?C0004
                                           ; SOURCE LINE # 111
                                           ; SOURCE LINE # 112
0059 120000      R     LCALL   USB_GetDeviceTablePtr
005C 900000      R     MOV     DPTR,#pTmp
005F EE                MOV     A,R6
0060 F0                MOVX    @DPTR,A
0061 A3                INC     DPTR
0062 EF                MOV     A,R7
0063 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 113
0064 900000      R     MOV     DPTR,#pTmp
0067 E0                MOVX    A,@DPTR
0068 FE                MOV     R6,A
0069 A3                INC     DPTR
006A E0                MOVX    A,@DPTR
006B FF                MOV     R7,A
006C 8F82              MOV     DPL,R7
006E 8E83              MOV     DPH,R6
0070 A3                INC     DPTR
0071 120000      E     LCALL   ?C?PLDCODE
0074 900000      E     MOV     DPTR,#USB_currentTD+02H
0077 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 114
007A 900000      E     MOV     DPTR,#USB_currentTD
007D E4                CLR     A
007E F0                MOVX    @DPTR,A
007F A3                INC     DPTR
0080 7412              MOV     A,#012H
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 116
0083 120000      E     LCALL   USB_InitControlRead
0086 900000      R     MOV     DPTR,#requestHandled
0089 EF                MOV     A,R7
008A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 117
008B 020000      R     LJMP    ?C0024
008E         ?C0004:
                                           ; SOURCE LINE # 118
008E 906003            MOV     DPTR,#06003H
0091 E0                MOVX    A,@DPTR
0092 FF                MOV     R7,A
0093 EF                MOV     A,R7
0094 6402              XRL     A,#02H
0096 707A              JNZ     ?C0006
                                           ; SOURCE LINE # 119
                                           ; SOURCE LINE # 120
0098 906002            MOV     DPTR,#06002H
009B E0                MOVX    A,@DPTR
009C FF                MOV     R7,A
009D 120000      R     LCALL   _?USB_GetConfigTablePtr
00A0 900000      R     MOV     DPTR,#pTmp
00A3 EE                MOV     A,R6
00A4 F0                MOVX    @DPTR,A
00A5 A3                INC     DPTR
00A6 EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 24  

00A7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 123
00A8 900000      R     MOV     DPTR,#pTmp
00AB E0                MOVX    A,@DPTR
00AC FE                MOV     R6,A
00AD A3                INC     DPTR
00AE E0                MOVX    A,@DPTR
00AF FF                MOV     R7,A
00B0 EF                MOV     A,R7
00B1 4E                ORL     A,R6
00B2 7003              JNZ     $ + 5H
00B4 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 124
                                           ; SOURCE LINE # 125
00B7 900000      R     MOV     DPTR,#pTmp
00BA E0                MOVX    A,@DPTR
00BB FE                MOV     R6,A
00BC A3                INC     DPTR
00BD E0                MOVX    A,@DPTR
00BE FF                MOV     R7,A
00BF 8F82              MOV     DPL,R7
00C1 8E83              MOV     DPH,R6
00C3 A3                INC     DPTR
00C4 120000      E     LCALL   ?C?PLDCODE
00C7 900000      E     MOV     DPTR,#USB_currentTD+02H
00CA 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 126
00CD 900000      E     MOV     DPTR,#USB_currentTD+02H
00D0 120000      E     LCALL   ?C?PLDXDATA
00D3 E9                MOV     A,R1
00D4 2403              ADD     A,#03H
00D6 F9                MOV     R1,A
00D7 EA                MOV     A,R2
00D8 3400              ADDC    A,#00H
00DA FA                MOV     R2,A
00DB 120000      E     LCALL   ?C?CLDPTR
00DE FF                MOV     R7,A
00DF 7E00              MOV     R6,#00H
00E1 EF                MOV     A,R7
00E2 7F00              MOV     R7,#00H
00E4 FE                MOV     R6,A
00E5 900000      E     MOV     DPTR,#USB_currentTD+02H
00E8 120000      E     LCALL   ?C?PLDXDATA
00EB E9                MOV     A,R1
00EC 2402              ADD     A,#02H
00EE F9                MOV     R1,A
00EF EA                MOV     A,R2
00F0 3400              ADDC    A,#00H
00F2 FA                MOV     R2,A
00F3 120000      E     LCALL   ?C?CLDPTR
00F6 FD                MOV     R5,A
00F7 7C00              MOV     R4,#00H
00F9 EE                MOV     A,R6
00FA 4C                ORL     A,R4
00FB FE                MOV     R6,A
00FC EF                MOV     A,R7
00FD 4D                ORL     A,R5
00FE FF                MOV     R7,A
00FF 900000      E     MOV     DPTR,#USB_currentTD
0102 EE                MOV     A,R6
0103 F0                MOVX    @DPTR,A
0104 A3                INC     DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 25  

0105 EF                MOV     A,R7
0106 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 128
0107 120000      E     LCALL   USB_InitControlRead
010A 900000      R     MOV     DPTR,#requestHandled
010D EF                MOV     A,R7
010E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 129
                                           ; SOURCE LINE # 130
010F 020000      R     LJMP    ?C0024
0112         ?C0006:
                                           ; SOURCE LINE # 149
0112 906003            MOV     DPTR,#06003H
0115 E0                MOVX    A,@DPTR
0116 FF                MOV     R7,A
0117 EF                MOV     A,R7
0118 6403              XRL     A,#03H
011A 6003              JZ      $ + 5H
011C 020000      R     LJMP    ?C0009
                                           ; SOURCE LINE # 150
                                           ; SOURCE LINE # 153
011F 900000      R     MOV     DPTR,#nStr
0122 E4                CLR     A
0123 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 154
0124 7BFF              MOV     R3,#0FFH
0126 7A00        E     MOV     R2,#HIGH USB_STRING_DESCRIPTORS
0128 7900        E     MOV     R1,#LOW USB_STRING_DESCRIPTORS
012A 900000      R     MOV     DPTR,#pStr
012D 120000      E     LCALL   ?C?PSTXDATA
0130         ?C0010:
                                           ; SOURCE LINE # 156
0130 900000      R     MOV     DPTR,#nStr
0133 E0                MOVX    A,@DPTR
0134 FF                MOV     R7,A
0135 906002            MOV     DPTR,#06002H
0138 E0                MOVX    A,@DPTR
0139 FE                MOV     R6,A
013A EE                MOV     A,R6
013B D3                SETB    C
013C 9F                SUBB    A,R7
013D 403D              JC      ?C0011
013F 900000      R     MOV     DPTR,#pStr
0142 120000      E     LCALL   ?C?PLDXDATA
0145 120000      E     LCALL   ?C?CLDPTR
0148 FF                MOV     R7,A
0149 EF                MOV     A,R7
014A 6030              JZ      ?C0011
                                           ; SOURCE LINE # 157
                                           ; SOURCE LINE # 159
014C 900000      R     MOV     DPTR,#pStr
014F 120000      E     LCALL   ?C?PLDXDATA
0152 120000      E     LCALL   ?C?CLDPTR
0155 FF                MOV     R7,A
0156 900000      R     MOV     DPTR,#descrLength
0159 EF                MOV     A,R7
015A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 161
015B 900000      R     MOV     DPTR,#pStr
015E 120000      E     LCALL   ?C?PLDXDATA
0161 900000      R     MOV     DPTR,#descrLength
0164 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 26  

0165 FF                MOV     R7,A
0166 7E00              MOV     R6,#00H
0168 E9                MOV     A,R1
0169 2F                ADD     A,R7
016A F9                MOV     R1,A
016B EA                MOV     A,R2
016C 3E                ADDC    A,R6
016D FA                MOV     R2,A
016E 900000      R     MOV     DPTR,#pStr
0171 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 162
0174 900000      R     MOV     DPTR,#nStr
0177 E0                MOVX    A,@DPTR
0178 04                INC     A
0179 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 163
017A 80B4              SJMP    ?C0010
017C         ?C0011:
                                           ; SOURCE LINE # 168
017C 906002            MOV     DPTR,#06002H
017F E0                MOVX    A,@DPTR
0180 FF                MOV     R7,A
0181 EF                MOV     A,R7
0182 B4EE0C            CJNE    A,#0EEH,?C0012
                                           ; SOURCE LINE # 169
                                           ; SOURCE LINE # 170
0185 7BFF              MOV     R3,#0FFH
0187 7A00        E     MOV     R2,#HIGH USB_MSOS_DESCRIPTOR
0189 7900        E     MOV     R1,#LOW USB_MSOS_DESCRIPTOR
018B 900000      R     MOV     DPTR,#pStr
018E 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 171
0191         ?C0012:
                                           ; SOURCE LINE # 177
0191 906002            MOV     DPTR,#06002H
0194 E0                MOVX    A,@DPTR
0195 FF                MOV     R7,A
0196 EF                MOV     A,R7
0197 6024              JZ      ?C0013
0199 900000      E     MOV     DPTR,#USB_DEVICE0_DESCR+010H
019C E4                CLR     A
019D 93                MOVC    A,@A+DPTR
019E FF                MOV     R7,A
019F 906002            MOV     DPTR,#06002H
01A2 E0                MOVX    A,@DPTR
01A3 FE                MOV     R6,A
01A4 EE                MOV     A,R6
01A5 B50715            CJNE    A,AR7,?C0013
                                           ; SOURCE LINE # 178
                                           ; SOURCE LINE # 181
01A8 7B01              MOV     R3,#01H
01AA 7A00        E     MOV     R2,#HIGH USB_idSerialNumberStringDescriptor
01AC 7900        E     MOV     R1,#LOW USB_idSerialNumberStringDescriptor
01AE 120000      R     LCALL   _USB_ReadDieID
                                           ; SOURCE LINE # 182
01B1 7B01              MOV     R3,#01H
01B3 7A00        E     MOV     R2,#HIGH USB_idSerialNumberStringDescriptor
01B5 7900        E     MOV     R1,#LOW USB_idSerialNumberStringDescriptor
01B7 900000      R     MOV     DPTR,#pStr
01BA 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 196
01BD         ?C0013:
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 27  

                                           ; SOURCE LINE # 199
01BD 900000      R     MOV     DPTR,#pStr
01C0 120000      E     LCALL   ?C?PLDXDATA
01C3 120000      E     LCALL   ?C?CLDPTR
01C6 FF                MOV     R7,A
01C7 EF                MOV     A,R7
01C8 7003              JNZ     $ + 5H
01CA 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 200
                                           ; SOURCE LINE # 201
01CD 900000      R     MOV     DPTR,#pStr
01D0 120000      E     LCALL   ?C?PLDXDATA
01D3 120000      E     LCALL   ?C?CLDPTR
01D6 FF                MOV     R7,A
01D7 7E00              MOV     R6,#00H
01D9 900000      E     MOV     DPTR,#USB_currentTD
01DC EE                MOV     A,R6
01DD F0                MOVX    @DPTR,A
01DE A3                INC     DPTR
01DF EF                MOV     A,R7
01E0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 202
01E1 900000      R     MOV     DPTR,#pStr
01E4 120000      E     LCALL   ?C?PLDXDATA
01E7 900000      E     MOV     DPTR,#USB_currentTD+02H
01EA 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 203
01ED 120000      E     LCALL   USB_InitControlRead
01F0 900000      R     MOV     DPTR,#requestHandled
01F3 EF                MOV     A,R7
01F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
01F5 020000      R     LJMP    ?C0024
01F8         ?C0009:
                                           ; SOURCE LINE # 208
                                           ; SOURCE LINE # 209
01F8 120000      E     LCALL   USB_DispatchClassRqst
01FB 900000      R     MOV     DPTR,#requestHandled
01FE EF                MOV     A,R7
01FF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 210
                                           ; SOURCE LINE # 211
0200 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 213
0203         ?C0016:
                                           ; SOURCE LINE # 214
0203 900000      R     MOV     DPTR,#bmRequestType
0206 E0                MOVX    A,@DPTR
0207 FF                MOV     R7,A
0208 EF                MOV     A,R7
0209 5403              ANL     A,#03H
020B FF                MOV     R7,A
020C EF                MOV     A,R7
020D 120000      E     LCALL   ?C?CCASE
0210 0000        R     DW      ?C0019
0212 00                DB      00H
0213 0000        R     DW      ?C0018
0215 02                DB      02H
0216 0000              DW      00H
0218 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 215
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 28  

                                           ; SOURCE LINE # 216
021A         ?C0018:
                                           ; SOURCE LINE # 217
021A 900000      E     MOV     DPTR,#USB_currentTD
021D E4                CLR     A
021E F0                MOVX    @DPTR,A
021F A3                INC     DPTR
0220 7402              MOV     A,#02H
0222 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 218
0223 906004            MOV     DPTR,#06004H
0226 E0                MOVX    A,@DPTR
0227 FF                MOV     R7,A
0228 EF                MOV     A,R7
0229 547F              ANL     A,#07FH
022B FF                MOV     R7,A
022C EF                MOV     A,R7
022D 75F00B            MOV     B,#0BH
0230 A4                MUL     AB
0231 2400        E     ADD     A,#LOW USB_EP+02H
0233 F582              MOV     DPL,A
0235 E4                CLR     A
0236 3400        E     ADDC    A,#HIGH USB_EP+02H
0238 F583              MOV     DPH,A
023A E0                MOVX    A,@DPTR
023B FF                MOV     R7,A
023C 900000      R     MOV     DPTR,#USB_tBuffer
023F EF                MOV     A,R7
0240 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 219
0241 900000      R     MOV     DPTR,#USB_tBuffer+01H
0244 E4                CLR     A
0245 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 220
0246 7B01              MOV     R3,#01H
0248 7A00        R     MOV     R2,#HIGH USB_tBuffer
024A 7900        R     MOV     R1,#LOW USB_tBuffer
024C 900000      E     MOV     DPTR,#USB_currentTD+02H
024F 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 222
0252 120000      E     LCALL   USB_InitControlRead
0255 900000      R     MOV     DPTR,#requestHandled
0258 EF                MOV     A,R7
0259 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 223
025A 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 224
025D         ?C0019:
                                           ; SOURCE LINE # 225
025D 900000      E     MOV     DPTR,#USB_currentTD
0260 E4                CLR     A
0261 F0                MOVX    @DPTR,A
0262 A3                INC     DPTR
0263 7402              MOV     A,#02H
0265 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 226
0266 900000      E     MOV     DPTR,#USB_deviceStatus
0269 E0                MOVX    A,@DPTR
026A FF                MOV     R7,A
026B 900000      R     MOV     DPTR,#USB_tBuffer
026E EF                MOV     A,R7
026F F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 29  

                                           ; SOURCE LINE # 227
0270 900000      R     MOV     DPTR,#USB_tBuffer+01H
0273 E4                CLR     A
0274 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 228
0275 7B01              MOV     R3,#01H
0277 7A00        R     MOV     R2,#HIGH USB_tBuffer
0279 7900        R     MOV     R1,#LOW USB_tBuffer
027B 900000      E     MOV     DPTR,#USB_currentTD+02H
027E 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 230
0281 120000      E     LCALL   USB_InitControlRead
0284 900000      R     MOV     DPTR,#requestHandled
0287 EF                MOV     A,R7
0288 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 231
0289 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 232
                                           ; SOURCE LINE # 233
                                           ; SOURCE LINE # 234
                                           ; SOURCE LINE # 235
028C 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 237
028F         ?C0021:
                                           ; SOURCE LINE # 238
028F 900000      E     MOV     DPTR,#USB_currentTD
0292 E4                CLR     A
0293 F0                MOVX    @DPTR,A
0294 A3                INC     DPTR
0295 7401              MOV     A,#01H
0297 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 239
0298 7B01              MOV     R3,#01H
029A 7A00        E     MOV     R2,#HIGH USB_configuration
029C 7900        E     MOV     R1,#LOW USB_configuration
029E 900000      E     MOV     DPTR,#USB_currentTD+02H
02A1 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 240
02A4 120000      E     LCALL   USB_InitControlRead
02A7 900000      R     MOV     DPTR,#requestHandled
02AA EF                MOV     A,R7
02AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 241
02AC 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 243
02AF         ?C0022:
                                           ; SOURCE LINE # 244
02AF 900000      E     MOV     DPTR,#USB_currentTD
02B2 E4                CLR     A
02B3 F0                MOVX    @DPTR,A
02B4 A3                INC     DPTR
02B5 7401              MOV     A,#01H
02B7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 245
02B8 906004            MOV     DPTR,#06004H
02BB E0                MOVX    A,@DPTR
02BC FF                MOV     R7,A
02BD 7400        E     MOV     A,#LOW USB_interfaceSetting
02BF 2F                ADD     A,R7
02C0 F9                MOV     R1,A
02C1 E4                CLR     A
02C2 3400        E     ADDC    A,#HIGH USB_interfaceSetting
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 30  

02C4 FA                MOV     R2,A
02C5 7B01              MOV     R3,#01H
02C7 900000      E     MOV     DPTR,#USB_currentTD+02H
02CA 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 246
02CD 120000      E     LCALL   USB_InitControlRead
02D0 900000      R     MOV     DPTR,#requestHandled
02D3 EF                MOV     A,R7
02D4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 247
02D5 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 249
                                           ; SOURCE LINE # 250
                                           ; SOURCE LINE # 251
                                           ; SOURCE LINE # 252
02D8 020000      R     LJMP    ?C0024
02DB         ?C0001:
                                           ; SOURCE LINE # 254
                                           ; SOURCE LINE # 256
02DB 906001            MOV     DPTR,#06001H
02DE E0                MOVX    A,@DPTR
02DF FF                MOV     R7,A
02E0 EF                MOV     A,R7
02E1 120000      E     LCALL   ?C?CCASE
02E4 0000        R     DW      ?C0036
02E6 01                DB      01H
02E7 0000        R     DW      ?C0045
02E9 03                DB      03H
02EA 0000        R     DW      ?C0026
02EC 05                DB      05H
02ED 0000        R     DW      ?C0027
02EF 09                DB      09H
02F0 0000        R     DW      ?C0033
02F2 0B                DB      0BH
02F3 0000              DW      00H
02F5 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 257
                                           ; SOURCE LINE # 258
02F7         ?C0026:
                                           ; SOURCE LINE # 260
02F7 906002            MOV     DPTR,#06002H
02FA E0                MOVX    A,@DPTR
02FB FF                MOV     R7,A
02FC 900000      E     MOV     DPTR,#USB_deviceAddress
02FF EF                MOV     A,R7
0300 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 261
0301 120000      E     LCALL   USB_InitNoDataControlTransfer
0304 900000      R     MOV     DPTR,#requestHandled
0307 EF                MOV     A,R7
0308 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 262
0309 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 264
030C         ?C0027:
                                           ; SOURCE LINE # 265
030C 906002            MOV     DPTR,#06002H
030F E0                MOVX    A,@DPTR
0310 FF                MOV     R7,A
0311 900000      R     MOV     DPTR,#configurationN
0314 EF                MOV     A,R7
0315 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 31  

                                           ; SOURCE LINE # 268
0316 900000      R     MOV     DPTR,#configurationN
0319 E0                MOVX    A,@DPTR
031A FF                MOV     R7,A
031B EF                MOV     A,R7
031C D3                SETB    C
031D 9400              SUBB    A,#00H
031F 4013              JC      ?C0028
                                           ; SOURCE LINE # 269
                                           ; SOURCE LINE # 270
0321 900000      R     MOV     DPTR,#configurationN
0324 E0                MOVX    A,@DPTR
0325 FF                MOV     R7,A
0326 EF                MOV     A,R7
0327 14                DEC     A
0328 FF                MOV     R7,A
0329 120000      R     LCALL   _?USB_GetConfigTablePtr
032C 900000      R     MOV     DPTR,#pTmp
032F EE                MOV     A,R6
0330 F0                MOVX    @DPTR,A
0331 A3                INC     DPTR
0332 EF                MOV     A,R7
0333 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 271
0334         ?C0028:
                                           ; SOURCE LINE # 274
0334 900000      R     MOV     DPTR,#configurationN
0337 E0                MOVX    A,@DPTR
0338 FF                MOV     R7,A
0339 EF                MOV     A,R7
033A D3                SETB    C
033B 9400              SUBB    A,#00H
033D 400C              JC      ?C0031
033F 900000      R     MOV     DPTR,#pTmp
0342 E0                MOVX    A,@DPTR
0343 FE                MOV     R6,A
0344 A3                INC     DPTR
0345 E0                MOVX    A,@DPTR
0346 FF                MOV     R7,A
0347 EF                MOV     A,R7
0348 4E                ORL     A,R6
0349 700B              JNZ     ?C0030
034B         ?C0031:
034B 900000      R     MOV     DPTR,#configurationN
034E E0                MOVX    A,@DPTR
034F FF                MOV     R7,A
0350 EF                MOV     A,R7
0351 6003              JZ      $ + 5H
0353 020000      R     LJMP    ?C0024
0356         ?C0030:
                                           ; SOURCE LINE # 275
                                           ; SOURCE LINE # 277
0356 900000      E     MOV     DPTR,#USB_configuration
0359 E0                MOVX    A,@DPTR
035A FF                MOV     R7,A
035B 900000      R     MOV     DPTR,#configurationN
035E E0                MOVX    A,@DPTR
035F FE                MOV     R6,A
0360 EE                MOV     A,R6
0361 6F                XRL     A,R7
0362 6015              JZ      ?C0032
                                           ; SOURCE LINE # 278
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 32  

                                           ; SOURCE LINE # 279
0364 900000      R     MOV     DPTR,#configurationN
0367 E0                MOVX    A,@DPTR
0368 FF                MOV     R7,A
0369 900000      E     MOV     DPTR,#USB_configuration
036C EF                MOV     A,R7
036D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 280
036E 900000      E     MOV     DPTR,#USB_configurationChanged
0371 7401              MOV     A,#01H
0373 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 281
0374 7F01              MOV     R7,#01H
0376 120000      R     LCALL   _?USB_Config
                                           ; SOURCE LINE # 282
0379         ?C0032:
                                           ; SOURCE LINE # 283
0379 120000      E     LCALL   USB_InitNoDataControlTransfer
037C 900000      R     MOV     DPTR,#requestHandled
037F EF                MOV     A,R7
0380 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 284
                                           ; SOURCE LINE # 285
0381 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 287
0384         ?C0033:
                                           ; SOURCE LINE # 288
0384 120000      R     LCALL   USB_ValidateAlternateSetting
0387 EF                MOV     A,R7
0388 7003              JNZ     $ + 5H
038A 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 289
                                           ; SOURCE LINE # 291
038D 906004            MOV     DPTR,#06004H
0390 E0                MOVX    A,@DPTR
0391 FF                MOV     R7,A
0392 900000      R     MOV     DPTR,#interfaceNumber
0395 EF                MOV     A,R7
0396 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 292
0397 906004            MOV     DPTR,#06004H
039A E0                MOVX    A,@DPTR
039B FF                MOV     R7,A
039C 900000      E     MOV     DPTR,#USB_interfaceNumber
039F EF                MOV     A,R7
03A0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 295
03A1 900000      R     MOV     DPTR,#interfaceNumber
03A4 E0                MOVX    A,@DPTR
03A5 FF                MOV     R7,A
03A6 7400        E     MOV     A,#LOW USB_interfaceSetting
03A8 2F                ADD     A,R7
03A9 F582              MOV     DPL,A
03AB E4                CLR     A
03AC 3400        E     ADDC    A,#HIGH USB_interfaceSetting
03AE F583              MOV     DPH,A
03B0 E0                MOVX    A,@DPTR
03B1 FF                MOV     R7,A
03B2 900000      R     MOV     DPTR,#interfaceNumber
03B5 E0                MOVX    A,@DPTR
03B6 FE                MOV     R6,A
03B7 7400        E     MOV     A,#LOW USB_interfaceSettingLast
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 33  

03B9 2E                ADD     A,R6
03BA F582              MOV     DPL,A
03BC E4                CLR     A
03BD 3400        E     ADDC    A,#HIGH USB_interfaceSettingLast
03BF F583              MOV     DPH,A
03C1 E0                MOVX    A,@DPTR
03C2 FE                MOV     R6,A
03C3 EE                MOV     A,R6
03C4 6F                XRL     A,R7
03C5 6009              JZ      ?C0035
                                           ; SOURCE LINE # 296
                                           ; SOURCE LINE # 297
03C7 900000      E     MOV     DPTR,#USB_configurationChanged
03CA 7401              MOV     A,#01H
03CC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 303
03CD 120000      R     LCALL   USB_ConfigAltChanged
                                           ; SOURCE LINE # 305
03D0         ?C0035:
                                           ; SOURCE LINE # 307
03D0 120000      E     LCALL   USB_InitNoDataControlTransfer
03D3 900000      R     MOV     DPTR,#requestHandled
03D6 EF                MOV     A,R7
03D7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 308
                                           ; SOURCE LINE # 309
03D8 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 311
03DB         ?C0036:
                                           ; SOURCE LINE # 312
03DB 900000      R     MOV     DPTR,#bmRequestType
03DE E0                MOVX    A,@DPTR
03DF FF                MOV     R7,A
03E0 EF                MOV     A,R7
03E1 5403              ANL     A,#03H
03E3 FF                MOV     R7,A
03E4 EF                MOV     A,R7
03E5 120000      E     LCALL   ?C?CCASE
03E8 0000        R     DW      ?C0040
03EA 00                DB      00H
03EB 0000        R     DW      ?C0042
03ED 01                DB      01H
03EE 0000        R     DW      ?C0038
03F0 02                DB      02H
03F1 0000              DW      00H
03F3 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 313
                                           ; SOURCE LINE # 314
03F5         ?C0038:
                                           ; SOURCE LINE # 315
03F5 906002            MOV     DPTR,#06002H
03F8 E0                MOVX    A,@DPTR
03F9 FF                MOV     R7,A
03FA EF                MOV     A,R7
03FB 6003              JZ      $ + 5H
03FD 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 316
                                           ; SOURCE LINE # 317
0400 120000      R     LCALL   USB_ClearEndpointHalt
0403 900000      R     MOV     DPTR,#requestHandled
0406 EF                MOV     A,R7
0407 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 34  

                                           ; SOURCE LINE # 318
                                           ; SOURCE LINE # 319
0408 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 320
040B         ?C0040:
                                           ; SOURCE LINE # 322
040B 906002            MOV     DPTR,#06002H
040E E0                MOVX    A,@DPTR
040F FF                MOV     R7,A
0410 EF                MOV     A,R7
0411 6401              XRL     A,#01H
0413 6003              JZ      $ + 5H
0415 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 323
                                           ; SOURCE LINE # 324
0418 900000      E     MOV     DPTR,#USB_deviceStatus
041B E0                MOVX    A,@DPTR
041C FF                MOV     R7,A
041D EF                MOV     A,R7
041E 54FD              ANL     A,#0FDH
0420 FF                MOV     R7,A
0421 900000      E     MOV     DPTR,#USB_deviceStatus
0424 EF                MOV     A,R7
0425 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 325
0426 120000      E     LCALL   USB_InitNoDataControlTransfer
0429 900000      R     MOV     DPTR,#requestHandled
042C EF                MOV     A,R7
042D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 326
                                           ; SOURCE LINE # 327
042E 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 328
0431         ?C0042:
                                           ; SOURCE LINE # 330
0431 906004            MOV     DPTR,#06004H
0434 E0                MOVX    A,@DPTR
0435 FF                MOV     R7,A
0436 EF                MOV     A,R7
0437 C3                CLR     C
0438 9402              SUBB    A,#02H
043A 4003              JC      $ + 5H
043C 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 331
                                           ; SOURCE LINE # 332
043F 906004            MOV     DPTR,#06004H
0442 E0                MOVX    A,@DPTR
0443 FF                MOV     R7,A
0444 7400        E     MOV     A,#LOW USB_interfaceStatus
0446 2F                ADD     A,R7
0447 F582              MOV     DPL,A
0449 E4                CLR     A
044A 3400        E     ADDC    A,#HIGH USB_interfaceStatus
044C F583              MOV     DPH,A
044E C083              PUSH    DPH
0450 C082              PUSH    DPL
0452 E0                MOVX    A,@DPTR
0453 FF                MOV     R7,A
0454 906002            MOV     DPTR,#06002H
0457 E0                MOVX    A,@DPTR
0458 FE                MOV     R6,A
0459 EE                MOV     A,R6
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 35  

045A F4                CPL     A
045B FE                MOV     R6,A
045C EF                MOV     A,R7
045D 5E                ANL     A,R6
045E FF                MOV     R7,A
045F D082              POP     DPL
0461 D083              POP     DPH
0463 EF                MOV     A,R7
0464 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 333
0465 120000      E     LCALL   USB_InitNoDataControlTransfer
0468 900000      R     MOV     DPTR,#requestHandled
046B EF                MOV     A,R7
046C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 334
                                           ; SOURCE LINE # 335
046D 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 336
                                           ; SOURCE LINE # 337
                                           ; SOURCE LINE # 338
                                           ; SOURCE LINE # 339
0470 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 341
0473         ?C0045:
                                           ; SOURCE LINE # 342
0473 900000      R     MOV     DPTR,#bmRequestType
0476 E0                MOVX    A,@DPTR
0477 FF                MOV     R7,A
0478 EF                MOV     A,R7
0479 5403              ANL     A,#03H
047B FF                MOV     R7,A
047C EF                MOV     A,R7
047D 120000      E     LCALL   ?C?CCASE
0480 0000        R     DW      ?C0049
0482 00                DB      00H
0483 0000        R     DW      ?C0051
0485 01                DB      01H
0486 0000        R     DW      ?C0047
0488 02                DB      02H
0489 0000              DW      00H
048B 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 343
                                           ; SOURCE LINE # 344
048D         ?C0047:
                                           ; SOURCE LINE # 345
048D 906002            MOV     DPTR,#06002H
0490 E0                MOVX    A,@DPTR
0491 FF                MOV     R7,A
0492 EF                MOV     A,R7
0493 7065              JNZ     ?C0024
                                           ; SOURCE LINE # 346
                                           ; SOURCE LINE # 347
0495 120000      R     LCALL   USB_SetEndpointHalt
0498 900000      R     MOV     DPTR,#requestHandled
049B EF                MOV     A,R7
049C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 348
                                           ; SOURCE LINE # 349
049D 805B              SJMP    ?C0024
                                           ; SOURCE LINE # 351
049F         ?C0049:
                                           ; SOURCE LINE # 353
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 36  

049F 906002            MOV     DPTR,#06002H
04A2 E0                MOVX    A,@DPTR
04A3 FF                MOV     R7,A
04A4 EF                MOV     A,R7
04A5 6401              XRL     A,#01H
04A7 7051              JNZ     ?C0024
                                           ; SOURCE LINE # 354
                                           ; SOURCE LINE # 355
04A9 900000      E     MOV     DPTR,#USB_deviceStatus
04AC E0                MOVX    A,@DPTR
04AD FF                MOV     R7,A
04AE EF                MOV     A,R7
04AF 4402              ORL     A,#02H
04B1 FF                MOV     R7,A
04B2 900000      E     MOV     DPTR,#USB_deviceStatus
04B5 EF                MOV     A,R7
04B6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 356
04B7 120000      E     LCALL   USB_InitNoDataControlTransfer
04BA 900000      R     MOV     DPTR,#requestHandled
04BD EF                MOV     A,R7
04BE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 357
                                           ; SOURCE LINE # 358
04BF 8039              SJMP    ?C0024
                                           ; SOURCE LINE # 360
04C1         ?C0051:
                                           ; SOURCE LINE # 362
04C1 906004            MOV     DPTR,#06004H
04C4 E0                MOVX    A,@DPTR
04C5 FF                MOV     R7,A
04C6 EF                MOV     A,R7
04C7 C3                CLR     C
04C8 9402              SUBB    A,#02H
04CA 502E              JNC     ?C0024
                                           ; SOURCE LINE # 363
                                           ; SOURCE LINE # 364
04CC 906004            MOV     DPTR,#06004H
04CF E0                MOVX    A,@DPTR
04D0 FF                MOV     R7,A
04D1 7400        E     MOV     A,#LOW USB_interfaceStatus
04D3 2F                ADD     A,R7
04D4 F582              MOV     DPL,A
04D6 E4                CLR     A
04D7 3400        E     ADDC    A,#HIGH USB_interfaceStatus
04D9 F583              MOV     DPH,A
04DB C083              PUSH    DPH
04DD C082              PUSH    DPL
04DF E0                MOVX    A,@DPTR
04E0 FF                MOV     R7,A
04E1 906002            MOV     DPTR,#06002H
04E4 E0                MOVX    A,@DPTR
04E5 FE                MOV     R6,A
04E6 EE                MOV     A,R6
04E7 F4                CPL     A
04E8 FE                MOV     R6,A
04E9 EF                MOV     A,R7
04EA 5E                ANL     A,R6
04EB FF                MOV     R7,A
04EC D082              POP     DPL
04EE D083              POP     DPH
04F0 EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 37  

04F1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 365
04F2 120000      E     LCALL   USB_InitNoDataControlTransfer
04F5 900000      R     MOV     DPTR,#requestHandled
04F8 EF                MOV     A,R7
04F9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 366
                                           ; SOURCE LINE # 367
                                           ; SOURCE LINE # 369
                                           ; SOURCE LINE # 370
                                           ; SOURCE LINE # 371
                                           ; SOURCE LINE # 372
                                           ; SOURCE LINE # 374
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 376
                                           ; SOURCE LINE # 377
04FA         ?C0024:
                                           ; SOURCE LINE # 379
04FA 900000      R     MOV     DPTR,#requestHandled
04FD E0                MOVX    A,@DPTR
04FE FF                MOV     R7,A
                                           ; SOURCE LINE # 380
04FF         ?C0055:
04FF 22                RET     
             ; FUNCTION USB_HandleStandardRqst (END)

             ; FUNCTION _USB_ReadDieID (BEGIN)
                                           ; SOURCE LINE # 398
0000 900000      R     MOV     DPTR,#descr
0003 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 399
                                           ; SOURCE LINE # 402
0006 900000      R     MOV     DPTR,#j
0009 E4                CLR     A
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 405
000B 7B00              MOV     R3,#00H
000D 7A00              MOV     R2,#00H
000F 7900              MOV     R1,#00H
0011 C003              PUSH    AR3
0013 C002              PUSH    AR2
0015 C001              PUSH    AR1
0017 900000      R     MOV     DPTR,#descr
001A 120000      E     LCALL   ?C?PLDXDATA
001D D082              POP     DPL
001F D083              POP     DPH
0021 D0E0              POP     ACC
0023 6B                XRL     A,R3
0024 7008              JNZ     ?C0149
0026 E9                MOV     A,R1
0027 6582              XRL     A,DPL
0029 7003              JNZ     ?C0149
002B EA                MOV     A,R2
002C 6583              XRL     A,DPH
002E         ?C0149:
002E 7003              JNZ     $ + 5H
0030 020000      R     LJMP    ?C0060
                                           ; SOURCE LINE # 406
                                           ; SOURCE LINE # 408
0033 900000      R     MOV     DPTR,#descr
0036 120000      E     LCALL   ?C?PLDXDATA
0039 7422              MOV     A,#022H
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 38  

003B 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 409
003E 900000      R     MOV     DPTR,#descr
0041 120000      E     LCALL   ?C?PLDXDATA
0044 E9                MOV     A,R1
0045 2401              ADD     A,#01H
0047 F9                MOV     R1,A
0048 EA                MOV     A,R2
0049 3400              ADDC    A,#00H
004B FA                MOV     R2,A
004C 7403              MOV     A,#03H
004E 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 412
0051 7B01              MOV     R3,#01H
0053 7A00        R     MOV     R2,#HIGH uniqueId
0055 7900        R     MOV     R1,#LOW uniqueId
0057 120000      E     LCALL   _CyGetUniqueId
                                           ; SOURCE LINE # 415
005A 900000      R     MOV     DPTR,#i
005D 7402              MOV     A,#02H
005F F0                MOVX    @DPTR,A
0060         ?C0057:
0060 900000      R     MOV     DPTR,#i
0063 E0                MOVX    A,@DPTR
0064 FF                MOV     R7,A
0065 EF                MOV     A,R7
0066 C3                CLR     C
0067 9422              SUBB    A,#022H
0069 4003              JC      $ + 5H
006B 020000      R     LJMP    ?C0060
                                           ; SOURCE LINE # 416
                                           ; SOURCE LINE # 417
006E 900000      R     MOV     DPTR,#j
0071 E0                MOVX    A,@DPTR
0072 FF                MOV     R7,A
0073 7400        R     MOV     A,#LOW uniqueId
0075 2F                ADD     A,R7
0076 F582              MOV     DPL,A
0078 E4                CLR     A
0079 3400        R     ADDC    A,#HIGH uniqueId
007B F583              MOV     DPH,A
007D E0                MOVX    A,@DPTR
007E FF                MOV     R7,A
007F EF                MOV     A,R7
0080 C4                SWAP    A
0081 540F              ANL     A,#0FH
0083 FF                MOV     R7,A
0084 EF                MOV     A,R7
0085 900000      R     MOV     DPTR,#hex
0088 93                MOVC    A,@A+DPTR
0089 FF                MOV     R7,A
008A 900000      R     MOV     DPTR,#descr
008D 120000      E     LCALL   ?C?PLDXDATA
0090 900000      R     MOV     DPTR,#i
0093 E0                MOVX    A,@DPTR
0094 FE                MOV     R6,A
0095 E9                MOV     A,R1
0096 2E                ADD     A,R6
0097 F9                MOV     R1,A
0098 E4                CLR     A
0099 3A                ADDC    A,R2
009A FA                MOV     R2,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 39  

009B EF                MOV     A,R7
009C 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 418
009F 900000      R     MOV     DPTR,#i
00A2 E0                MOVX    A,@DPTR
00A3 FF                MOV     R7,A
00A4 7E00              MOV     R6,#00H
00A6 EF                MOV     A,R7
00A7 2401              ADD     A,#01H
00A9 FF                MOV     R7,A
00AA EE                MOV     A,R6
00AB 3400              ADDC    A,#00H
00AD FE                MOV     R6,A
00AE 900000      R     MOV     DPTR,#descr
00B1 120000      E     LCALL   ?C?PLDXDATA
00B4 E9                MOV     A,R1
00B5 2F                ADD     A,R7
00B6 F9                MOV     R1,A
00B7 EA                MOV     A,R2
00B8 3E                ADDC    A,R6
00B9 FA                MOV     R2,A
00BA E4                CLR     A
00BB 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 419
00BE 900000      R     MOV     DPTR,#j
00C1 E0                MOVX    A,@DPTR
00C2 FF                MOV     R7,A
00C3 7400        R     MOV     A,#LOW uniqueId
00C5 2F                ADD     A,R7
00C6 F582              MOV     DPL,A
00C8 E4                CLR     A
00C9 3400        R     ADDC    A,#HIGH uniqueId
00CB F583              MOV     DPH,A
00CD E0                MOVX    A,@DPTR
00CE FF                MOV     R7,A
00CF EF                MOV     A,R7
00D0 540F              ANL     A,#0FH
00D2 FF                MOV     R7,A
00D3 EF                MOV     A,R7
00D4 900000      R     MOV     DPTR,#hex
00D7 93                MOVC    A,@A+DPTR
00D8 FF                MOV     R7,A
00D9 900000      R     MOV     DPTR,#i
00DC E0                MOVX    A,@DPTR
00DD FE                MOV     R6,A
00DE EE                MOV     A,R6
00DF FD                MOV     R5,A
00E0 7C00              MOV     R4,#00H
00E2 ED                MOV     A,R5
00E3 2402              ADD     A,#02H
00E5 FD                MOV     R5,A
00E6 EC                MOV     A,R4
00E7 3400              ADDC    A,#00H
00E9 FC                MOV     R4,A
00EA 900000      R     MOV     DPTR,#descr
00ED 120000      E     LCALL   ?C?PLDXDATA
00F0 E9                MOV     A,R1
00F1 2D                ADD     A,R5
00F2 F9                MOV     R1,A
00F3 EA                MOV     A,R2
00F4 3C                ADDC    A,R4
00F5 FA                MOV     R2,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 40  

00F6 EF                MOV     A,R7
00F7 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 420
00FA 900000      R     MOV     DPTR,#i
00FD E0                MOVX    A,@DPTR
00FE FF                MOV     R7,A
00FF 7E00              MOV     R6,#00H
0101 EF                MOV     A,R7
0102 2403              ADD     A,#03H
0104 FF                MOV     R7,A
0105 EE                MOV     A,R6
0106 3400              ADDC    A,#00H
0108 FE                MOV     R6,A
0109 900000      R     MOV     DPTR,#descr
010C 120000      E     LCALL   ?C?PLDXDATA
010F E9                MOV     A,R1
0110 2F                ADD     A,R7
0111 F9                MOV     R1,A
0112 EA                MOV     A,R2
0113 3E                ADDC    A,R6
0114 FA                MOV     R2,A
0115 E4                CLR     A
0116 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 421
0119 900000      R     MOV     DPTR,#j
011C E0                MOVX    A,@DPTR
011D 04                INC     A
011E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 422
011F 900000      R     MOV     DPTR,#i
0122 E0                MOVX    A,@DPTR
0123 2404              ADD     A,#04H
0125 F0                MOVX    @DPTR,A
0126 020000      R     LJMP    ?C0057
                                           ; SOURCE LINE # 423
                                           ; SOURCE LINE # 424
0129         ?C0060:
0129 22                RET     
             ; FUNCTION _USB_ReadDieID (END)

             ; FUNCTION _?USB_ConfigReg (BEGIN)
                                           ; SOURCE LINE # 437
0000 90FFFF            MOV     DPTR,#0FFFFH
0003 120000      E     LCALL   ?C?ADDXBP
                                           ; SOURCE LINE # 446
0006 850083      E     MOV     DPH,?C_XBP
0009 850082      E     MOV     DPL,?C_XBP+01H
000C 7401              MOV     A,#01H
000E F0                MOVX    @DPTR,A
000F         ?C0061:
000F 850083      E     MOV     DPH,?C_XBP
0012 850082      E     MOV     DPL,?C_XBP+01H
0015 E0                MOVX    A,@DPTR
0016 FF                MOV     R7,A
0017 EF                MOV     A,R7
0018 C3                CLR     C
0019 9409              SUBB    A,#09H
001B 4003              JC      $ + 5H
001D 020000      R     LJMP    ?C0062
                                           ; SOURCE LINE # 447
                                           ; SOURCE LINE # 448
0020 850083      E     MOV     DPH,?C_XBP
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 41  

0023 850082      E     MOV     DPL,?C_XBP+01H
0026 E0                MOVX    A,@DPTR
0027 FF                MOV     R7,A
0028 75F010            MOV     B,#010H
002B EF                MOV     A,R7
002C 906070            MOV     DPTR,#06070H
002F 120000      E     LCALL   ?C?OFFXADD
0032 740C              MOV     A,#0CH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 455
0035 850083      E     MOV     DPH,?C_XBP
0038 850082      E     MOV     DPL,?C_XBP+01H
003B E0                MOVX    A,@DPTR
003C FF                MOV     R7,A
003D EF                MOV     A,R7
003E 75F00B            MOV     B,#0BH
0041 A4                MUL     AB
0042 2400        E     ADD     A,#LOW USB_EP+05H
0044 F582              MOV     DPL,A
0046 E4                CLR     A
0047 3400        E     ADDC    A,#HIGH USB_EP+05H
0049 F583              MOV     DPH,A
004B E0                MOVX    A,@DPTR
004C FF                MOV     R7,A
004D EF                MOV     A,R7
004E 6050              JZ      ?C0064
                                           ; SOURCE LINE # 456
                                           ; SOURCE LINE # 457
0050 850083      E     MOV     DPH,?C_XBP
0053 850082      E     MOV     DPL,?C_XBP+01H
0056 E0                MOVX    A,@DPTR
0057 FF                MOV     R7,A
0058 EF                MOV     A,R7
0059 75F00B            MOV     B,#0BH
005C A4                MUL     AB
005D 2400        E     ADD     A,#LOW USB_EP+04H
005F F582              MOV     DPL,A
0061 E4                CLR     A
0062 3400        E     ADDC    A,#HIGH USB_EP+04H
0064 F583              MOV     DPH,A
0066 E0                MOVX    A,@DPTR
0067 FF                MOV     R7,A
0068 EF                MOV     A,R7
0069 5480              ANL     A,#080H
006B FF                MOV     R7,A
006C 7E00              MOV     R6,#00H
006E EF                MOV     A,R7
006F 4E                ORL     A,R6
0070 6017              JZ      ?C0065
                                           ; SOURCE LINE # 458
                                           ; SOURCE LINE # 459
0072 850083      E     MOV     DPH,?C_XBP
0075 850082      E     MOV     DPL,?C_XBP+01H
0078 E0                MOVX    A,@DPTR
0079 FF                MOV     R7,A
007A 75F010            MOV     B,#010H
007D EF                MOV     A,R7
007E 905FFE            MOV     DPTR,#05FFEH
0081 120000      E     LCALL   ?C?OFFXADD
0084 740C              MOV     A,#0CH
0086 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 465
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 42  

0087 802C              SJMP    ?C0067
0089         ?C0065:
                                           ; SOURCE LINE # 467
                                           ; SOURCE LINE # 468
0089 850083      E     MOV     DPH,?C_XBP
008C 850082      E     MOV     DPL,?C_XBP+01H
008F E0                MOVX    A,@DPTR
0090 FF                MOV     R7,A
0091 75F010            MOV     B,#010H
0094 EF                MOV     A,R7
0095 905FFE            MOV     DPTR,#05FFEH
0098 120000      E     LCALL   ?C?OFFXADD
009B 7408              MOV     A,#08H
009D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 476
                                           ; SOURCE LINE # 477
009E 8015              SJMP    ?C0067
00A0         ?C0064:
                                           ; SOURCE LINE # 479
                                           ; SOURCE LINE # 480
00A0 850083      E     MOV     DPH,?C_XBP
00A3 850082      E     MOV     DPL,?C_XBP+01H
00A6 E0                MOVX    A,@DPTR
00A7 FF                MOV     R7,A
00A8 75F010            MOV     B,#010H
00AB EF                MOV     A,R7
00AC 905FFE            MOV     DPTR,#05FFEH
00AF 120000      E     LCALL   ?C?OFFXADD
00B2 7480              MOV     A,#080H
00B4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 481
00B5         ?C0067:
                                           ; SOURCE LINE # 488
00B5 850083      E     MOV     DPH,?C_XBP
00B8 850082      E     MOV     DPL,?C_XBP+01H
00BB E0                MOVX    A,@DPTR
00BC FF                MOV     R7,A
00BD EF                MOV     A,R7
00BE 75F00B            MOV     B,#0BH
00C1 A4                MUL     AB
00C2 2400        E     ADD     A,#LOW USB_EP+06H
00C4 F582              MOV     DPL,A
00C6 E4                CLR     A
00C7 3400        E     ADDC    A,#HIGH USB_EP+06H
00C9 F583              MOV     DPH,A
00CB E0                MOVX    A,@DPTR
00CC FE                MOV     R6,A
00CD A3                INC     DPTR
00CE E0                MOVX    A,@DPTR
00CF FF                MOV     R7,A
00D0 EF                MOV     A,R7
00D1 54FF              ANL     A,#0FFH
00D3 FF                MOV     R7,A
00D4 850083      E     MOV     DPH,?C_XBP
00D7 850082      E     MOV     DPL,?C_XBP+01H
00DA E0                MOVX    A,@DPTR
00DB FE                MOV     R6,A
00DC 75F010            MOV     B,#010H
00DF EE                MOV     A,R6
00E0 906076            MOV     DPTR,#06076H
00E3 120000      E     LCALL   ?C?OFFXADD
00E6 EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 43  

00E7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 489
00E8 850083      E     MOV     DPH,?C_XBP
00EB 850082      E     MOV     DPL,?C_XBP+01H
00EE E0                MOVX    A,@DPTR
00EF FF                MOV     R7,A
00F0 EF                MOV     A,R7
00F1 75F00B            MOV     B,#0BH
00F4 A4                MUL     AB
00F5 2400        E     ADD     A,#LOW USB_EP+06H
00F7 F582              MOV     DPL,A
00F9 E4                CLR     A
00FA 3400        E     ADDC    A,#HIGH USB_EP+06H
00FC F583              MOV     DPH,A
00FE E0                MOVX    A,@DPTR
00FF FE                MOV     R6,A
0100 A3                INC     DPTR
0101 E0                MOVX    A,@DPTR
0102 FF                MOV     R7,A
0103 EE                MOV     A,R6
0104 FF                MOV     R7,A
0105 7E00              MOV     R6,#00H
0107 850083      E     MOV     DPH,?C_XBP
010A 850082      E     MOV     DPL,?C_XBP+01H
010D E0                MOVX    A,@DPTR
010E FE                MOV     R6,A
010F 75F010            MOV     B,#010H
0112 EE                MOV     A,R6
0113 906077            MOV     DPTR,#06077H
0116 120000      E     LCALL   ?C?OFFXADD
0119 EF                MOV     A,R7
011A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 490
011B 850083      E     MOV     DPH,?C_XBP
011E 850082      E     MOV     DPL,?C_XBP+01H
0121 E0                MOVX    A,@DPTR
0122 FF                MOV     R7,A
0123 EF                MOV     A,R7
0124 75F00B            MOV     B,#0BH
0127 A4                MUL     AB
0128 2400        E     ADD     A,#LOW USB_EP+06H
012A F582              MOV     DPL,A
012C E4                CLR     A
012D 3400        E     ADDC    A,#HIGH USB_EP+06H
012F F583              MOV     DPH,A
0131 E0                MOVX    A,@DPTR
0132 FE                MOV     R6,A
0133 A3                INC     DPTR
0134 E0                MOVX    A,@DPTR
0135 FF                MOV     R7,A
0136 EF                MOV     A,R7
0137 54FF              ANL     A,#0FFH
0139 FF                MOV     R7,A
013A 850083      E     MOV     DPH,?C_XBP
013D 850082      E     MOV     DPL,?C_XBP+01H
0140 E0                MOVX    A,@DPTR
0141 FE                MOV     R6,A
0142 75F010            MOV     B,#010H
0145 EE                MOV     A,R6
0146 906074            MOV     DPTR,#06074H
0149 120000      E     LCALL   ?C?OFFXADD
014C EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 44  

014D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 491
014E 850083      E     MOV     DPH,?C_XBP
0151 850082      E     MOV     DPL,?C_XBP+01H
0154 E0                MOVX    A,@DPTR
0155 FF                MOV     R7,A
0156 EF                MOV     A,R7
0157 75F00B            MOV     B,#0BH
015A A4                MUL     AB
015B 2400        E     ADD     A,#LOW USB_EP+06H
015D F582              MOV     DPL,A
015F E4                CLR     A
0160 3400        E     ADDC    A,#HIGH USB_EP+06H
0162 F583              MOV     DPH,A
0164 E0                MOVX    A,@DPTR
0165 FE                MOV     R6,A
0166 A3                INC     DPTR
0167 E0                MOVX    A,@DPTR
0168 FF                MOV     R7,A
0169 EE                MOV     A,R6
016A FF                MOV     R7,A
016B 7E00              MOV     R6,#00H
016D 850083      E     MOV     DPH,?C_XBP
0170 850082      E     MOV     DPL,?C_XBP+01H
0173 E0                MOVX    A,@DPTR
0174 FE                MOV     R6,A
0175 75F010            MOV     B,#010H
0178 EE                MOV     A,R6
0179 906075            MOV     DPTR,#06075H
017C 120000      E     LCALL   ?C?OFFXADD
017F EF                MOV     A,R7
0180 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 494
0181 850083      E     MOV     DPH,?C_XBP
0184 850082      E     MOV     DPL,?C_XBP+01H
0187 E0                MOVX    A,@DPTR
0188 04                INC     A
0189 F0                MOVX    @DPTR,A
018A 020000      R     LJMP    ?C0061
018D         ?C0062:
                                           ; SOURCE LINE # 519
018D 90600A            MOV     DPTR,#0600AH
0190 74FF              MOV     A,#0FFH
0192 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 520
0193 900001            MOV     DPTR,#01H
0196 120000      E     LCALL   ?C?ADDXBP
0199 22                RET     
             ; FUNCTION _?USB_ConfigReg (END)

             ; FUNCTION USB_EpStateInit (BEGIN)
                                           ; SOURCE LINE # 532
                                           ; SOURCE LINE # 533
                                           ; SOURCE LINE # 536
0000 900000      R     MOV     DPTR,#i
0003 7401              MOV     A,#01H
0005 F0                MOVX    @DPTR,A
0006         ?C0069:
0006 900000      R     MOV     DPTR,#i
0009 E0                MOVX    A,@DPTR
000A FF                MOV     R7,A
000B EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 45  

000C C3                CLR     C
000D 9409              SUBB    A,#09H
000F 5054              JNC     ?C0074
                                           ; SOURCE LINE # 537
                                           ; SOURCE LINE # 538
0011 900000      R     MOV     DPTR,#i
0014 E0                MOVX    A,@DPTR
0015 FF                MOV     R7,A
0016 EF                MOV     A,R7
0017 75F00B            MOV     B,#0BH
001A A4                MUL     AB
001B 2400        E     ADD     A,#LOW USB_EP+04H
001D F582              MOV     DPL,A
001F E4                CLR     A
0020 3400        E     ADDC    A,#HIGH USB_EP+04H
0022 F583              MOV     DPH,A
0024 E0                MOVX    A,@DPTR
0025 FF                MOV     R7,A
0026 EF                MOV     A,R7
0027 5480              ANL     A,#080H
0029 FF                MOV     R7,A
002A 7E00              MOV     R6,#00H
002C EF                MOV     A,R7
002D 4E                ORL     A,R6
002E 6018              JZ      ?C0072
                                           ; SOURCE LINE # 539
                                           ; SOURCE LINE # 541
0030 900000      R     MOV     DPTR,#i
0033 E0                MOVX    A,@DPTR
0034 FF                MOV     R7,A
0035 EF                MOV     A,R7
0036 75F00B            MOV     B,#0BH
0039 A4                MUL     AB
003A 2400        E     ADD     A,#LOW USB_EP+01H
003C F582              MOV     DPL,A
003E E4                CLR     A
003F 3400        E     ADDC    A,#HIGH USB_EP+01H
0041 F583              MOV     DPH,A
0043 7401              MOV     A,#01H
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 542
0046 8015              SJMP    ?C0071
0048         ?C0072:
                                           ; SOURCE LINE # 544
                                           ; SOURCE LINE # 546
0048 900000      R     MOV     DPTR,#i
004B E0                MOVX    A,@DPTR
004C FF                MOV     R7,A
004D EF                MOV     A,R7
004E 75F00B            MOV     B,#0BH
0051 A4                MUL     AB
0052 2400        E     ADD     A,#LOW USB_EP+01H
0054 F582              MOV     DPL,A
0056 E4                CLR     A
0057 3400        E     ADDC    A,#HIGH USB_EP+01H
0059 F583              MOV     DPH,A
005B E4                CLR     A
005C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 547
                                           ; SOURCE LINE # 548
005D         ?C0071:
005D 900000      R     MOV     DPTR,#i
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 46  

0060 E0                MOVX    A,@DPTR
0061 04                INC     A
0062 F0                MOVX    @DPTR,A
0063 80A1              SJMP    ?C0069
                                           ; SOURCE LINE # 550
0065         ?C0074:
0065 22                RET     
             ; FUNCTION USB_EpStateInit (END)

             ; FUNCTION _?USB_Config (BEGIN)
                                           ; SOURCE LINE # 570
0000 90FFFF            MOV     DPTR,#0FFFFH
0003 120000      E     LCALL   ?C?ADDXBP
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
0008 90FFF3            MOV     DPTR,#0FFF3H
000B 120000      E     LCALL   ?C?ADDXBP
                                           ; SOURCE LINE # 579
000E 900007            MOV     DPTR,#07H
0011 120000      E     LCALL   ?C?XBPOFF
0014 E4                CLR     A
0015 F0                MOVX    @DPTR,A
0016 A3                INC     DPTR
0017 E4                CLR     A
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 586
0019 850083      E     MOV     DPH,?C_XBP
001C 850082      E     MOV     DPL,?C_XBP+01H
001F E4                CLR     A
0020 F0                MOVX    @DPTR,A
0021         ?C0075:
0021 850083      E     MOV     DPH,?C_XBP
0024 850082      E     MOV     DPL,?C_XBP+01H
0027 E0                MOVX    A,@DPTR
0028 FF                MOV     R7,A
0029 EF                MOV     A,R7
002A C3                CLR     C
002B 9409              SUBB    A,#09H
002D 4003              JC      $ + 5H
002F 020000      R     LJMP    ?C0076
                                           ; SOURCE LINE # 587
                                           ; SOURCE LINE # 588
0032 850083      E     MOV     DPH,?C_XBP
0035 850082      E     MOV     DPL,?C_XBP+01H
0038 E0                MOVX    A,@DPTR
0039 FF                MOV     R7,A
003A EF                MOV     A,R7
003B 75F00B            MOV     B,#0BH
003E A4                MUL     AB
003F 2400        E     ADD     A,#LOW USB_EP
0041 F582              MOV     DPL,A
0043 E4                CLR     A
0044 3400        E     ADDC    A,#HIGH USB_EP
0046 F583              MOV     DPH,A
0048 E4                CLR     A
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 589
004A 850083      E     MOV     DPH,?C_XBP
004D 850082      E     MOV     DPL,?C_XBP+01H
0050 E0                MOVX    A,@DPTR
0051 FF                MOV     R7,A
0052 EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 47  

0053 75F00B            MOV     B,#0BH
0056 A4                MUL     AB
0057 2400        E     ADD     A,#LOW USB_EP+02H
0059 F582              MOV     DPL,A
005B E4                CLR     A
005C 3400        E     ADDC    A,#HIGH USB_EP+02H
005E F583              MOV     DPH,A
0060 E4                CLR     A
0061 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 590
0062 850083      E     MOV     DPH,?C_XBP
0065 850082      E     MOV     DPL,?C_XBP+01H
0068 E0                MOVX    A,@DPTR
0069 FF                MOV     R7,A
006A EF                MOV     A,R7
006B 75F00B            MOV     B,#0BH
006E A4                MUL     AB
006F 2400        E     ADD     A,#LOW USB_EP+03H
0071 F582              MOV     DPL,A
0073 E4                CLR     A
0074 3400        E     ADDC    A,#HIGH USB_EP+03H
0076 F583              MOV     DPH,A
0078 E4                CLR     A
0079 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 591
007A 850083      E     MOV     DPH,?C_XBP
007D 850082      E     MOV     DPL,?C_XBP+01H
0080 E0                MOVX    A,@DPTR
0081 FF                MOV     R7,A
0082 EF                MOV     A,R7
0083 75F00B            MOV     B,#0BH
0086 A4                MUL     AB
0087 2400        E     ADD     A,#LOW USB_EP+08H
0089 F582              MOV     DPL,A
008B E4                CLR     A
008C 3400        E     ADDC    A,#HIGH USB_EP+08H
008E F583              MOV     DPH,A
0090 E4                CLR     A
0091 F0                MOVX    @DPTR,A
0092 A3                INC     DPTR
0093 E4                CLR     A
0094 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 592
0095 850083      E     MOV     DPH,?C_XBP
0098 850082      E     MOV     DPL,?C_XBP+01H
009B E0                MOVX    A,@DPTR
009C FF                MOV     R7,A
009D EF                MOV     A,R7
009E 75F00B            MOV     B,#0BH
00A1 A4                MUL     AB
00A2 2400        E     ADD     A,#LOW USB_EP+0AH
00A4 F582              MOV     DPL,A
00A6 E4                CLR     A
00A7 3400        E     ADDC    A,#HIGH USB_EP+0AH
00A9 F583              MOV     DPH,A
00AB E4                CLR     A
00AC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 593
00AD 850083      E     MOV     DPH,?C_XBP
00B0 850082      E     MOV     DPL,?C_XBP+01H
00B3 E0                MOVX    A,@DPTR
00B4 FF                MOV     R7,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 48  

00B5 EF                MOV     A,R7
00B6 75F00B            MOV     B,#0BH
00B9 A4                MUL     AB
00BA 2400        E     ADD     A,#LOW USB_EP+01H
00BC F582              MOV     DPL,A
00BE E4                CLR     A
00BF 3400        E     ADDC    A,#HIGH USB_EP+01H
00C1 F583              MOV     DPH,A
00C3 E4                CLR     A
00C4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 594
00C5 850083      E     MOV     DPH,?C_XBP
00C8 850082      E     MOV     DPL,?C_XBP+01H
00CB E0                MOVX    A,@DPTR
00CC FF                MOV     R7,A
00CD EF                MOV     A,R7
00CE 75F00B            MOV     B,#0BH
00D1 A4                MUL     AB
00D2 2400        E     ADD     A,#LOW USB_EP+05H
00D4 F582              MOV     DPL,A
00D6 E4                CLR     A
00D7 3400        E     ADDC    A,#HIGH USB_EP+05H
00D9 F583              MOV     DPH,A
00DB E4                CLR     A
00DC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 595
00DD 850083      E     MOV     DPH,?C_XBP
00E0 850082      E     MOV     DPL,?C_XBP+01H
00E3 E0                MOVX    A,@DPTR
00E4 04                INC     A
00E5 F0                MOVX    @DPTR,A
00E6 020000      R     LJMP    ?C0075
00E9         ?C0076:
                                           ; SOURCE LINE # 598
00E9 90000D            MOV     DPTR,#0DH
00EC 120000      E     LCALL   ?C?XBPOFF
00EF E0                MOVX    A,@DPTR
00F0 FF                MOV     R7,A
00F1 EF                MOV     A,R7
00F2 6053              JZ      ?C0078
                                           ; SOURCE LINE # 599
                                           ; SOURCE LINE # 600
00F4 850083      E     MOV     DPH,?C_XBP
00F7 850082      E     MOV     DPL,?C_XBP+01H
00FA A3                INC     DPTR
00FB A3                INC     DPTR
00FC E4                CLR     A
00FD F0                MOVX    @DPTR,A
00FE         ?C0079:
00FE 850083      E     MOV     DPH,?C_XBP
0101 850082      E     MOV     DPL,?C_XBP+01H
0104 A3                INC     DPTR
0105 A3                INC     DPTR
0106 E0                MOVX    A,@DPTR
0107 FF                MOV     R7,A
0108 EF                MOV     A,R7
0109 C3                CLR     C
010A 9402              SUBB    A,#02H
010C 5039              JNC     ?C0078
                                           ; SOURCE LINE # 601
                                           ; SOURCE LINE # 602
010E 850083      E     MOV     DPH,?C_XBP
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 49  

0111 850082      E     MOV     DPL,?C_XBP+01H
0114 A3                INC     DPTR
0115 A3                INC     DPTR
0116 E0                MOVX    A,@DPTR
0117 FF                MOV     R7,A
0118 7400        E     MOV     A,#LOW USB_interfaceSetting
011A 2F                ADD     A,R7
011B F582              MOV     DPL,A
011D E4                CLR     A
011E 3400        E     ADDC    A,#HIGH USB_interfaceSetting
0120 F583              MOV     DPH,A
0122 E4                CLR     A
0123 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 603
0124 850083      E     MOV     DPH,?C_XBP
0127 850082      E     MOV     DPL,?C_XBP+01H
012A A3                INC     DPTR
012B A3                INC     DPTR
012C E0                MOVX    A,@DPTR
012D FF                MOV     R7,A
012E 7400        E     MOV     A,#LOW USB_interfaceSettingLast
0130 2F                ADD     A,R7
0131 F582              MOV     DPL,A
0133 E4                CLR     A
0134 3400        E     ADDC    A,#HIGH USB_interfaceSettingLast
0136 F583              MOV     DPH,A
0138 E4                CLR     A
0139 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 604
013A 850083      E     MOV     DPH,?C_XBP
013D 850082      E     MOV     DPL,?C_XBP+01H
0140 A3                INC     DPTR
0141 A3                INC     DPTR
0142 E0                MOVX    A,@DPTR
0143 04                INC     A
0144 F0                MOVX    @DPTR,A
0145 80B7              SJMP    ?C0079
                                           ; SOURCE LINE # 605
0147         ?C0078:
                                           ; SOURCE LINE # 608
0147 900000      E     MOV     DPTR,#USB_configuration
014A E0                MOVX    A,@DPTR
014B FF                MOV     R7,A
014C EF                MOV     A,R7
014D D3                SETB    C
014E 9400              SUBB    A,#00H
0150 5003              JNC     $ + 5H
0152 020000      R     LJMP    ?C0110
                                           ; SOURCE LINE # 609
                                           ; SOURCE LINE # 614
0155 900000      E     MOV     DPTR,#USB_configuration
0158 E0                MOVX    A,@DPTR
0159 FF                MOV     R7,A
015A EF                MOV     A,R7
015B 14                DEC     A
015C FF                MOV     R7,A
015D 120000      R     LCALL   _?USB_GetConfigTablePtr
0160 900009            MOV     DPTR,#09H
0163 120000      E     LCALL   ?C?XBPOFF
0166 EE                MOV     A,R6
0167 F0                MOVX    @DPTR,A
0168 A3                INC     DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 50  

0169 EF                MOV     A,R7
016A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 617
016B 900009            MOV     DPTR,#09H
016E 120000      E     LCALL   ?C?XBPOFF
0171 E0                MOVX    A,@DPTR
0172 FE                MOV     R6,A
0173 A3                INC     DPTR
0174 E0                MOVX    A,@DPTR
0175 FF                MOV     R7,A
0176 8F82              MOV     DPL,R7
0178 8E83              MOV     DPH,R6
017A A3                INC     DPTR
017B 120000      E     LCALL   ?C?PLDCODE
017E 900004            MOV     DPTR,#04H
0181 120000      E     LCALL   ?C?XBPOFF
0184 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 618
0187 900004            MOV     DPTR,#04H
018A 120000      E     LCALL   ?C?XBPOFF
018D 120000      E     LCALL   ?C?PLDXDATA
0190 E9                MOV     A,R1
0191 2407              ADD     A,#07H
0193 F9                MOV     R1,A
0194 EA                MOV     A,R2
0195 3400              ADDC    A,#00H
0197 FA                MOV     R2,A
0198 120000      E     LCALL   ?C?CLDPTR
019B FF                MOV     R7,A
019C EF                MOV     A,R7
019D 5440              ANL     A,#040H
019F FF                MOV     R7,A
01A0 7E00              MOV     R6,#00H
01A2 EF                MOV     A,R7
01A3 4E                ORL     A,R6
01A4 6010              JZ      ?C0083
                                           ; SOURCE LINE # 619
                                           ; SOURCE LINE # 620
01A6 900000      E     MOV     DPTR,#USB_deviceStatus
01A9 E0                MOVX    A,@DPTR
01AA FF                MOV     R7,A
01AB EF                MOV     A,R7
01AC 4401              ORL     A,#01H
01AE FF                MOV     R7,A
01AF 900000      E     MOV     DPTR,#USB_deviceStatus
01B2 EF                MOV     A,R7
01B3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 621
01B4 800E              SJMP    ?C0084
01B6         ?C0083:
                                           ; SOURCE LINE # 623
                                           ; SOURCE LINE # 624
01B6 900000      E     MOV     DPTR,#USB_deviceStatus
01B9 E0                MOVX    A,@DPTR
01BA FF                MOV     R7,A
01BB EF                MOV     A,R7
01BC 54FE              ANL     A,#0FEH
01BE FF                MOV     R7,A
01BF 900000      E     MOV     DPTR,#USB_deviceStatus
01C2 EF                MOV     A,R7
01C3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 625
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 51  

01C4         ?C0084:
                                           ; SOURCE LINE # 628
01C4 900009            MOV     DPTR,#09H
01C7 120000      E     LCALL   ?C?XBPOFF
01CA E0                MOVX    A,@DPTR
01CB FE                MOV     R6,A
01CC A3                INC     DPTR
01CD E0                MOVX    A,@DPTR
01CE FF                MOV     R7,A
01CF EF                MOV     A,R7
01D0 2404              ADD     A,#04H
01D2 FF                MOV     R7,A
01D3 EE                MOV     A,R6
01D4 3400              ADDC    A,#00H
01D6 FE                MOV     R6,A
01D7 900009            MOV     DPTR,#09H
01DA 120000      E     LCALL   ?C?XBPOFF
01DD EE                MOV     A,R6
01DE F0                MOVX    @DPTR,A
01DF A3                INC     DPTR
01E0 EF                MOV     A,R7
01E1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 629
01E2 900009            MOV     DPTR,#09H
01E5 120000      E     LCALL   ?C?XBPOFF
01E8 E0                MOVX    A,@DPTR
01E9 FE                MOV     R6,A
01EA A3                INC     DPTR
01EB E0                MOVX    A,@DPTR
01EC FF                MOV     R7,A
01ED 8F82              MOV     DPL,R7
01EF 8E83              MOV     DPH,R6
01F1 E4                CLR     A
01F2 93                MOVC    A,@A+DPTR
01F3 FF                MOV     R7,A
01F4 850083      E     MOV     DPH,?C_XBP
01F7 850082      E     MOV     DPL,?C_XBP+01H
01FA EF                MOV     A,R7
01FB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 687
01FC 850083      E     MOV     DPH,?C_XBP
01FF 850082      E     MOV     DPL,?C_XBP+01H
0202 A3                INC     DPTR
0203 A3                INC     DPTR
0204 7401              MOV     A,#01H
0206 F0                MOVX    @DPTR,A
0207         ?C0085:
0207 850083      E     MOV     DPH,?C_XBP
020A 850082      E     MOV     DPL,?C_XBP+01H
020D A3                INC     DPTR
020E A3                INC     DPTR
020F E0                MOVX    A,@DPTR
0210 FF                MOV     R7,A
0211 EF                MOV     A,R7
0212 C3                CLR     C
0213 9409              SUBB    A,#09H
0215 4003              JC      $ + 5H
0217 020000      R     LJMP    ?C0086
                                           ; SOURCE LINE # 688
                                           ; SOURCE LINE # 690
021A 900009            MOV     DPTR,#09H
021D 120000      E     LCALL   ?C?XBPOFF
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 52  

0220 E0                MOVX    A,@DPTR
0221 FE                MOV     R6,A
0222 A3                INC     DPTR
0223 E0                MOVX    A,@DPTR
0224 FF                MOV     R7,A
0225 8F82              MOV     DPL,R7
0227 8E83              MOV     DPH,R6
0229 A3                INC     DPTR
022A 120000      E     LCALL   ?C?PLDCODE
022D AE02              MOV     R6,AR2
022F AF01              MOV     R7,AR1
0231 90000B            MOV     DPTR,#0BH
0234 120000      E     LCALL   ?C?XBPOFF
0237 EE                MOV     A,R6
0238 F0                MOVX    @DPTR,A
0239 A3                INC     DPTR
023A EF                MOV     A,R7
023B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 694
023C 850083      E     MOV     DPH,?C_XBP
023F 850082      E     MOV     DPL,?C_XBP+01H
0242 A3                INC     DPTR
0243 E4                CLR     A
0244 F0                MOVX    @DPTR,A
0245         ?C0088:
0245 850083      E     MOV     DPH,?C_XBP
0248 850082      E     MOV     DPL,?C_XBP+01H
024B E0                MOVX    A,@DPTR
024C FF                MOV     R7,A
024D 850083      E     MOV     DPH,?C_XBP
0250 850082      E     MOV     DPL,?C_XBP+01H
0253 A3                INC     DPTR
0254 E0                MOVX    A,@DPTR
0255 FE                MOV     R6,A
0256 EE                MOV     A,R6
0257 C3                CLR     C
0258 9F                SUBB    A,R7
0259 4003              JC      $ + 5H
025B 020000      R     LJMP    ?C0087
                                           ; SOURCE LINE # 695
                                           ; SOURCE LINE # 696
025E 90000B            MOV     DPTR,#0BH
0261 120000      E     LCALL   ?C?XBPOFF
0264 E0                MOVX    A,@DPTR
0265 FE                MOV     R6,A
0266 A3                INC     DPTR
0267 E0                MOVX    A,@DPTR
0268 FF                MOV     R7,A
0269 8F82              MOV     DPL,R7
026B 8E83              MOV     DPH,R6
026D 7402              MOV     A,#02H
026F 93                MOVC    A,@A+DPTR
0270 FF                MOV     R7,A
0271 EF                MOV     A,R7
0272 547F              ANL     A,#07FH
0274 FF                MOV     R7,A
0275 7E00              MOV     R6,#00H
0277 850083      E     MOV     DPH,?C_XBP
027A 850082      E     MOV     DPL,?C_XBP+01H
027D A3                INC     DPTR
027E A3                INC     DPTR
027F E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 53  

0280 FD                MOV     R5,A
0281 7C00              MOV     R4,#00H
0283 ED                MOV     A,R5
0284 6F                XRL     A,R7
0285 7002              JNZ     ?C0150
0287 EC                MOV     A,R4
0288 6E                XRL     A,R6
0289         ?C0150:
0289 6003              JZ      $ + 5H
028B 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 697
                                           ; SOURCE LINE # 699
028E 90000B            MOV     DPTR,#0BH
0291 120000      E     LCALL   ?C?XBPOFF
0294 E0                MOVX    A,@DPTR
0295 FE                MOV     R6,A
0296 A3                INC     DPTR
0297 E0                MOVX    A,@DPTR
0298 FF                MOV     R7,A
0299 8F82              MOV     DPL,R7
029B 8E83              MOV     DPH,R6
029D 7404              MOV     A,#04H
029F 93                MOVC    A,@A+DPTR
02A0 FE                MOV     R6,A
02A1 7405              MOV     A,#05H
02A3 93                MOVC    A,@A+DPTR
02A4 FF                MOV     R7,A
02A5 850083      E     MOV     DPH,?C_XBP
02A8 850082      E     MOV     DPL,?C_XBP+01H
02AB A3                INC     DPTR
02AC A3                INC     DPTR
02AD E0                MOVX    A,@DPTR
02AE FD                MOV     R5,A
02AF ED                MOV     A,R5
02B0 75F00B            MOV     B,#0BH
02B3 A4                MUL     AB
02B4 2400        E     ADD     A,#LOW USB_EP+08H
02B6 F582              MOV     DPL,A
02B8 E4                CLR     A
02B9 3400        E     ADDC    A,#HIGH USB_EP+08H
02BB F583              MOV     DPH,A
02BD E0                MOVX    A,@DPTR
02BE FC                MOV     R4,A
02BF A3                INC     DPTR
02C0 E0                MOVX    A,@DPTR
02C1 FD                MOV     R5,A
02C2 C3                CLR     C
02C3 ED                MOV     A,R5
02C4 9F                SUBB    A,R7
02C5 EC                MOV     A,R4
02C6 9E                SUBB    A,R6
02C7 5034              JNC     ?C0092
                                           ; SOURCE LINE # 700
                                           ; SOURCE LINE # 701
02C9 90000B            MOV     DPTR,#0BH
02CC 120000      E     LCALL   ?C?XBPOFF
02CF E0                MOVX    A,@DPTR
02D0 FE                MOV     R6,A
02D1 A3                INC     DPTR
02D2 E0                MOVX    A,@DPTR
02D3 FF                MOV     R7,A
02D4 8F82              MOV     DPL,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 54  

02D6 8E83              MOV     DPH,R6
02D8 7404              MOV     A,#04H
02DA 93                MOVC    A,@A+DPTR
02DB FE                MOV     R6,A
02DC 7405              MOV     A,#05H
02DE 93                MOVC    A,@A+DPTR
02DF FF                MOV     R7,A
02E0 850083      E     MOV     DPH,?C_XBP
02E3 850082      E     MOV     DPL,?C_XBP+01H
02E6 A3                INC     DPTR
02E7 A3                INC     DPTR
02E8 E0                MOVX    A,@DPTR
02E9 FD                MOV     R5,A
02EA ED                MOV     A,R5
02EB 75F00B            MOV     B,#0BH
02EE A4                MUL     AB
02EF 2400        E     ADD     A,#LOW USB_EP+08H
02F1 F582              MOV     DPL,A
02F3 E4                CLR     A
02F4 3400        E     ADDC    A,#HIGH USB_EP+08H
02F6 F583              MOV     DPH,A
02F8 EE                MOV     A,R6
02F9 F0                MOVX    @DPTR,A
02FA A3                INC     DPTR
02FB EF                MOV     A,R7
02FC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 702
02FD         ?C0092:
                                           ; SOURCE LINE # 705
02FD 90000B            MOV     DPTR,#0BH
0300 120000      E     LCALL   ?C?XBPOFF
0303 E0                MOVX    A,@DPTR
0304 FE                MOV     R6,A
0305 A3                INC     DPTR
0306 E0                MOVX    A,@DPTR
0307 FF                MOV     R7,A
0308 8F82              MOV     DPL,R7
030A 8E83              MOV     DPH,R6
030C E4                CLR     A
030D 93                MOVC    A,@A+DPTR
030E FF                MOV     R7,A
030F 7400        E     MOV     A,#LOW USB_interfaceSetting
0311 2F                ADD     A,R7
0312 F582              MOV     DPL,A
0314 E4                CLR     A
0315 3400        E     ADDC    A,#HIGH USB_interfaceSetting
0317 F583              MOV     DPH,A
0319 E0                MOVX    A,@DPTR
031A FF                MOV     R7,A
031B 90000B            MOV     DPTR,#0BH
031E 120000      E     LCALL   ?C?XBPOFF
0321 E0                MOVX    A,@DPTR
0322 FC                MOV     R4,A
0323 A3                INC     DPTR
0324 E0                MOVX    A,@DPTR
0325 FD                MOV     R5,A
0326 8D82              MOV     DPL,R5
0328 8C83              MOV     DPH,R4
032A 7401              MOV     A,#01H
032C 93                MOVC    A,@A+DPTR
032D FE                MOV     R6,A
032E EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 55  

032F 6E                XRL     A,R6
0330 6003              JZ      $ + 5H
0332 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 706
                                           ; SOURCE LINE # 707
0335 90000B            MOV     DPTR,#0BH
0338 120000      E     LCALL   ?C?XBPOFF
033B E0                MOVX    A,@DPTR
033C FE                MOV     R6,A
033D A3                INC     DPTR
033E E0                MOVX    A,@DPTR
033F FF                MOV     R7,A
0340 8F82              MOV     DPL,R7
0342 8E83              MOV     DPH,R6
0344 7402              MOV     A,#02H
0346 93                MOVC    A,@A+DPTR
0347 FF                MOV     R7,A
0348 850083      E     MOV     DPH,?C_XBP
034B 850082      E     MOV     DPL,?C_XBP+01H
034E A3                INC     DPTR
034F A3                INC     DPTR
0350 E0                MOVX    A,@DPTR
0351 FE                MOV     R6,A
0352 EE                MOV     A,R6
0353 75F00B            MOV     B,#0BH
0356 A4                MUL     AB
0357 2400        E     ADD     A,#LOW USB_EP+04H
0359 F582              MOV     DPL,A
035B E4                CLR     A
035C 3400        E     ADDC    A,#HIGH USB_EP+04H
035E F583              MOV     DPH,A
0360 EF                MOV     A,R7
0361 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 708
0362 90000B            MOV     DPTR,#0BH
0365 120000      E     LCALL   ?C?XBPOFF
0368 E0                MOVX    A,@DPTR
0369 FE                MOV     R6,A
036A A3                INC     DPTR
036B E0                MOVX    A,@DPTR
036C FF                MOV     R7,A
036D 8F82              MOV     DPL,R7
036F 8E83              MOV     DPH,R6
0371 7403              MOV     A,#03H
0373 93                MOVC    A,@A+DPTR
0374 FF                MOV     R7,A
0375 850083      E     MOV     DPH,?C_XBP
0378 850082      E     MOV     DPL,?C_XBP+01H
037B A3                INC     DPTR
037C A3                INC     DPTR
037D E0                MOVX    A,@DPTR
037E FE                MOV     R6,A
037F EE                MOV     A,R6
0380 75F00B            MOV     B,#0BH
0383 A4                MUL     AB
0384 2400        E     ADD     A,#LOW USB_EP
0386 F582              MOV     DPL,A
0388 E4                CLR     A
0389 3400        E     ADDC    A,#HIGH USB_EP
038B F583              MOV     DPH,A
038D EF                MOV     A,R7
038E F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 56  

                                           ; SOURCE LINE # 710
038F 90000B            MOV     DPTR,#0BH
0392 120000      E     LCALL   ?C?XBPOFF
0395 E0                MOVX    A,@DPTR
0396 FE                MOV     R6,A
0397 A3                INC     DPTR
0398 E0                MOVX    A,@DPTR
0399 FF                MOV     R7,A
039A 8F82              MOV     DPL,R7
039C 8E83              MOV     DPH,R6
039E 7403              MOV     A,#03H
03A0 93                MOVC    A,@A+DPTR
03A1 FF                MOV     R7,A
03A2 EF                MOV     A,R7
03A3 5403              ANL     A,#03H
03A5 FF                MOV     R7,A
03A6 900003            MOV     DPTR,#03H
03A9 120000      E     LCALL   ?C?XBPOFF
03AC EF                MOV     A,R7
03AD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 712
03AE 90000B            MOV     DPTR,#0BH
03B1 120000      E     LCALL   ?C?XBPOFF
03B4 E0                MOVX    A,@DPTR
03B5 FE                MOV     R6,A
03B6 A3                INC     DPTR
03B7 E0                MOVX    A,@DPTR
03B8 FF                MOV     R7,A
03B9 8F82              MOV     DPL,R7
03BB 8E83              MOV     DPH,R6
03BD 7402              MOV     A,#02H
03BF 93                MOVC    A,@A+DPTR
03C0 FF                MOV     R7,A
03C1 EF                MOV     A,R7
03C2 5480              ANL     A,#080H
03C4 FF                MOV     R7,A
03C5 7E00              MOV     R6,#00H
03C7 EF                MOV     A,R7
03C8 4E                ORL     A,R6
03C9 7003              JNZ     $ + 5H
03CB 020000      R     LJMP    ?C0094
                                           ; SOURCE LINE # 713
                                           ; SOURCE LINE # 715
03CE 900003            MOV     DPTR,#03H
03D1 120000      E     LCALL   ?C?XBPOFF
03D4 E0                MOVX    A,@DPTR
03D5 FF                MOV     R7,A
03D6 EF                MOV     A,R7
03D7 B40104            CJNE    A,#01H,?C0095
03DA 7F07              MOV     R7,#07H
03DC 8002              SJMP    ?C0096
03DE         ?C0095:
03DE 7F0D              MOV     R7,#0DH
03E0         ?C0096:
03E0 850083      E     MOV     DPH,?C_XBP
03E3 850082      E     MOV     DPL,?C_XBP+01H
03E6 A3                INC     DPTR
03E7 A3                INC     DPTR
03E8 E0                MOVX    A,@DPTR
03E9 FE                MOV     R6,A
03EA EE                MOV     A,R6
03EB 75F00B            MOV     B,#0BH
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 57  

03EE A4                MUL     AB
03EF 2400        E     ADD     A,#LOW USB_EP+05H
03F1 F582              MOV     DPL,A
03F3 E4                CLR     A
03F4 3400        E     ADDC    A,#HIGH USB_EP+05H
03F6 F583              MOV     DPH,A
03F8 EF                MOV     A,R7
03F9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 716
03FA 850083      E     MOV     DPH,?C_XBP
03FD 850082      E     MOV     DPL,?C_XBP+01H
0400 A3                INC     DPTR
0401 A3                INC     DPTR
0402 E0                MOVX    A,@DPTR
0403 FF                MOV     R7,A
0404 EF                MOV     A,R7
0405 75F00B            MOV     B,#0BH
0408 A4                MUL     AB
0409 2400        E     ADD     A,#LOW USB_EP+01H
040B F582              MOV     DPL,A
040D E4                CLR     A
040E 3400        E     ADDC    A,#HIGH USB_EP+01H
0410 F583              MOV     DPH,A
0412 7401              MOV     A,#01H
0414 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 719
0415 90000B            MOV     DPTR,#0BH
0418 120000      E     LCALL   ?C?XBPOFF
041B E0                MOVX    A,@DPTR
041C FE                MOV     R6,A
041D A3                INC     DPTR
041E E0                MOVX    A,@DPTR
041F FF                MOV     R7,A
0420 8F82              MOV     DPL,R7
0422 8E83              MOV     DPH,R6
0424 7406              MOV     A,#06H
0426 93                MOVC    A,@A+DPTR
0427 FF                MOV     R7,A
0428 EF                MOV     A,R7
0429 6401              XRL     A,#01H
042B 6003              JZ      $ + 5H
042D 020000      R     LJMP    ?C0091
0430 900003            MOV     DPTR,#03H
0433 120000      E     LCALL   ?C?XBPOFF
0436 E0                MOVX    A,@DPTR
0437 FF                MOV     R7,A
0438 EF                MOV     A,R7
0439 6402              XRL     A,#02H
043B 6003              JZ      $ + 5H
043D 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 720
                                           ; SOURCE LINE # 721
0440 850083      E     MOV     DPH,?C_XBP
0443 850082      E     MOV     DPL,?C_XBP+01H
0446 A3                INC     DPTR
0447 A3                INC     DPTR
0448 E0                MOVX    A,@DPTR
0449 FF                MOV     R7,A
044A 900000      E     MOV     DPTR,#USB_midi_in_ep
044D EF                MOV     A,R7
044E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 722
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 58  

                                           ; SOURCE LINE # 724
044F 8078              SJMP    ?C0091
0451         ?C0094:
                                           ; SOURCE LINE # 726
                                           ; SOURCE LINE # 728
0451 900003            MOV     DPTR,#03H
0454 120000      E     LCALL   ?C?XBPOFF
0457 E0                MOVX    A,@DPTR
0458 FF                MOV     R7,A
0459 EF                MOV     A,R7
045A B40104            CJNE    A,#01H,?C0099
045D 7F05              MOV     R7,#05H
045F 8002              SJMP    ?C0100
0461         ?C0099:
0461 7F09              MOV     R7,#09H
0463         ?C0100:
0463 850083      E     MOV     DPH,?C_XBP
0466 850082      E     MOV     DPL,?C_XBP+01H
0469 A3                INC     DPTR
046A A3                INC     DPTR
046B E0                MOVX    A,@DPTR
046C FE                MOV     R6,A
046D EE                MOV     A,R6
046E 75F00B            MOV     B,#0BH
0471 A4                MUL     AB
0472 2400        E     ADD     A,#LOW USB_EP+05H
0474 F582              MOV     DPL,A
0476 E4                CLR     A
0477 3400        E     ADDC    A,#HIGH USB_EP+05H
0479 F583              MOV     DPH,A
047B EF                MOV     A,R7
047C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 729
047D 850083      E     MOV     DPH,?C_XBP
0480 850082      E     MOV     DPL,?C_XBP+01H
0483 A3                INC     DPTR
0484 A3                INC     DPTR
0485 E0                MOVX    A,@DPTR
0486 FF                MOV     R7,A
0487 EF                MOV     A,R7
0488 75F00B            MOV     B,#0BH
048B A4                MUL     AB
048C 2400        E     ADD     A,#LOW USB_EP+01H
048E F582              MOV     DPL,A
0490 E4                CLR     A
0491 3400        E     ADDC    A,#HIGH USB_EP+01H
0493 F583              MOV     DPH,A
0495 E4                CLR     A
0496 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 732
0497 90000B            MOV     DPTR,#0BH
049A 120000      E     LCALL   ?C?XBPOFF
049D E0                MOVX    A,@DPTR
049E FE                MOV     R6,A
049F A3                INC     DPTR
04A0 E0                MOVX    A,@DPTR
04A1 FF                MOV     R7,A
04A2 8F82              MOV     DPL,R7
04A4 8E83              MOV     DPH,R6
04A6 7406              MOV     A,#06H
04A8 93                MOVC    A,@A+DPTR
04A9 FF                MOV     R7,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 59  

04AA EF                MOV     A,R7
04AB B4011B            CJNE    A,#01H,?C0091
04AE 900003            MOV     DPTR,#03H
04B1 120000      E     LCALL   ?C?XBPOFF
04B4 E0                MOVX    A,@DPTR
04B5 FF                MOV     R7,A
04B6 EF                MOV     A,R7
04B7 B4020F            CJNE    A,#02H,?C0091
                                           ; SOURCE LINE # 733
                                           ; SOURCE LINE # 734
04BA 850083      E     MOV     DPH,?C_XBP
04BD 850082      E     MOV     DPL,?C_XBP+01H
04C0 A3                INC     DPTR
04C1 A3                INC     DPTR
04C2 E0                MOVX    A,@DPTR
04C3 FF                MOV     R7,A
04C4 900000      E     MOV     DPTR,#USB_midi_out_ep
04C7 EF                MOV     A,R7
04C8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 735
                                           ; SOURCE LINE # 737
                                           ; SOURCE LINE # 749
                                           ; SOURCE LINE # 750
04C9         ?C0091:
                                           ; SOURCE LINE # 752
04C9 90000B            MOV     DPTR,#0BH
04CC 120000      E     LCALL   ?C?XBPOFF
04CF E0                MOVX    A,@DPTR
04D0 FE                MOV     R6,A
04D1 A3                INC     DPTR
04D2 E0                MOVX    A,@DPTR
04D3 FF                MOV     R7,A
04D4 EF                MOV     A,R7
04D5 2407              ADD     A,#07H
04D7 FF                MOV     R7,A
04D8 EE                MOV     A,R6
04D9 3400              ADDC    A,#00H
04DB FE                MOV     R6,A
04DC 90000B            MOV     DPTR,#0BH
04DF 120000      E     LCALL   ?C?XBPOFF
04E2 EE                MOV     A,R6
04E3 F0                MOVX    @DPTR,A
04E4 A3                INC     DPTR
04E5 EF                MOV     A,R7
04E6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 753
04E7 850083      E     MOV     DPH,?C_XBP
04EA 850082      E     MOV     DPL,?C_XBP+01H
04ED A3                INC     DPTR
04EE E0                MOVX    A,@DPTR
04EF 04                INC     A
04F0 F0                MOVX    @DPTR,A
04F1 020000      R     LJMP    ?C0088
                                           ; SOURCE LINE # 754
04F4         ?C0087:
04F4 850083      E     MOV     DPH,?C_XBP
04F7 850082      E     MOV     DPL,?C_XBP+01H
04FA A3                INC     DPTR
04FB A3                INC     DPTR
04FC E0                MOVX    A,@DPTR
04FD 04                INC     A
04FE F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 60  

04FF 020000      R     LJMP    ?C0085
0502         ?C0086:
                                           ; SOURCE LINE # 762
0502 900009            MOV     DPTR,#09H
0505 120000      E     LCALL   ?C?XBPOFF
0508 E0                MOVX    A,@DPTR
0509 FE                MOV     R6,A
050A A3                INC     DPTR
050B E0                MOVX    A,@DPTR
050C FF                MOV     R7,A
050D 8F82              MOV     DPL,R7
050F 8E83              MOV     DPH,R6
0511 A3                INC     DPTR
0512 120000      E     LCALL   ?C?PLDCODE
0515 AE02              MOV     R6,AR2
0517 AF01              MOV     R7,AR1
0519 90000B            MOV     DPTR,#0BH
051C 120000      E     LCALL   ?C?XBPOFF
051F EE                MOV     A,R6
0520 F0                MOVX    @DPTR,A
0521 A3                INC     DPTR
0522 EF                MOV     A,R7
0523 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 763
0524 850083      E     MOV     DPH,?C_XBP
0527 850082      E     MOV     DPL,?C_XBP+01H
052A A3                INC     DPTR
052B A3                INC     DPTR
052C E4                CLR     A
052D F0                MOVX    @DPTR,A
052E         ?C0102:
052E 850083      E     MOV     DPH,?C_XBP
0531 850082      E     MOV     DPL,?C_XBP+01H
0534 E0                MOVX    A,@DPTR
0535 FF                MOV     R7,A
0536 850083      E     MOV     DPH,?C_XBP
0539 850082      E     MOV     DPL,?C_XBP+01H
053C A3                INC     DPTR
053D A3                INC     DPTR
053E E0                MOVX    A,@DPTR
053F FE                MOV     R6,A
0540 EE                MOV     A,R6
0541 C3                CLR     C
0542 9F                SUBB    A,R7
0543 5064              JNC     ?C0103
                                           ; SOURCE LINE # 764
                                           ; SOURCE LINE # 766
0545 90000B            MOV     DPTR,#0BH
0548 120000      E     LCALL   ?C?XBPOFF
054B E0                MOVX    A,@DPTR
054C FE                MOV     R6,A
054D A3                INC     DPTR
054E E0                MOVX    A,@DPTR
054F FF                MOV     R7,A
0550 8F82              MOV     DPL,R7
0552 8E83              MOV     DPH,R6
0554 E4                CLR     A
0555 93                MOVC    A,@A+DPTR
0556 FF                MOV     R7,A
0557 90000B            MOV     DPTR,#0BH
055A 120000      E     LCALL   ?C?XBPOFF
055D E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 61  

055E FC                MOV     R4,A
055F A3                INC     DPTR
0560 E0                MOVX    A,@DPTR
0561 FD                MOV     R5,A
0562 8D82              MOV     DPL,R5
0564 8C83              MOV     DPH,R4
0566 7402              MOV     A,#02H
0568 93                MOVC    A,@A+DPTR
0569 FE                MOV     R6,A
056A EE                MOV     A,R6
056B 547F              ANL     A,#07FH
056D FE                MOV     R6,A
056E EE                MOV     A,R6
056F 75F00B            MOV     B,#0BH
0572 A4                MUL     AB
0573 2400        E     ADD     A,#LOW USB_EP+0AH
0575 F582              MOV     DPL,A
0577 E4                CLR     A
0578 3400        E     ADDC    A,#HIGH USB_EP+0AH
057A F583              MOV     DPH,A
057C EF                MOV     A,R7
057D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 767
057E 90000B            MOV     DPTR,#0BH
0581 120000      E     LCALL   ?C?XBPOFF
0584 E0                MOVX    A,@DPTR
0585 FE                MOV     R6,A
0586 A3                INC     DPTR
0587 E0                MOVX    A,@DPTR
0588 FF                MOV     R7,A
0589 EF                MOV     A,R7
058A 2407              ADD     A,#07H
058C FF                MOV     R7,A
058D EE                MOV     A,R6
058E 3400              ADDC    A,#00H
0590 FE                MOV     R6,A
0591 90000B            MOV     DPTR,#0BH
0594 120000      E     LCALL   ?C?XBPOFF
0597 EE                MOV     A,R6
0598 F0                MOVX    @DPTR,A
0599 A3                INC     DPTR
059A EF                MOV     A,R7
059B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 768
059C 850083      E     MOV     DPH,?C_XBP
059F 850082      E     MOV     DPL,?C_XBP+01H
05A2 A3                INC     DPTR
05A3 A3                INC     DPTR
05A4 E0                MOVX    A,@DPTR
05A5 04                INC     A
05A6 F0                MOVX    @DPTR,A
05A7 8085              SJMP    ?C0102
05A9         ?C0103:
                                           ; SOURCE LINE # 771
05A9 120000      R     LCALL   _?USB_GetInterfaceClassTablePtr
05AC 900000      E     MOV     DPTR,#USB_interfaceClass
05AF EE                MOV     A,R6
05B0 F0                MOVX    @DPTR,A
05B1 A3                INC     DPTR
05B2 EF                MOV     A,R7
05B3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 775
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 62  

05B4 900007            MOV     DPTR,#07H
05B7 120000      E     LCALL   ?C?XBPOFF
05BA E4                CLR     A
05BB F0                MOVX    @DPTR,A
05BC A3                INC     DPTR
05BD E4                CLR     A
05BE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 776
05BF 850083      E     MOV     DPH,?C_XBP
05C2 850082      E     MOV     DPL,?C_XBP+01H
05C5 7401              MOV     A,#01H
05C7 F0                MOVX    @DPTR,A
05C8         ?C0105:
05C8 850083      E     MOV     DPH,?C_XBP
05CB 850082      E     MOV     DPL,?C_XBP+01H
05CE E0                MOVX    A,@DPTR
05CF FF                MOV     R7,A
05D0 EF                MOV     A,R7
05D1 C3                CLR     C
05D2 9409              SUBB    A,#09H
05D4 507E              JNC     ?C0106
                                           ; SOURCE LINE # 777
                                           ; SOURCE LINE # 778
05D6 900007            MOV     DPTR,#07H
05D9 120000      E     LCALL   ?C?XBPOFF
05DC E0                MOVX    A,@DPTR
05DD FE                MOV     R6,A
05DE A3                INC     DPTR
05DF E0                MOVX    A,@DPTR
05E0 FF                MOV     R7,A
05E1 850083      E     MOV     DPH,?C_XBP
05E4 850082      E     MOV     DPL,?C_XBP+01H
05E7 E0                MOVX    A,@DPTR
05E8 FD                MOV     R5,A
05E9 ED                MOV     A,R5
05EA 75F00B            MOV     B,#0BH
05ED A4                MUL     AB
05EE 2400        E     ADD     A,#LOW USB_EP+06H
05F0 F582              MOV     DPL,A
05F2 E4                CLR     A
05F3 3400        E     ADDC    A,#HIGH USB_EP+06H
05F5 F583              MOV     DPH,A
05F7 EE                MOV     A,R6
05F8 F0                MOVX    @DPTR,A
05F9 A3                INC     DPTR
05FA EF                MOV     A,R7
05FB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 779
05FC 850083      E     MOV     DPH,?C_XBP
05FF 850082      E     MOV     DPL,?C_XBP+01H
0602 E0                MOVX    A,@DPTR
0603 FF                MOV     R7,A
0604 EF                MOV     A,R7
0605 75F00B            MOV     B,#0BH
0608 A4                MUL     AB
0609 2400        E     ADD     A,#LOW USB_EP+08H
060B F582              MOV     DPL,A
060D E4                CLR     A
060E 3400        E     ADDC    A,#HIGH USB_EP+08H
0610 F583              MOV     DPH,A
0612 E0                MOVX    A,@DPTR
0613 FE                MOV     R6,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 63  

0614 A3                INC     DPTR
0615 E0                MOVX    A,@DPTR
0616 FF                MOV     R7,A
0617 900007            MOV     DPTR,#07H
061A 120000      E     LCALL   ?C?XBPOFF
061D EE                MOV     A,R6
061E 8FF0              MOV     B,R7
0620 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 783
0623 900007            MOV     DPTR,#07H
0626 120000      E     LCALL   ?C?XBPOFF
0629 E0                MOVX    A,@DPTR
062A FE                MOV     R6,A
062B A3                INC     DPTR
062C E0                MOVX    A,@DPTR
062D FF                MOV     R7,A
062E EF                MOV     A,R7
062F 30E006            JNB     ACC.0,?C0108
0632 7E00              MOV     R6,#00H
0634 7F01              MOV     R7,#01H
0636 8004              SJMP    ?C0109
0638         ?C0108:
0638 7E00              MOV     R6,#00H
063A 7F00              MOV     R7,#00H
063C         ?C0109:
063C 900007            MOV     DPTR,#07H
063F 120000      E     LCALL   ?C?XBPOFF
0642 EE                MOV     A,R6
0643 8FF0              MOV     B,R7
0645 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 785
0648 850083      E     MOV     DPH,?C_XBP
064B 850082      E     MOV     DPL,?C_XBP+01H
064E E0                MOVX    A,@DPTR
064F 04                INC     A
0650 F0                MOVX    @DPTR,A
0651 020000      R     LJMP    ?C0105
0654         ?C0106:
                                           ; SOURCE LINE # 789
0654 120000      R     LCALL   _?USB_ConfigReg
                                           ; SOURCE LINE # 790
                                           ; SOURCE LINE # 791
0657         ?C0110:
0657 90000E            MOV     DPTR,#0EH
065A 120000      E     LCALL   ?C?ADDXBP
065D 22                RET     
             ; FUNCTION _?USB_Config (END)

             ; FUNCTION USB_ConfigAltChanged (BEGIN)
                                           ; SOURCE LINE # 805
                                           ; SOURCE LINE # 806
                                           ; SOURCE LINE # 817
0000 900000      E     MOV     DPTR,#USB_configuration
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 D3                SETB    C
0007 9400              SUBB    A,#00H
0009 5003              JNC     $ + 5H
000B 020000      R     LJMP    ?C0122
                                           ; SOURCE LINE # 818
                                           ; SOURCE LINE # 820
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 64  

000E 900000      E     MOV     DPTR,#USB_configuration
0011 E0                MOVX    A,@DPTR
0012 FF                MOV     R7,A
0013 EF                MOV     A,R7
0014 14                DEC     A
0015 FF                MOV     R7,A
0016 120000      R     LCALL   _?USB_GetConfigTablePtr
0019 900000      R     MOV     DPTR,#pTmp
001C EE                MOV     A,R6
001D F0                MOVX    @DPTR,A
001E A3                INC     DPTR
001F EF                MOV     A,R7
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 821
0021 900000      R     MOV     DPTR,#pTmp
0024 E0                MOVX    A,@DPTR
0025 FE                MOV     R6,A
0026 A3                INC     DPTR
0027 E0                MOVX    A,@DPTR
0028 FF                MOV     R7,A
0029 EF                MOV     A,R7
002A 2404              ADD     A,#04H
002C FF                MOV     R7,A
002D EE                MOV     A,R6
002E 3400              ADDC    A,#00H
0030 FE                MOV     R6,A
0031 900000      R     MOV     DPTR,#pTmp
0034 EE                MOV     A,R6
0035 F0                MOVX    @DPTR,A
0036 A3                INC     DPTR
0037 EF                MOV     A,R7
0038 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 822
0039 900000      R     MOV     DPTR,#pTmp
003C E0                MOVX    A,@DPTR
003D FE                MOV     R6,A
003E A3                INC     DPTR
003F E0                MOVX    A,@DPTR
0040 FF                MOV     R7,A
0041 8F82              MOV     DPL,R7
0043 8E83              MOV     DPH,R6
0045 E4                CLR     A
0046 93                MOVC    A,@A+DPTR
0047 FF                MOV     R7,A
0048 900000      R     MOV     DPTR,#ep
004B EF                MOV     A,R7
004C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 825
004D 900000      R     MOV     DPTR,#pTmp
0050 E0                MOVX    A,@DPTR
0051 FE                MOV     R6,A
0052 A3                INC     DPTR
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 8F82              MOV     DPL,R7
0057 8E83              MOV     DPH,R6
0059 A3                INC     DPTR
005A 120000      E     LCALL   ?C?PLDCODE
005D AE02              MOV     R6,AR2
005F AF01              MOV     R7,AR1
0061 900000      R     MOV     DPTR,#pEP
0064 EE                MOV     A,R6
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 65  

0065 F0                MOVX    @DPTR,A
0066 A3                INC     DPTR
0067 EF                MOV     A,R7
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 831
0069 900000      E     MOV     DPTR,#USB_interfaceNumber
006C E0                MOVX    A,@DPTR
006D FF                MOV     R7,A
006E 900000      R     MOV     DPTR,#interfaceNum
0071 EF                MOV     A,R7
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 832
0073 900000      R     MOV     DPTR,#i
0076 E4                CLR     A
0077 F0                MOVX    @DPTR,A
0078         ?C0112:
0078 900000      R     MOV     DPTR,#ep
007B E0                MOVX    A,@DPTR
007C FF                MOV     R7,A
007D 900000      R     MOV     DPTR,#i
0080 E0                MOVX    A,@DPTR
0081 FE                MOV     R6,A
0082 EE                MOV     A,R6
0083 C3                CLR     C
0084 9F                SUBB    A,R7
0085 4003              JC      $ + 5H
0087 020000      R     LJMP    ?C0122
                                           ; SOURCE LINE # 833
                                           ; SOURCE LINE # 835
008A 900000      R     MOV     DPTR,#pEP
008D E0                MOVX    A,@DPTR
008E FE                MOV     R6,A
008F A3                INC     DPTR
0090 E0                MOVX    A,@DPTR
0091 FF                MOV     R7,A
0092 8F82              MOV     DPL,R7
0094 8E83              MOV     DPH,R6
0096 E4                CLR     A
0097 93                MOVC    A,@A+DPTR
0098 FF                MOV     R7,A
0099 900000      R     MOV     DPTR,#interfaceNum
009C E0                MOVX    A,@DPTR
009D FE                MOV     R6,A
009E EE                MOV     A,R6
009F 6F                XRL     A,R7
00A0 6003              JZ      $ + 5H
00A2 020000      R     LJMP    ?C0115
00A5 900000      R     MOV     DPTR,#pEP
00A8 E0                MOVX    A,@DPTR
00A9 FE                MOV     R6,A
00AA A3                INC     DPTR
00AB E0                MOVX    A,@DPTR
00AC FF                MOV     R7,A
00AD 8F82              MOV     DPL,R7
00AF 8E83              MOV     DPH,R6
00B1 7401              MOV     A,#01H
00B3 93                MOVC    A,@A+DPTR
00B4 FF                MOV     R7,A
00B5 900000      R     MOV     DPTR,#interfaceNum
00B8 E0                MOVX    A,@DPTR
00B9 FE                MOV     R6,A
00BA 7400        E     MOV     A,#LOW USB_interfaceSetting
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 66  

00BC 2E                ADD     A,R6
00BD F582              MOV     DPL,A
00BF E4                CLR     A
00C0 3400        E     ADDC    A,#HIGH USB_interfaceSetting
00C2 F583              MOV     DPH,A
00C4 E0                MOVX    A,@DPTR
00C5 FE                MOV     R6,A
00C6 EE                MOV     A,R6
00C7 6F                XRL     A,R7
00C8 6003              JZ      $ + 5H
00CA 020000      R     LJMP    ?C0115
                                           ; SOURCE LINE # 837
                                           ; SOURCE LINE # 838
00CD 900000      R     MOV     DPTR,#pEP
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 FF                MOV     R7,A
00D5 8F82              MOV     DPL,R7
00D7 8E83              MOV     DPH,R6
00D9 7402              MOV     A,#02H
00DB 93                MOVC    A,@A+DPTR
00DC FF                MOV     R7,A
00DD EF                MOV     A,R7
00DE 547F              ANL     A,#07FH
00E0 FF                MOV     R7,A
00E1 900000      R     MOV     DPTR,#curEp
00E4 EF                MOV     A,R7
00E5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 839
00E6 900000      R     MOV     DPTR,#pEP
00E9 E0                MOVX    A,@DPTR
00EA FE                MOV     R6,A
00EB A3                INC     DPTR
00EC E0                MOVX    A,@DPTR
00ED FF                MOV     R7,A
00EE 8F82              MOV     DPL,R7
00F0 8E83              MOV     DPH,R6
00F2 7403              MOV     A,#03H
00F4 93                MOVC    A,@A+DPTR
00F5 FF                MOV     R7,A
00F6 EF                MOV     A,R7
00F7 5403              ANL     A,#03H
00F9 FF                MOV     R7,A
00FA 900000      R     MOV     DPTR,#epType
00FD EF                MOV     A,R7
00FE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 842
00FF 900000      R     MOV     DPTR,#curEp
0102 E0                MOVX    A,@DPTR
0103 FF                MOV     R7,A
0104 EF                MOV     A,R7
0105 75F00B            MOV     B,#0BH
0108 A4                MUL     AB
0109 2400        E     ADD     A,#LOW USB_EP+03H
010B F582              MOV     DPL,A
010D E4                CLR     A
010E 3400        E     ADDC    A,#HIGH USB_EP+03H
0110 F583              MOV     DPH,A
0112 E4                CLR     A
0113 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 67  

                                           ; SOURCE LINE # 843
0114 900000      R     MOV     DPTR,#pEP
0117 E0                MOVX    A,@DPTR
0118 FE                MOV     R6,A
0119 A3                INC     DPTR
011A E0                MOVX    A,@DPTR
011B FF                MOV     R7,A
011C 8F82              MOV     DPL,R7
011E 8E83              MOV     DPH,R6
0120 7402              MOV     A,#02H
0122 93                MOVC    A,@A+DPTR
0123 FF                MOV     R7,A
0124 900000      R     MOV     DPTR,#curEp
0127 E0                MOVX    A,@DPTR
0128 FE                MOV     R6,A
0129 EE                MOV     A,R6
012A 75F00B            MOV     B,#0BH
012D A4                MUL     AB
012E 2400        E     ADD     A,#LOW USB_EP+04H
0130 F582              MOV     DPL,A
0132 E4                CLR     A
0133 3400        E     ADDC    A,#HIGH USB_EP+04H
0135 F583              MOV     DPH,A
0137 EF                MOV     A,R7
0138 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 844
0139 900000      R     MOV     DPTR,#pEP
013C E0                MOVX    A,@DPTR
013D FE                MOV     R6,A
013E A3                INC     DPTR
013F E0                MOVX    A,@DPTR
0140 FF                MOV     R7,A
0141 8F82              MOV     DPL,R7
0143 8E83              MOV     DPH,R6
0145 7403              MOV     A,#03H
0147 93                MOVC    A,@A+DPTR
0148 FF                MOV     R7,A
0149 900000      R     MOV     DPTR,#curEp
014C E0                MOVX    A,@DPTR
014D FE                MOV     R6,A
014E EE                MOV     A,R6
014F 75F00B            MOV     B,#0BH
0152 A4                MUL     AB
0153 2400        E     ADD     A,#LOW USB_EP
0155 F582              MOV     DPL,A
0157 E4                CLR     A
0158 3400        E     ADDC    A,#HIGH USB_EP
015A F583              MOV     DPH,A
015C EF                MOV     A,R7
015D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 845
015E 900000      R     MOV     DPTR,#pEP
0161 E0                MOVX    A,@DPTR
0162 FE                MOV     R6,A
0163 A3                INC     DPTR
0164 E0                MOVX    A,@DPTR
0165 FF                MOV     R7,A
0166 8F82              MOV     DPL,R7
0168 8E83              MOV     DPH,R6
016A 7404              MOV     A,#04H
016C 93                MOVC    A,@A+DPTR
016D FE                MOV     R6,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 68  

016E 7405              MOV     A,#05H
0170 93                MOVC    A,@A+DPTR
0171 FF                MOV     R7,A
0172 900000      R     MOV     DPTR,#curEp
0175 E0                MOVX    A,@DPTR
0176 FD                MOV     R5,A
0177 ED                MOV     A,R5
0178 75F00B            MOV     B,#0BH
017B A4                MUL     AB
017C 2400        E     ADD     A,#LOW USB_EP+08H
017E F582              MOV     DPL,A
0180 E4                CLR     A
0181 3400        E     ADDC    A,#HIGH USB_EP+08H
0183 F583              MOV     DPH,A
0185 EE                MOV     A,R6
0186 F0                MOVX    @DPTR,A
0187 A3                INC     DPTR
0188 EF                MOV     A,R7
0189 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 847
018A 900000      R     MOV     DPTR,#pEP
018D E0                MOVX    A,@DPTR
018E FE                MOV     R6,A
018F A3                INC     DPTR
0190 E0                MOVX    A,@DPTR
0191 FF                MOV     R7,A
0192 8F82              MOV     DPL,R7
0194 8E83              MOV     DPH,R6
0196 7402              MOV     A,#02H
0198 93                MOVC    A,@A+DPTR
0199 FF                MOV     R7,A
019A EF                MOV     A,R7
019B 5480              ANL     A,#080H
019D FF                MOV     R7,A
019E 7E00              MOV     R6,#00H
01A0 EF                MOV     A,R7
01A1 4E                ORL     A,R6
01A2 603C              JZ      ?C0116
                                           ; SOURCE LINE # 848
                                           ; SOURCE LINE # 850
01A4 900000      R     MOV     DPTR,#epType
01A7 E0                MOVX    A,@DPTR
01A8 FF                MOV     R7,A
01A9 EF                MOV     A,R7
01AA B40104            CJNE    A,#01H,?C0117
01AD 7F07              MOV     R7,#07H
01AF 8002              SJMP    ?C0118
01B1         ?C0117:
01B1 7F0D              MOV     R7,#0DH
01B3         ?C0118:
01B3 900000      R     MOV     DPTR,#curEp
01B6 E0                MOVX    A,@DPTR
01B7 FE                MOV     R6,A
01B8 EE                MOV     A,R6
01B9 75F00B            MOV     B,#0BH
01BC A4                MUL     AB
01BD 2400        E     ADD     A,#LOW USB_EP+05H
01BF F582              MOV     DPL,A
01C1 E4                CLR     A
01C2 3400        E     ADDC    A,#HIGH USB_EP+05H
01C4 F583              MOV     DPH,A
01C6 EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 69  

01C7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 851
01C8 900000      R     MOV     DPTR,#curEp
01CB E0                MOVX    A,@DPTR
01CC FF                MOV     R7,A
01CD EF                MOV     A,R7
01CE 75F00B            MOV     B,#0BH
01D1 A4                MUL     AB
01D2 2400        E     ADD     A,#LOW USB_EP+01H
01D4 F582              MOV     DPL,A
01D6 E4                CLR     A
01D7 3400        E     ADDC    A,#HIGH USB_EP+01H
01D9 F583              MOV     DPH,A
01DB 7401              MOV     A,#01H
01DD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 852
01DE 8039              SJMP    ?C0119
01E0         ?C0116:
                                           ; SOURCE LINE # 854
                                           ; SOURCE LINE # 856
01E0 900000      R     MOV     DPTR,#epType
01E3 E0                MOVX    A,@DPTR
01E4 FF                MOV     R7,A
01E5 EF                MOV     A,R7
01E6 B40104            CJNE    A,#01H,?C0120
01E9 7F05              MOV     R7,#05H
01EB 8002              SJMP    ?C0121
01ED         ?C0120:
01ED 7F09              MOV     R7,#09H
01EF         ?C0121:
01EF 900000      R     MOV     DPTR,#curEp
01F2 E0                MOVX    A,@DPTR
01F3 FE                MOV     R6,A
01F4 EE                MOV     A,R6
01F5 75F00B            MOV     B,#0BH
01F8 A4                MUL     AB
01F9 2400        E     ADD     A,#LOW USB_EP+05H
01FB F582              MOV     DPL,A
01FD E4                CLR     A
01FE 3400        E     ADDC    A,#HIGH USB_EP+05H
0200 F583              MOV     DPH,A
0202 EF                MOV     A,R7
0203 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 857
0204 900000      R     MOV     DPTR,#curEp
0207 E0                MOVX    A,@DPTR
0208 FF                MOV     R7,A
0209 EF                MOV     A,R7
020A 75F00B            MOV     B,#0BH
020D A4                MUL     AB
020E 2400        E     ADD     A,#LOW USB_EP+01H
0210 F582              MOV     DPL,A
0212 E4                CLR     A
0213 3400        E     ADDC    A,#HIGH USB_EP+01H
0215 F583              MOV     DPH,A
0217 E4                CLR     A
0218 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 858
0219         ?C0119:
                                           ; SOURCE LINE # 861
0219 900000      R     MOV     DPTR,#curEp
021C E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 70  

021D FF                MOV     R7,A
021E 75F010            MOV     B,#010H
0221 EF                MOV     A,R7
0222 905FFE            MOV     DPTR,#05FFEH
0225 120000      E     LCALL   ?C?OFFXADD
0228 7401              MOV     A,#01H
022A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 907
022B 900000      R     MOV     DPTR,#curEp
022E E0                MOVX    A,@DPTR
022F FF                MOV     R7,A
0230 EF                MOV     A,R7
0231 75F00B            MOV     B,#0BH
0234 A4                MUL     AB
0235 2400        E     ADD     A,#LOW USB_EP+08H
0237 F582              MOV     DPL,A
0239 E4                CLR     A
023A 3400        E     ADDC    A,#HIGH USB_EP+08H
023C F583              MOV     DPH,A
023E E0                MOVX    A,@DPTR
023F FE                MOV     R6,A
0240 A3                INC     DPTR
0241 E0                MOVX    A,@DPTR
0242 FF                MOV     R7,A
0243 EE                MOV     A,R6
0244 FF                MOV     R7,A
0245 7E00              MOV     R6,#00H
0247 900000      R     MOV     DPTR,#curEp
024A E0                MOVX    A,@DPTR
024B FE                MOV     R6,A
024C 75F010            MOV     B,#010H
024F EE                MOV     A,R6
0250 905FFC            MOV     DPTR,#05FFCH
0253 120000      E     LCALL   ?C?OFFXADD
0256 EF                MOV     A,R7
0257 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 908
0258 900000      R     MOV     DPTR,#curEp
025B E0                MOVX    A,@DPTR
025C FF                MOV     R7,A
025D EF                MOV     A,R7
025E 75F00B            MOV     B,#0BH
0261 A4                MUL     AB
0262 2400        E     ADD     A,#LOW USB_EP+08H
0264 F582              MOV     DPL,A
0266 E4                CLR     A
0267 3400        E     ADDC    A,#HIGH USB_EP+08H
0269 F583              MOV     DPH,A
026B E0                MOVX    A,@DPTR
026C FE                MOV     R6,A
026D A3                INC     DPTR
026E E0                MOVX    A,@DPTR
026F FF                MOV     R7,A
0270 EF                MOV     A,R7
0271 54FF              ANL     A,#0FFH
0273 FF                MOV     R7,A
0274 900000      R     MOV     DPTR,#curEp
0277 E0                MOVX    A,@DPTR
0278 FE                MOV     R6,A
0279 75F010            MOV     B,#010H
027C EE                MOV     A,R6
027D 905FFD            MOV     DPTR,#05FFDH
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 71  

0280 120000      E     LCALL   ?C?OFFXADD
0283 EF                MOV     A,R7
0284 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 914
0285 900000      R     MOV     DPTR,#curEp
0288 E0                MOVX    A,@DPTR
0289 FF                MOV     R7,A
028A EF                MOV     A,R7
028B 75F00B            MOV     B,#0BH
028E A4                MUL     AB
028F 2400        E     ADD     A,#LOW USB_EP+06H
0291 F582              MOV     DPL,A
0293 E4                CLR     A
0294 3400        E     ADDC    A,#HIGH USB_EP+06H
0296 F583              MOV     DPH,A
0298 E0                MOVX    A,@DPTR
0299 FE                MOV     R6,A
029A A3                INC     DPTR
029B E0                MOVX    A,@DPTR
029C FF                MOV     R7,A
029D EF                MOV     A,R7
029E 54FF              ANL     A,#0FFH
02A0 FF                MOV     R7,A
02A1 900000      R     MOV     DPTR,#curEp
02A4 E0                MOVX    A,@DPTR
02A5 FE                MOV     R6,A
02A6 75F010            MOV     B,#010H
02A9 EE                MOV     A,R6
02AA 906076            MOV     DPTR,#06076H
02AD 120000      E     LCALL   ?C?OFFXADD
02B0 EF                MOV     A,R7
02B1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 915
02B2 900000      R     MOV     DPTR,#curEp
02B5 E0                MOVX    A,@DPTR
02B6 FF                MOV     R7,A
02B7 EF                MOV     A,R7
02B8 75F00B            MOV     B,#0BH
02BB A4                MUL     AB
02BC 2400        E     ADD     A,#LOW USB_EP+06H
02BE F582              MOV     DPL,A
02C0 E4                CLR     A
02C1 3400        E     ADDC    A,#HIGH USB_EP+06H
02C3 F583              MOV     DPH,A
02C5 E0                MOVX    A,@DPTR
02C6 FE                MOV     R6,A
02C7 A3                INC     DPTR
02C8 E0                MOVX    A,@DPTR
02C9 FF                MOV     R7,A
02CA EE                MOV     A,R6
02CB FF                MOV     R7,A
02CC 7E00              MOV     R6,#00H
02CE 900000      R     MOV     DPTR,#curEp
02D1 E0                MOVX    A,@DPTR
02D2 FE                MOV     R6,A
02D3 75F010            MOV     B,#010H
02D6 EE                MOV     A,R6
02D7 906077            MOV     DPTR,#06077H
02DA 120000      E     LCALL   ?C?OFFXADD
02DD EF                MOV     A,R7
02DE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 916
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 72  

02DF 900000      R     MOV     DPTR,#curEp
02E2 E0                MOVX    A,@DPTR
02E3 FF                MOV     R7,A
02E4 EF                MOV     A,R7
02E5 75F00B            MOV     B,#0BH
02E8 A4                MUL     AB
02E9 2400        E     ADD     A,#LOW USB_EP+06H
02EB F582              MOV     DPL,A
02ED E4                CLR     A
02EE 3400        E     ADDC    A,#HIGH USB_EP+06H
02F0 F583              MOV     DPH,A
02F2 E0                MOVX    A,@DPTR
02F3 FE                MOV     R6,A
02F4 A3                INC     DPTR
02F5 E0                MOVX    A,@DPTR
02F6 FF                MOV     R7,A
02F7 EF                MOV     A,R7
02F8 54FF              ANL     A,#0FFH
02FA FF                MOV     R7,A
02FB 900000      R     MOV     DPTR,#curEp
02FE E0                MOVX    A,@DPTR
02FF FE                MOV     R6,A
0300 75F010            MOV     B,#010H
0303 EE                MOV     A,R6
0304 906074            MOV     DPTR,#06074H
0307 120000      E     LCALL   ?C?OFFXADD
030A EF                MOV     A,R7
030B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 917
030C 900000      R     MOV     DPTR,#curEp
030F E0                MOVX    A,@DPTR
0310 FF                MOV     R7,A
0311 EF                MOV     A,R7
0312 75F00B            MOV     B,#0BH
0315 A4                MUL     AB
0316 2400        E     ADD     A,#LOW USB_EP+06H
0318 F582              MOV     DPL,A
031A E4                CLR     A
031B 3400        E     ADDC    A,#HIGH USB_EP+06H
031D F583              MOV     DPH,A
031F E0                MOVX    A,@DPTR
0320 FE                MOV     R6,A
0321 A3                INC     DPTR
0322 E0                MOVX    A,@DPTR
0323 FF                MOV     R7,A
0324 EE                MOV     A,R6
0325 FF                MOV     R7,A
0326 7E00              MOV     R6,#00H
0328 900000      R     MOV     DPTR,#curEp
032B E0                MOVX    A,@DPTR
032C FE                MOV     R6,A
032D 75F010            MOV     B,#010H
0330 EE                MOV     A,R6
0331 906075            MOV     DPTR,#06075H
0334 120000      E     LCALL   ?C?OFFXADD
0337 EF                MOV     A,R7
0338 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 920
0339         ?C0115:
                                           ; SOURCE LINE # 922
0339 900000      R     MOV     DPTR,#pEP
033C E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 73  

033D FE                MOV     R6,A
033E A3                INC     DPTR
033F E0                MOVX    A,@DPTR
0340 FF                MOV     R7,A
0341 EF                MOV     A,R7
0342 2407              ADD     A,#07H
0344 FF                MOV     R7,A
0345 EE                MOV     A,R6
0346 3400              ADDC    A,#00H
0348 FE                MOV     R6,A
0349 900000      R     MOV     DPTR,#pEP
034C EE                MOV     A,R6
034D F0                MOVX    @DPTR,A
034E A3                INC     DPTR
034F EF                MOV     A,R7
0350 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 923
0351 900000      R     MOV     DPTR,#i
0354 E0                MOVX    A,@DPTR
0355 04                INC     A
0356 F0                MOVX    @DPTR,A
0357 020000      R     LJMP    ?C0112
                                           ; SOURCE LINE # 926
                                           ; SOURCE LINE # 927
035A         ?C0122:
035A 22                RET     
             ; FUNCTION USB_ConfigAltChanged (END)

             ; FUNCTION _?USB_GetConfigTablePtr (BEGIN)
                                           ; SOURCE LINE # 942
0000 90FFFF            MOV     DPTR,#0FFFFH
0003 120000      E     LCALL   ?C?ADDXBP
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
0008 90FFFE            MOV     DPTR,#0FFFEH
000B 120000      E     LCALL   ?C?ADDXBP
                                           ; SOURCE LINE # 943
                                           ; SOURCE LINE # 948
000E 900000      E     MOV     DPTR,#USB_device
0011 E0                MOVX    A,@DPTR
0012 FF                MOV     R7,A
0013 EF                MOV     A,R7
0014 25E0              ADD     A,ACC
0016 25E0              ADD     A,ACC
0018 2400        E     ADD     A,#LOW USB_TABLE+01H
001A F582              MOV     DPL,A
001C E4                CLR     A
001D 3400        E     ADDC    A,#HIGH USB_TABLE+01H
001F F583              MOV     DPH,A
0021 120000      E     LCALL   ?C?PLDCODE
0024 AE02              MOV     R6,AR2
0026 AF01              MOV     R7,AR1
0028 850083      E     MOV     DPH,?C_XBP
002B 850082      E     MOV     DPL,?C_XBP+01H
002E EE                MOV     A,R6
002F F0                MOVX    @DPTR,A
0030 A3                INC     DPTR
0031 EF                MOV     A,R7
0032 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 955
0033 850083      E     MOV     DPH,?C_XBP
0036 850082      E     MOV     DPL,?C_XBP+01H
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 74  

0039 E0                MOVX    A,@DPTR
003A FE                MOV     R6,A
003B A3                INC     DPTR
003C E0                MOVX    A,@DPTR
003D FF                MOV     R7,A
003E EF                MOV     A,R7
003F 2408              ADD     A,#08H
0041 FF                MOV     R7,A
0042 EE                MOV     A,R6
0043 3400              ADDC    A,#00H
0045 FE                MOV     R6,A
0046 850083      E     MOV     DPH,?C_XBP
0049 850082      E     MOV     DPL,?C_XBP+01H
004C EE                MOV     A,R6
004D F0                MOVX    @DPTR,A
004E A3                INC     DPTR
004F EF                MOV     A,R7
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 957
0051 850083      E     MOV     DPH,?C_XBP
0054 850082      E     MOV     DPL,?C_XBP+01H
0057 E0                MOVX    A,@DPTR
0058 FE                MOV     R6,A
0059 A3                INC     DPTR
005A E0                MOVX    A,@DPTR
005B FF                MOV     R7,A
005C 8F82              MOV     DPL,R7
005E 8E83              MOV     DPH,R6
0060 E4                CLR     A
0061 93                MOVC    A,@A+DPTR
0062 FF                MOV     R7,A
0063 850083      E     MOV     DPH,?C_XBP
0066 850082      E     MOV     DPL,?C_XBP+01H
0069 A3                INC     DPTR
006A A3                INC     DPTR
006B E0                MOVX    A,@DPTR
006C FE                MOV     R6,A
006D EE                MOV     A,R6
006E C3                CLR     C
006F 9F                SUBB    A,R7
0070 400D              JC      ?C0123
                                           ; SOURCE LINE # 958
                                           ; SOURCE LINE # 959
0072 850083      E     MOV     DPH,?C_XBP
0075 850082      E     MOV     DPL,?C_XBP+01H
0078 E4                CLR     A
0079 F0                MOVX    @DPTR,A
007A A3                INC     DPTR
007B E4                CLR     A
007C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 960
007D 803B              SJMP    ?C0124
007F         ?C0123:
                                           ; SOURCE LINE # 962
                                           ; SOURCE LINE # 963
007F 850083      E     MOV     DPH,?C_XBP
0082 850082      E     MOV     DPL,?C_XBP+01H
0085 E0                MOVX    A,@DPTR
0086 FE                MOV     R6,A
0087 A3                INC     DPTR
0088 E0                MOVX    A,@DPTR
0089 FF                MOV     R7,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 75  

008A 8F82              MOV     DPL,R7
008C 8E83              MOV     DPH,R6
008E C083              PUSH    DPH
0090 C082              PUSH    DPL
0092 850083      E     MOV     DPH,?C_XBP
0095 850082      E     MOV     DPL,?C_XBP+01H
0098 A3                INC     DPTR
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B FF                MOV     R7,A
009C D082              POP     DPL
009E D083              POP     DPH
00A0 75F004            MOV     B,#04H
00A3 EF                MOV     A,R7
00A4 120000      E     LCALL   ?C?OFFXADD
00A7 A3                INC     DPTR
00A8 120000      E     LCALL   ?C?PLDCODE
00AB AE02              MOV     R6,AR2
00AD AF01              MOV     R7,AR1
00AF 850083      E     MOV     DPH,?C_XBP
00B2 850082      E     MOV     DPL,?C_XBP+01H
00B5 EE                MOV     A,R6
00B6 F0                MOVX    @DPTR,A
00B7 A3                INC     DPTR
00B8 EF                MOV     A,R7
00B9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 964
00BA         ?C0124:
                                           ; SOURCE LINE # 966
00BA 850083      E     MOV     DPH,?C_XBP
00BD 850082      E     MOV     DPL,?C_XBP+01H
00C0 E0                MOVX    A,@DPTR
00C1 FE                MOV     R6,A
00C2 A3                INC     DPTR
00C3 E0                MOVX    A,@DPTR
00C4 FF                MOV     R7,A
                                           ; SOURCE LINE # 967
00C5         ?C0125:
00C5 900003            MOV     DPTR,#03H
00C8 120000      E     LCALL   ?C?ADDXBP
00CB 22                RET     
             ; FUNCTION _?USB_GetConfigTablePtr (END)

             ; FUNCTION USB_GetDeviceTablePtr (BEGIN)
                                           ; SOURCE LINE # 1011
                                           ; SOURCE LINE # 1013
                                           ; SOURCE LINE # 1015
0000 900000      E     MOV     DPTR,#USB_device
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 25E0              ADD     A,ACC
0008 25E0              ADD     A,ACC
000A 2400        E     ADD     A,#LOW USB_TABLE+01H
000C F582              MOV     DPL,A
000E E4                CLR     A
000F 3400        E     ADDC    A,#HIGH USB_TABLE+01H
0011 F583              MOV     DPH,A
0013 120000      E     LCALL   ?C?PLDCODE
0016 AE02              MOV     R6,AR2
0018 AF01              MOV     R7,AR1
                                           ; SOURCE LINE # 1016
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 76  

001A         ?C0126:
001A 22                RET     
             ; FUNCTION USB_GetDeviceTablePtr (END)

             ; FUNCTION _?USB_GetInterfaceClassTablePtr (BEGIN)
                                           ; SOURCE LINE # 1030
0000 90FFFB            MOV     DPTR,#0FFFBH
0003 120000      E     LCALL   ?C?ADDXBP
                                           ; SOURCE LINE # 1031
                                           ; SOURCE LINE # 1037
0006 900000      E     MOV     DPTR,#USB_configuration
0009 E0                MOVX    A,@DPTR
000A FF                MOV     R7,A
000B EF                MOV     A,R7
000C 14                DEC     A
000D FF                MOV     R7,A
000E 120000      R     LCALL   _?USB_GetConfigTablePtr
0011 850083      E     MOV     DPH,?C_XBP
0014 850082      E     MOV     DPL,?C_XBP+01H
0017 EE                MOV     A,R6
0018 F0                MOVX    @DPTR,A
0019 A3                INC     DPTR
001A EF                MOV     A,R7
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1038
001C 850083      E     MOV     DPH,?C_XBP
001F 850082      E     MOV     DPL,?C_XBP+01H
0022 E0                MOVX    A,@DPTR
0023 FE                MOV     R6,A
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 FF                MOV     R7,A
0027 EF                MOV     A,R7
0028 4E                ORL     A,R6
0029 7003              JNZ     $ + 5H
002B 020000      R     LJMP    ?C0127
                                           ; SOURCE LINE # 1039
                                           ; SOURCE LINE # 1040
002E 850083      E     MOV     DPH,?C_XBP
0031 850082      E     MOV     DPL,?C_XBP+01H
0034 E0                MOVX    A,@DPTR
0035 FE                MOV     R6,A
0036 A3                INC     DPTR
0037 E0                MOVX    A,@DPTR
0038 FF                MOV     R7,A
0039 8F82              MOV     DPL,R7
003B 8E83              MOV     DPH,R6
003D A3                INC     DPTR
003E 120000      E     LCALL   ?C?PLDCODE
0041 E9                MOV     A,R1
0042 2404              ADD     A,#04H
0044 F9                MOV     R1,A
0045 EA                MOV     A,R2
0046 3400              ADDC    A,#00H
0048 FA                MOV     R2,A
0049 120000      E     LCALL   ?C?CLDPTR
004C FF                MOV     R7,A
004D 900004            MOV     DPTR,#04H
0050 120000      E     LCALL   ?C?XBPOFF
0053 EF                MOV     A,R7
0054 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1043
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 77  

0055 900004            MOV     DPTR,#04H
0058 120000      E     LCALL   ?C?XBPOFF
005B E0                MOVX    A,@DPTR
005C FF                MOV     R7,A
005D 7E00              MOV     R6,#00H
005F EF                MOV     A,R7
0060 2402              ADD     A,#02H
0062 FF                MOV     R7,A
0063 EE                MOV     A,R6
0064 3400              ADDC    A,#00H
0066 FE                MOV     R6,A
0067 EF                MOV     A,R7
0068 7802              MOV     R0,#02H
006A         ?C0151:
006A C3                CLR     C
006B 33                RLC     A
006C CE                XCH     A,R6
006D 33                RLC     A
006E CE                XCH     A,R6
006F D8F9              DJNZ    R0,?C0151
0071 FF                MOV     R7,A
0072 850083      E     MOV     DPH,?C_XBP
0075 850082      E     MOV     DPL,?C_XBP+01H
0078 E0                MOVX    A,@DPTR
0079 FC                MOV     R4,A
007A A3                INC     DPTR
007B E0                MOVX    A,@DPTR
007C FD                MOV     R5,A
007D EF                MOV     A,R7
007E 2D                ADD     A,R5
007F FF                MOV     R7,A
0080 EE                MOV     A,R6
0081 3C                ADDC    A,R4
0082 FE                MOV     R6,A
0083 850083      E     MOV     DPH,?C_XBP
0086 850082      E     MOV     DPL,?C_XBP+01H
0089 EE                MOV     A,R6
008A F0                MOVX    @DPTR,A
008B A3                INC     DPTR
008C EF                MOV     A,R7
008D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1044
008E 850083      E     MOV     DPH,?C_XBP
0091 850082      E     MOV     DPL,?C_XBP+01H
0094 E0                MOVX    A,@DPTR
0095 FE                MOV     R6,A
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FF                MOV     R7,A
0099 8F82              MOV     DPL,R7
009B 8E83              MOV     DPH,R6
009D A3                INC     DPTR
009E 120000      E     LCALL   ?C?PLDCODE
00A1 AE02              MOV     R6,AR2
00A3 AF01              MOV     R7,AR1
00A5 850083      E     MOV     DPH,?C_XBP
00A8 850082      E     MOV     DPL,?C_XBP+01H
00AB A3                INC     DPTR
00AC A3                INC     DPTR
00AD EE                MOV     A,R6
00AE F0                MOVX    @DPTR,A
00AF A3                INC     DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 78  

00B0 EF                MOV     A,R7
00B1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1045
00B2 800D              SJMP    ?C0128
00B4         ?C0127:
                                           ; SOURCE LINE # 1047
                                           ; SOURCE LINE # 1048
00B4 850083      E     MOV     DPH,?C_XBP
00B7 850082      E     MOV     DPL,?C_XBP+01H
00BA A3                INC     DPTR
00BB A3                INC     DPTR
00BC E4                CLR     A
00BD F0                MOVX    @DPTR,A
00BE A3                INC     DPTR
00BF E4                CLR     A
00C0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1049
00C1         ?C0128:
                                           ; SOURCE LINE # 1051
00C1 850083      E     MOV     DPH,?C_XBP
00C4 850082      E     MOV     DPL,?C_XBP+01H
00C7 A3                INC     DPTR
00C8 A3                INC     DPTR
00C9 E0                MOVX    A,@DPTR
00CA FE                MOV     R6,A
00CB A3                INC     DPTR
00CC E0                MOVX    A,@DPTR
00CD FF                MOV     R7,A
                                           ; SOURCE LINE # 1052
00CE         ?C0129:
00CE 900005            MOV     DPTR,#05H
00D1 120000      E     LCALL   ?C?ADDXBP
00D4 22                RET     
             ; FUNCTION _?USB_GetInterfaceClassTablePtr (END)

             ; FUNCTION _USB_TerminateEP (BEGIN)
                                           ; SOURCE LINE # 1072
0000 900000      R     MOV     DPTR,#epNumber
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1073
                                           ; SOURCE LINE # 1075
0005 900000      R     MOV     DPTR,#epNumber
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 547F              ANL     A,#07FH
000D FF                MOV     R7,A
000E 900000      R     MOV     DPTR,#epNumber
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1077
0013 900000      R     MOV     DPTR,#epNumber
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 EF                MOV     A,R7
0019 D3                SETB    C
001A 9400              SUBB    A,#00H
001C 5003              JNC     $ + 5H
001E 020000      R     LJMP    ?C0133
0021 900000      R     MOV     DPTR,#epNumber
0024 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 79  

0025 FF                MOV     R7,A
0026 EF                MOV     A,R7
0027 C3                CLR     C
0028 9409              SUBB    A,#09H
002A 4003              JC      $ + 5H
002C 020000      R     LJMP    ?C0133
                                           ; SOURCE LINE # 1078
                                           ; SOURCE LINE # 1080
002F 900000      R     MOV     DPTR,#epNumber
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 EF                MOV     A,R7
0035 75F00B            MOV     B,#0BH
0038 A4                MUL     AB
0039 2400        E     ADD     A,#LOW USB_EP+02H
003B F582              MOV     DPL,A
003D E4                CLR     A
003E 3400        E     ADDC    A,#HIGH USB_EP+02H
0040 F583              MOV     DPH,A
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 EF                MOV     A,R7
0045 4401              ORL     A,#01H
0047 FF                MOV     R7,A
0048 EF                MOV     A,R7
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1083
004A 900000      R     MOV     DPTR,#epNumber
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F EF                MOV     A,R7
0050 75F00B            MOV     B,#0BH
0053 A4                MUL     AB
0054 2400        E     ADD     A,#LOW USB_EP+03H
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH USB_EP+03H
005B F583              MOV     DPH,A
005D E4                CLR     A
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1084
005F 900000      R     MOV     DPTR,#epNumber
0062 E0                MOVX    A,@DPTR
0063 FF                MOV     R7,A
0064 EF                MOV     A,R7
0065 75F00B            MOV     B,#0BH
0068 A4                MUL     AB
0069 2400        E     ADD     A,#LOW USB_EP+01H
006B F582              MOV     DPL,A
006D E4                CLR     A
006E 3400        E     ADDC    A,#HIGH USB_EP+01H
0070 F583              MOV     DPH,A
0072 7402              MOV     A,#02H
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1086
0075 900000      R     MOV     DPTR,#epNumber
0078 E0                MOVX    A,@DPTR
0079 FF                MOV     R7,A
007A EF                MOV     A,R7
007B 75F00B            MOV     B,#0BH
007E A4                MUL     AB
007F 2400        E     ADD     A,#LOW USB_EP+04H
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 80  

0081 F582              MOV     DPL,A
0083 E4                CLR     A
0084 3400        E     ADDC    A,#HIGH USB_EP+04H
0086 F583              MOV     DPH,A
0088 E0                MOVX    A,@DPTR
0089 FF                MOV     R7,A
008A EF                MOV     A,R7
008B 5480              ANL     A,#080H
008D FF                MOV     R7,A
008E 7E00              MOV     R6,#00H
0090 EF                MOV     A,R7
0091 4E                ORL     A,R6
0092 6013              JZ      ?C0131
                                           ; SOURCE LINE # 1087
                                           ; SOURCE LINE # 1089
0094 900000      R     MOV     DPTR,#epNumber
0097 E0                MOVX    A,@DPTR
0098 FF                MOV     R7,A
0099 75F010            MOV     B,#010H
009C EF                MOV     A,R7
009D 905FFE            MOV     DPTR,#05FFEH
00A0 120000      E     LCALL   ?C?OFFXADD
00A3 740C              MOV     A,#0CH
00A5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1090
00A6 22                RET     
00A7         ?C0131:
                                           ; SOURCE LINE # 1092
                                           ; SOURCE LINE # 1094
00A7 900000      R     MOV     DPTR,#epNumber
00AA E0                MOVX    A,@DPTR
00AB FF                MOV     R7,A
00AC 75F010            MOV     B,#010H
00AF EF                MOV     A,R7
00B0 905FFE            MOV     DPTR,#05FFEH
00B3 120000      E     LCALL   ?C?OFFXADD
00B6 7408              MOV     A,#08H
00B8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1095
                                           ; SOURCE LINE # 1096
                                           ; SOURCE LINE # 1097
00B9         ?C0133:
00B9 22                RET     
             ; FUNCTION _USB_TerminateEP (END)

             ; FUNCTION USB_SetEndpointHalt (BEGIN)
                                           ; SOURCE LINE # 1113
                                           ; SOURCE LINE # 1114
                                           ; SOURCE LINE # 1115
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1119
0005 906004            MOV     DPTR,#06004H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 547F              ANL     A,#07FH
000D FF                MOV     R7,A
000E 900000      R     MOV     DPTR,#ep
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 81  

                                           ; SOURCE LINE # 1121
0013 900000      R     MOV     DPTR,#ep
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 EF                MOV     A,R7
0019 D3                SETB    C
001A 9400              SUBB    A,#00H
001C 5003              JNC     $ + 5H
001E 020000      R     LJMP    ?C0134
0021 900000      R     MOV     DPTR,#ep
0024 E0                MOVX    A,@DPTR
0025 FF                MOV     R7,A
0026 EF                MOV     A,R7
0027 C3                CLR     C
0028 9409              SUBB    A,#09H
002A 4003              JC      $ + 5H
002C 020000      R     LJMP    ?C0134
                                           ; SOURCE LINE # 1122
                                           ; SOURCE LINE # 1124
002F 900000      R     MOV     DPTR,#ep
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 EF                MOV     A,R7
0035 75F00B            MOV     B,#0BH
0038 A4                MUL     AB
0039 2400        E     ADD     A,#LOW USB_EP+02H
003B F582              MOV     DPL,A
003D E4                CLR     A
003E 3400        E     ADDC    A,#HIGH USB_EP+02H
0040 F583              MOV     DPH,A
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 EF                MOV     A,R7
0045 4401              ORL     A,#01H
0047 FF                MOV     R7,A
0048 EF                MOV     A,R7
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1127
004A 900000      R     MOV     DPTR,#ep
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F EF                MOV     A,R7
0050 75F00B            MOV     B,#0BH
0053 A4                MUL     AB
0054 2400        E     ADD     A,#LOW USB_EP+03H
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH USB_EP+03H
005B F583              MOV     DPH,A
005D E4                CLR     A
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1128
005F 900000      R     MOV     DPTR,#ep
0062 E0                MOVX    A,@DPTR
0063 FF                MOV     R7,A
0064 EF                MOV     A,R7
0065 75F00B            MOV     B,#0BH
0068 A4                MUL     AB
0069 2400        E     ADD     A,#LOW USB_EP+01H
006B F582              MOV     DPL,A
006D E4                CLR     A
006E 3400        E     ADDC    A,#HIGH USB_EP+01H
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 82  

0070 F583              MOV     DPH,A
0072 E0                MOVX    A,@DPTR
0073 FF                MOV     R7,A
0074 EF                MOV     A,R7
0075 4402              ORL     A,#02H
0077 FF                MOV     R7,A
0078 EF                MOV     A,R7
0079 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1130
007A 900000      R     MOV     DPTR,#ep
007D E0                MOVX    A,@DPTR
007E FF                MOV     R7,A
007F EF                MOV     A,R7
0080 75F00B            MOV     B,#0BH
0083 A4                MUL     AB
0084 2400        E     ADD     A,#LOW USB_EP+04H
0086 F582              MOV     DPL,A
0088 E4                CLR     A
0089 3400        E     ADDC    A,#HIGH USB_EP+04H
008B F583              MOV     DPH,A
008D E0                MOVX    A,@DPTR
008E FF                MOV     R7,A
008F EF                MOV     A,R7
0090 5480              ANL     A,#080H
0092 FF                MOV     R7,A
0093 7E00              MOV     R6,#00H
0095 EF                MOV     A,R7
0096 4E                ORL     A,R6
0097 6014              JZ      ?C0135
                                           ; SOURCE LINE # 1131
                                           ; SOURCE LINE # 1133
0099 900000      R     MOV     DPTR,#ep
009C E0                MOVX    A,@DPTR
009D FF                MOV     R7,A
009E 75F010            MOV     B,#010H
00A1 EF                MOV     A,R7
00A2 905FFE            MOV     DPTR,#05FFEH
00A5 120000      E     LCALL   ?C?OFFXADD
00A8 748D              MOV     A,#08DH
00AA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1135
00AB 8012              SJMP    ?C0136
00AD         ?C0135:
                                           ; SOURCE LINE # 1137
                                           ; SOURCE LINE # 1139
00AD 900000      R     MOV     DPTR,#ep
00B0 E0                MOVX    A,@DPTR
00B1 FF                MOV     R7,A
00B2 75F010            MOV     B,#010H
00B5 EF                MOV     A,R7
00B6 905FFE            MOV     DPTR,#05FFEH
00B9 120000      E     LCALL   ?C?OFFXADD
00BC 7489              MOV     A,#089H
00BE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1141
00BF         ?C0136:
                                           ; SOURCE LINE # 1142
00BF 120000      E     LCALL   USB_InitNoDataControlTransfer
00C2 900000      R     MOV     DPTR,#requestHandled
00C5 EF                MOV     A,R7
00C6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1143
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 83  

00C7         ?C0134:
                                           ; SOURCE LINE # 1145
00C7 900000      R     MOV     DPTR,#requestHandled
00CA E0                MOVX    A,@DPTR
00CB FF                MOV     R7,A
                                           ; SOURCE LINE # 1146
00CC         ?C0137:
00CC 22                RET     
             ; FUNCTION USB_SetEndpointHalt (END)

             ; FUNCTION USB_ClearEndpointHalt (BEGIN)
                                           ; SOURCE LINE # 1162
                                           ; SOURCE LINE # 1163
                                           ; SOURCE LINE # 1164
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1168
0005 906004            MOV     DPTR,#06004H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 547F              ANL     A,#07FH
000D FF                MOV     R7,A
000E 900000      R     MOV     DPTR,#ep
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1170
0013 900000      R     MOV     DPTR,#ep
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 EF                MOV     A,R7
0019 D3                SETB    C
001A 9400              SUBB    A,#00H
001C 5003              JNC     $ + 5H
001E 020000      R     LJMP    ?C0138
0021 900000      R     MOV     DPTR,#ep
0024 E0                MOVX    A,@DPTR
0025 FF                MOV     R7,A
0026 EF                MOV     A,R7
0027 C3                CLR     C
0028 9409              SUBB    A,#09H
002A 4003              JC      $ + 5H
002C 020000      R     LJMP    ?C0138
                                           ; SOURCE LINE # 1171
                                           ; SOURCE LINE # 1173
002F 900000      R     MOV     DPTR,#ep
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 EF                MOV     A,R7
0035 75F00B            MOV     B,#0BH
0038 A4                MUL     AB
0039 2400        E     ADD     A,#LOW USB_EP+02H
003B F582              MOV     DPL,A
003D E4                CLR     A
003E 3400        E     ADDC    A,#HIGH USB_EP+02H
0040 F583              MOV     DPH,A
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 EF                MOV     A,R7
0045 54FE              ANL     A,#0FEH
0047 FF                MOV     R7,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 84  

0048 EF                MOV     A,R7
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1176
004A 900000      R     MOV     DPTR,#ep
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F EF                MOV     A,R7
0050 75F00B            MOV     B,#0BH
0053 A4                MUL     AB
0054 2400        E     ADD     A,#LOW USB_EP+03H
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH USB_EP+03H
005B F583              MOV     DPH,A
005D E4                CLR     A
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1179
005F 900000      R     MOV     DPTR,#ep
0062 E0                MOVX    A,@DPTR
0063 FF                MOV     R7,A
0064 75F010            MOV     B,#010H
0067 EF                MOV     A,R7
0068 905FFC            MOV     DPTR,#05FFCH
006B 120000      E     LCALL   ?C?OFFXADD
006E 747F              MOV     A,#07FH
0070 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1182
0071 900000      R     MOV     DPTR,#ep
0074 E0                MOVX    A,@DPTR
0075 FF                MOV     R7,A
0076 EF                MOV     A,R7
0077 75F00B            MOV     B,#0BH
007A A4                MUL     AB
007B 2400        E     ADD     A,#LOW USB_EP+01H
007D F582              MOV     DPL,A
007F E4                CLR     A
0080 3400        E     ADDC    A,#HIGH USB_EP+01H
0082 F583              MOV     DPH,A
0084 E0                MOVX    A,@DPTR
0085 FF                MOV     R7,A
0086 EF                MOV     A,R7
0087 54FD              ANL     A,#0FDH
0089 FF                MOV     R7,A
008A EF                MOV     A,R7
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1184
008C 900000      R     MOV     DPTR,#ep
008F E0                MOVX    A,@DPTR
0090 FF                MOV     R7,A
0091 EF                MOV     A,R7
0092 75F00B            MOV     B,#0BH
0095 A4                MUL     AB
0096 2400        E     ADD     A,#LOW USB_EP+04H
0098 F582              MOV     DPL,A
009A E4                CLR     A
009B 3400        E     ADDC    A,#HIGH USB_EP+04H
009D F583              MOV     DPH,A
009F E0                MOVX    A,@DPTR
00A0 FF                MOV     R7,A
00A1 EF                MOV     A,R7
00A2 5480              ANL     A,#080H
00A4 FF                MOV     R7,A
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 85  

00A5 7E00              MOV     R6,#00H
00A7 EF                MOV     A,R7
00A8 4E                ORL     A,R6
00A9 6041              JZ      ?C0139
                                           ; SOURCE LINE # 1185
                                           ; SOURCE LINE # 1187
00AB 900000      R     MOV     DPTR,#ep
00AE E0                MOVX    A,@DPTR
00AF FF                MOV     R7,A
00B0 EF                MOV     A,R7
00B1 75F00B            MOV     B,#0BH
00B4 A4                MUL     AB
00B5 2400        E     ADD     A,#LOW USB_EP+01H
00B7 F582              MOV     DPL,A
00B9 E4                CLR     A
00BA 3400        E     ADDC    A,#HIGH USB_EP+01H
00BC F583              MOV     DPH,A
00BE E0                MOVX    A,@DPTR
00BF FF                MOV     R7,A
00C0 EF                MOV     A,R7
00C1 B40114            CJNE    A,#01H,?C0140
                                           ; SOURCE LINE # 1188
                                           ; SOURCE LINE # 1190
00C4 900000      R     MOV     DPTR,#ep
00C7 E0                MOVX    A,@DPTR
00C8 FF                MOV     R7,A
00C9 75F010            MOV     B,#010H
00CC EF                MOV     A,R7
00CD 905FFE            MOV     DPTR,#05FFEH
00D0 120000      E     LCALL   ?C?OFFXADD
00D3 740C              MOV     A,#0CH
00D5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1191
00D6 8053              SJMP    ?C0142
00D8         ?C0140:
                                           ; SOURCE LINE # 1193
                                           ; SOURCE LINE # 1194
00D8 900000      R     MOV     DPTR,#ep
00DB E0                MOVX    A,@DPTR
00DC FF                MOV     R7,A
00DD 75F010            MOV     B,#010H
00E0 EF                MOV     A,R7
00E1 905FFE            MOV     DPTR,#05FFEH
00E4 120000      E     LCALL   ?C?OFFXADD
00E7 740D              MOV     A,#0DH
00E9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1195
                                           ; SOURCE LINE # 1196
00EA 803F              SJMP    ?C0142
00EC         ?C0139:
                                           ; SOURCE LINE # 1198
                                           ; SOURCE LINE # 1200
00EC 900000      R     MOV     DPTR,#ep
00EF E0                MOVX    A,@DPTR
00F0 FF                MOV     R7,A
00F1 EF                MOV     A,R7
00F2 75F00B            MOV     B,#0BH
00F5 A4                MUL     AB
00F6 2400        E     ADD     A,#LOW USB_EP+01H
00F8 F582              MOV     DPL,A
00FA E4                CLR     A
00FB 3400        E     ADDC    A,#HIGH USB_EP+01H
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 86  

00FD F583              MOV     DPH,A
00FF E0                MOVX    A,@DPTR
0100 FF                MOV     R7,A
0101 EF                MOV     A,R7
0102 B40114            CJNE    A,#01H,?C0143
                                           ; SOURCE LINE # 1201
                                           ; SOURCE LINE # 1203
0105 900000      R     MOV     DPTR,#ep
0108 E0                MOVX    A,@DPTR
0109 FF                MOV     R7,A
010A 75F010            MOV     B,#010H
010D EF                MOV     A,R7
010E 905FFE            MOV     DPTR,#05FFEH
0111 120000      E     LCALL   ?C?OFFXADD
0114 7408              MOV     A,#08H
0116 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1204
0117 8012              SJMP    ?C0142
0119         ?C0143:
                                           ; SOURCE LINE # 1206
                                           ; SOURCE LINE # 1207
0119 900000      R     MOV     DPTR,#ep
011C E0                MOVX    A,@DPTR
011D FF                MOV     R7,A
011E 75F010            MOV     B,#010H
0121 EF                MOV     A,R7
0122 905FFE            MOV     DPTR,#05FFEH
0125 120000      E     LCALL   ?C?OFFXADD
0128 7409              MOV     A,#09H
012A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1208
                                           ; SOURCE LINE # 1209
012B         ?C0142:
                                           ; SOURCE LINE # 1211
012B 120000      E     LCALL   USB_InitNoDataControlTransfer
012E 900000      R     MOV     DPTR,#requestHandled
0131 EF                MOV     A,R7
0132 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1212
0133         ?C0138:
                                           ; SOURCE LINE # 1214
0133 900000      R     MOV     DPTR,#requestHandled
0136 E0                MOVX    A,@DPTR
0137 FF                MOV     R7,A
                                           ; SOURCE LINE # 1215
0138         ?C0145:
0138 22                RET     
             ; FUNCTION USB_ClearEndpointHalt (END)

             ; FUNCTION USB_ValidateAlternateSetting (BEGIN)
                                           ; SOURCE LINE # 1231
                                           ; SOURCE LINE # 1232
                                           ; SOURCE LINE # 1233
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1240
0005 906004            MOV     DPTR,#06004H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A 900000      R     MOV     DPTR,#interfaceNum
000D EF                MOV     A,R7
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 87  

000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1243
000F 900000      E     MOV     DPTR,#USB_configuration
0012 E0                MOVX    A,@DPTR
0013 FF                MOV     R7,A
0014 EF                MOV     A,R7
0015 14                DEC     A
0016 FF                MOV     R7,A
0017 120000      R     LCALL   _?USB_GetConfigTablePtr
001A 900000      R     MOV     DPTR,#pTmp
001D EE                MOV     A,R6
001E F0                MOVX    @DPTR,A
001F A3                INC     DPTR
0020 EF                MOV     A,R7
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1244
0022 900000      R     MOV     DPTR,#pTmp
0025 E0                MOVX    A,@DPTR
0026 FE                MOV     R6,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 FF                MOV     R7,A
002A 8F82              MOV     DPL,R7
002C 8E83              MOV     DPH,R6
002E A3                INC     DPTR
002F 120000      E     LCALL   ?C?PLDCODE
0032 E9                MOV     A,R1
0033 2404              ADD     A,#04H
0035 F9                MOV     R1,A
0036 EA                MOV     A,R2
0037 3400              ADDC    A,#00H
0039 FA                MOV     R2,A
003A 120000      E     LCALL   ?C?CLDPTR
003D FF                MOV     R7,A
003E 900000      R     MOV     DPTR,#curInterfacesNum
0041 EF                MOV     A,R7
0042 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1247
0043 900000      R     MOV     DPTR,#curInterfacesNum
0046 E0                MOVX    A,@DPTR
0047 FF                MOV     R7,A
0048 900000      R     MOV     DPTR,#interfaceNum
004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D EE                MOV     A,R6
004E D3                SETB    C
004F 9F                SUBB    A,R7
0050 400B              JC      ?C0147
0052 900000      R     MOV     DPTR,#interfaceNum
0055 E0                MOVX    A,@DPTR
0056 FF                MOV     R7,A
0057 EF                MOV     A,R7
0058 D3                SETB    C
0059 9402              SUBB    A,#02H
005B 503E              JNC     ?C0146
005D         ?C0147:
                                           ; SOURCE LINE # 1248
                                           ; SOURCE LINE # 1252
005D 900000      R     MOV     DPTR,#interfaceNum
0060 E0                MOVX    A,@DPTR
0061 FF                MOV     R7,A
0062 7400        E     MOV     A,#LOW USB_interfaceSetting
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 88  

0064 2F                ADD     A,R7
0065 F582              MOV     DPL,A
0067 E4                CLR     A
0068 3400        E     ADDC    A,#HIGH USB_interfaceSetting
006A F583              MOV     DPH,A
006C E0                MOVX    A,@DPTR
006D FF                MOV     R7,A
006E 900000      R     MOV     DPTR,#interfaceNum
0071 E0                MOVX    A,@DPTR
0072 FE                MOV     R6,A
0073 7400        E     MOV     A,#LOW USB_interfaceSettingLast
0075 2E                ADD     A,R6
0076 F582              MOV     DPL,A
0078 E4                CLR     A
0079 3400        E     ADDC    A,#HIGH USB_interfaceSettingLast
007B F583              MOV     DPH,A
007D EF                MOV     A,R7
007E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1253
007F 906002            MOV     DPTR,#06002H
0082 E0                MOVX    A,@DPTR
0083 FF                MOV     R7,A
0084 900000      R     MOV     DPTR,#interfaceNum
0087 E0                MOVX    A,@DPTR
0088 FE                MOV     R6,A
0089 7400        E     MOV     A,#LOW USB_interfaceSetting
008B 2E                ADD     A,R6
008C F582              MOV     DPL,A
008E E4                CLR     A
008F 3400        E     ADDC    A,#HIGH USB_interfaceSetting
0091 F583              MOV     DPH,A
0093 EF                MOV     A,R7
0094 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1255
0095 900000      R     MOV     DPTR,#requestHandled
0098 7401              MOV     A,#01H
009A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1256
009B         ?C0146:
                                           ; SOURCE LINE # 1258
009B 900000      R     MOV     DPTR,#requestHandled
009E E0                MOVX    A,@DPTR
009F FF                MOV     R7,A
                                           ; SOURCE LINE # 1259
00A0         ?C0148:
00A0 22                RET     
             ; FUNCTION USB_ValidateAlternateSetting (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   5888    ----
   CONSTANT SIZE    =     17    ----
   XDATA SIZE       =      2      44
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
C51 COMPILER V9.51   USB_STD                                                               07/22/2017 09:26:22 PAGE 89  

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
